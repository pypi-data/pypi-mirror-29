/*! wdb 2018-03-13 */

var History,Interpreter,Log,Prompt,Source,Switch,Traceback,Watchers,Wdb,Websocket,help,extend=function(t,e){function n(){this.constructor=t}for(var r in e)hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty,indexOf=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1};String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return e=e||0,this.substr(e,t.length)===t}),document.createElement("dialog").showModal||$(function(){return $("head").append($("<script>",{src:"https://cdnjs.cloudflare.com/ajax/libs/dialog-polyfill/0.4.3/dialog-polyfill.min.js"})),$("head").append($("<link>",{rel:"stylesheet",href:"https://cdnjs.cloudflare.com/ajax/libs/dialog-polyfill/0.4.3/dialog-polyfill.min.css"}))}),Log=function(){function t(){this.debug=$("body").attr("data-debug")||!1}return t.prototype.time=function(){var t;return(t=new Date).getHours()+":"+t.getMinutes()+":"+t.getSeconds()+"."+t.getMilliseconds()},t.prototype.log=function(){var t,e;if(this.debug)return e="["+this.constructor.name+"] ("+this.time()+")",t=[e].concat(Array.prototype.slice.call(arguments,0)),console.log.apply(console,t)},t.prototype.dbg=function(){var t,e;if(this.debug)return e="["+this.constructor.name+"] ("+this.time()+")",t=[e].concat(Array.prototype.slice.call(arguments,0)),console.debug.apply(console,t)},t.prototype.fail=function(){var t,e;return e=this.constructor.name,t=[e].concat(Array.prototype.slice.call(arguments,0)),console.error.apply(console,t)},t}(),Websocket=function(t){function e(t,n){this.wdb=t,e.__super__.constructor.apply(this,arguments),this.url="ws://"+document.location.host+"/websocket/"+n,this.log("Opening new socket",this.url),this.ws=new WebSocket(this.url),this.ws.onclose=this.close.bind(this),this.ws.onopen=this.open.bind(this),this.ws.onerror=this.error.bind(this),this.ws.onmessage=this.message.bind(this)}return extend(e,Log),e.prototype.close=function(t){return this.log("Closed",t),this.wdb.die()},e.prototype.error=function(t){return this.fail("Error",t)},e.prototype.open=function(t){return this.log("Open",t),this.wdb.opening()},e.prototype.message=function(t){var e,n,r,o;return r=t.data,(o=r.indexOf("|"))>-1?(e=r.substr(0,o),n=JSON.parse(r.substr(o+1))):e=r,this.dbg(this.time(),"<-",r),(e=e.toLowerCase())in this.wdb?this.wdb[e.toLowerCase()](n):this.fail("Unknown command",e)},e.prototype.send=function(t,e){var n;return null==e&&(e=null),e?("string"!=typeof e&&(e=JSON.stringify(e)),n=t+"|"+e):n=t,this.dbg("->",n),this.ws.send(n)},e}(),Source=function(t){function e(t){this.wdb=t,e.__super__.constructor.apply(this,arguments),this.$container=$(".source").on("mousedown",function(t){return function(e){if(2===e.which&&t.code_mirror.getOption("readOnly"))return t.code_mirror.setOption("readOnly","nocursor")}}(this)).on("mouseup",function(t){return function(e){if(2===e.which)return t.code_mirror.setOption("readOnly",!0),t.wdb.paste_target(e)}}(this)),this.code_mirror=CodeMirror(function(t){return function(e){return t.$code_mirror=$(e),t.$container.prepend(e)}}(this),{value:"No active file",theme:"material",readOnly:!0,gutters:["breaks","CodeMirror-linenumbers"],lineNumbers:!0,extraKeys:{Esc:this.stop_edition.bind(this),"Ctrl-S":this.save.bind(this)}}),this.code_mirror.on("gutterClick",this.gutter_click.bind(this)),$(window).on("resize",this.size.bind(this)),this.state={fn:null,file:null,fun:null,lno:0},this.fun_scope=null,this.footsteps={},this.breakpoints={}}return extend(e,Log),e.prototype.external=function(t){var e,n;return null==t&&(t=!0),e=this.code_mirror.getCursor(),n=""+this.state.fn,t&&(n=n+":"+(e.line+1)+":"+(e.ch+1)),this.wdb.ws.send("External",n)},e.prototype.save=function(){var t;if(!this.code_mirror.getOption("readOnly"))return t=this.code_mirror.getValue(),this.wdb.ws.send("Save",this.state.fn+"|"+t),this.state.file=t},e.prototype.gutter_click=function(t,e){return this.wdb.toggle_break(":"+(e+1))},e.prototype.clear_breakpoint=function(t){var e,n;if(null==(e=this.breakpoints)[n=t.fn]&&(e[n]=[]),indexOf.call(this.breakpoints[t.fn],t)>=0&&this.breakpoints[t.fn].splice(this.breakpoints[t.fn].indexOf(t)),t.lno)return this.remove_mark(t.lno),this.remove_class(t.lno,"ask-breakpoint"),this.remove_class(t.lno,"breakpoint")},e.prototype.ask_breakpoint=function(t){return this.add_class(t,"ask-breakpoint")},e.prototype.set_breakpoint=function(t){var e,n;return null==(e=this.breakpoints)[n=t.fn]&&(e[n]=[]),this.breakpoints[t.fn].push(t),this.mark_breakpoint(t)},e.prototype.mark_breakpoint=function(t){if(t.lno)return this.remove_class(t.lno,"ask-breakpoint"),this.add_class(t.lno,"breakpoint"),this.add_mark(t.lno,"breakpoint","breaks",t.temporary?"○":"●",this.brk_to_str(t))},e.prototype.brk_to_str=function(t){var e;return e=t.temporary?"Temporary ":"",e+="Breakpoint",t.fun&&(e+=" On "+t.fun),t.lno&&(e+=" At "+t.lno),t.cond&&(e+=" If "+t.cond),e},e.prototype.get_selection=function(){return this.code_mirror.getSelection().trim()},e.prototype.get_breakpoint=function(t){var e,n,r,o,i,s;for(null==(e=this.breakpoints)[i=this.state.fn]&&(e[i]=[]),r=0,o=(s=this.breakpoints[this.state.fn]).length;r<o;r++)if((n=s[r]).lno===t)return n},e.prototype.add_class=function(t,e){return this.code_mirror.addLineClass(t-1,"background",e)},e.prototype.remove_class=function(t,e){return this.code_mirror.removeLineClass(t-1,"background",e)},e.prototype.add_mark=function(t,e,n,r,o){return this.code_mirror.setGutterMarker(t-1,n,$("<div>",{class:e,title:o}).html(r).get(0))},e.prototype.remove_mark=function(t){return this.code_mirror.setGutterMarker(t-1,"breaks",null)},e.prototype.stop_edition=function(){if(!this.code_mirror.getOption("readOnly"))return this.toggle_edition()},e.prototype.toggle_edition=function(){var t;if(t=this.code_mirror.getOption("readOnly"),this.code_mirror.setOption("readOnly",!t),this.$code_mirror.toggleClass("rw","ro"),this.wdb.print({for:"Toggling edition",result:"Edit mode "+(t?"on":"off")}),!t)return this.code_mirror.setValue(this.state.file)},e.prototype.open=function(t,e){var n;return n={fn:t.name,file:t.file||e.code,fun:e.function,lno:e.lno,flno:e.flno,llno:e.llno},this.set_state(n)},e.prototype.set_state=function(t){var e,n,r,o,i,s,a,l,c,d,p,u,h,f,m,b,y,g;if(y=!0,this.state.fn!==t.fn||this.state.file!==t.file)for(this.code_mirror.setOption("mode",this.get_mode(t.fn)),this.code_mirror.setValue(t.file),r=0,s=(p=this.breakpoints[t.fn]||[]).length;r<s;r++)n=p[r],this.mark_breakpoint(n);else if(this.state.fun!==t.fun){if("<module>"!==this.state.fun){for(this.remove_class(this.state.flno,"ctx-top"),l=o=u=this.state.flno,h=this.state.llno;u<=h?o<=h:o>=h;l=u<=h?++o:--o)this.remove_class(l,"ctx");this.remove_class(this.state.llno,"ctx-bottom")}}else y=!1;for(this.state=t,this.code_mirror.clearGutter("CodeMirror-linenumbers"),i=0,a=(f=this.footsteps[this.state.fn]||[]).length;i<a;i++)g=f[i],this.remove_class(g,"highlighted"),this.add_class(g,"footstep");if(y&&"<module>"!==this.state.fun){for(this.add_class(this.state.flno,"ctx-top"),l=d=m=this.state.flno,b=this.state.llno;m<=b?d<=b:d>=b;l=m<=b?++d:--d)this.add_class(l,"ctx");this.add_class(this.state.llno,"ctx-bottom")}return this.add_class(this.state.lno,"highlighted"),this.add_mark(this.state.lno,"highlighted","CodeMirror-linenumbers","➤"),null==(e=this.footsteps)[c=this.state.fn]&&(e[c]=[]),this.footsteps[this.state.fn].push(this.state.lno),this.code_mirror.scrollIntoView({line:this.state.lno,ch:1},this.$code_mirror.height()/2),this.code_mirror.refresh()},e.prototype.get_mode=function(t){switch(t.split(".").splice(-1)[0]){case"py":return"python";case"jinja2":return"jinja2";case"diff":return"diff";default:return"python"}},e.prototype.focused=function(){return this.$code_mirror.hasClass("CodeMirror-focused")},e.prototype.size=function(){return this.$code_mirror.height(0),this.$code_mirror.height(this.$container.height()),this.code_mirror.refresh()},e}(),History=function(t){function e(t){var n;this.prompt=t,e.__super__.constructor.apply(this,arguments),this.index=-1,this.current="",this.currentPos=CodeMirror.Pos(0,0),this.oldIndex=null,this.originalIndex=null,this.overlay=null;try{this.history=JSON.parse(localStorage.history||"[]")}catch(t){n=t,this.fail(n),this.history=[]}this.sessionIndexStart=this.history.filter(function(t){return 0!==t.indexOf(".")}).length}return extend(e,Log),e.prototype.up=function(){return-1===this.index&&this.saveCurrent(),this.index=Math.min(this.history.length-1,this.index+1),this.sync()},e.prototype.down=function(){return this.index=Math.max(this.index-1,-1),this.sync()},e.prototype.saveCurrent=function(){return this.current=this.prompt.get(),this.currentPos=this.prompt.code_mirror.getCursor()},e.prototype.sync=function(){return-1===this.index?(this.prompt.set(this.current),this.prompt.code_mirror.setCursor(this.currentPos)):(this.prompt.set(this.history[this.index]),this.prompt.code_mirror.setCursor(this.prompt.code_mirror.lineCount(),0))},e.prototype.historize=function(t){var e;if(t){for(;-1!==(e=this.history.indexOf(t));)this.history.splice(e,1);return this.history.unshift(t),localStorage&&(localStorage.history=JSON.stringify(this.history))}},e.prototype.reset=function(){return this.index=-1,this.current="",this.currentPos=CodeMirror.Pos(0,0)},e.prototype.clear=function(){return this.history=[],this.sessionIndexStart=0,this.reset()},e.prototype.getOverlay=function(t){return{token:function(e){var n;if(t.lastIndex=e.pos,(n=t.exec(e.string))&&n.index===e.pos)return e.pos+=n[0].length||1,"searching";n?e.pos=n.index:e.skipToEnd()}}},e.prototype.searchPrev=function(t){return this.searchNext(t,-1)},e.prototype.searchNext=function(t,e){var n;for(null==e&&(e=1),null==this.oldIndex&&(this.oldIndex=this.index),null==this.originalIndex&&(this.originalIndex=this.index,-1===this.index&&this.saveCurrent());1===e&&this.index<this.history.length||-1===e&&this.index>-1;)if(this.index+=e,(n=new RegExp("("+t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")+")","gi")).test(this.history[this.index]))return this.lastResult=this.index,this.sync(),null!=this.overlay&&this.prompt.code_mirror.removeOverlay(this.overlay,!0),this.overlay=this.getOverlay(n),this.prompt.code_mirror.addOverlay(this.overlay),!0;return!1},e.prototype.commitSearch=function(){return this.oldIndex=null,this.originalIndex=null,this.index=this.lastResult,this.sync()},e.prototype.rollbackSearch=function(){return this.oldIndex=null,null!=this.originalIndex&&(this.index=this.originalIndex),this.originalIndex=null,null!=this.overlay&&this.prompt.code_mirror.removeOverlay(this.overlay,!0),this.overlay=null,this.sync()},e.prototype.resetSearch=function(){return null!=this.oldIndex&&(this.index=this.oldIndex),this.oldIndex=null},e.prototype.getSessionHistory=function(){return this.history.slice(0,this.history.length-this.sessionIndexStart)},e.prototype.getHistory=function(t){var e,n;return e=0,n=this.history.length-this.sessionIndexStart,"down"===t?n=this.index+1:"up"===t&&(e=this.index),this.history.slice(e,n)},e}(),Traceback=function(t){function e(t){this.wdb=t,e.__super__.constructor.apply(this,arguments),this.$traceback=$(".traceback"),this.$traceback.on("click",".trace-line",this.select.bind(this))}return extend(e,Log),e.prototype.select=function(t){var e;return e=$(t.currentTarget).attr("data-level"),this.wdb.select_trace(e),$(".mdl-layout__obfuscator").is(".is-visible")&&$(".mdl-layout").get(0).MaterialLayout.toggleDrawer(),!1},e.prototype.make_trace=function(t){var e,n,r,o,i,s,a,l,c,d,p;for(this.clear(),this.show(),p=[],s=0,l=t.length;s<l;s++){for(i=t[s],r=$("<a>",{class:"trace-line ellipsis mdl-list__item mdl-list__item--three-line trace-"+i.level}).attr("data-level",i.level).attr("title",'File "'+i.file+'", line '+i.lno+", in "+i.function+"\n    "+i.code),a=0,c=(d=this.wdb.source.breakpoints[i.file]||[]).length;a<c;a++)if(!((o=d[a]).cond||o.fun||o.lno)){r.addClass("breakpoint");break}i.current&&r.addClass("real-selected"),(e=$("<div>",{class:"mdl-list__item-primary-content"})).append($("<div>",{class:"ellipsis"}).text(i.function)),e.append($("<div>",{class:"mdl-list__item-text-body"}).append(n=$("<div>",{class:"ellipsis"})).append($("<div>",{class:"ellipsis"}).text(i.file.split("/").slice(-1)[0]+":"+i.lno).prepend($("<i>",{class:"material-icons"}).text(this.get_fn_icon(i.file))))),this.wdb.code(n,i.code,["ellipsis"]),r.append(e),p.push(this.$traceback.prepend(r))}return p},e.prototype.hide=function(){return this.$traceback.addClass("hidden")},e.prototype.show=function(){return this.$traceback.removeClass("hidden")},e.prototype.clear=function(){return this.$traceback.empty()},e.prototype.get_fn_icon=function(t){return~t.indexOf("site-packages")?"library_books":t.startsWith(this.wdb.cwd)||"/"!==t[0]?"star":t.startsWith("/home/")?"home":t.startsWith("/usr/lib")&&~t.indexOf("/python")?"lock":"cloud"},e}(),Interpreter=function(t){function e(t){this.wdb=t,e.__super__.constructor.apply(this,arguments),this.$terminal=$(".terminal").on("click",function(t){return function(){if(!getSelection().toString())return t.focus()}}(this)).on("click","a.inspect",this.inspect.bind(this)),this.$scrollback=$(".scrollback").on("click",".short.close",this.short_open.bind(this)).on("click",".short.open",this.short_close.bind(this)).on("click",".toggle",this.toggle_visibility.bind(this))}return extend(e,Log),e.prototype.scroll=function(t){null==t&&(t=null);{if(!t)return this.wdb.prompt.$container.get(0).scrollIntoView({behavior:"smooth"});this.$terminal.scrollTop(this.$terminal.scrollTop()+t*this.$terminal.height())}},e.prototype.clear=function(){return this.$scrollback.empty()},e.prototype.write=function(t){return this.$scrollback.append(t)},e.prototype.inspect=function(t){return this.wdb.inspect($(t.currentTarget).attr("href"))},e.prototype.short_open=function(t){return $(t.currentTarget).addClass("open").removeClass("close").next(".long").show("fast")},e.prototype.short_close=function(t){return $(t.currentTarget).addClass("close").removeClass("open").next(".long").hide("fast")},e.prototype.toggle_visibility=function(t){return $(t.currentTarget).add($(t.currentTarget).next()).toggleClass("closed","shown")},e.prototype.focus=function(t){var e;return e=this.$terminal.scrollTop(),this.wdb.prompt.focus(),this.$terminal.scrollTop(e)},e}(),Prompt=function(t){function e(t){this.wdb=t,e.__super__.constructor.apply(this,arguments),this.$container=$(".prompt"),this.history=new History(this),this.code_mirror=CodeMirror(function(t){return function(e){return t.$code_mirror=$(e),t.$container.prepend(e)}}(this),{value:"",theme:"default",language:"python",viewportMargin:1/0,lineWrapping:!0,autofocus:!0,specialChars:/[\u0000-\u0019\u00a0\u00ad\u200b-\u200f\u2028\u2029\ufeff]/}),this.code_mirror.on("changes",this.changes.bind(this)),CodeMirror.registerHelper("hint","jedi",function(t){return function(e,n,r){var o,i,s,a,l,c;if(o=e.getCursor(),c=e.getTokenAt(o),!e.getValue().startsWith(".")||2!==e.getValue().length)if(i=CodeMirror.Pos(o.line,c.start),l=CodeMirror.Pos(o.line,c.end),"."!==e.getValue()){if(r.completeSingle||c.string.match(/[\w\.\(\[\{]/))return t.wdb.ws.send("Complete",{source:e.getValue(),pos:t.code_mirror.getRange({line:0,ch:0},o).length,line:o.line+1,column:o.ch,manual:r.completeSingle}),t.completion={cur:o,tok:c,from:i,to:l,callback:n}}else n({from:i,to:l,list:function(){var t,e;t={a:"History",b:"Break",c:"Continue",d:"Dump",e:"Edition",f:"Find",g:"Clear",h:"Help",i:"Display",j:"Jump",k:"Clear",l:"Breakpoints",m:"Restart",n:"Next",o:"Open",q:"Quit",r:"Return",s:"Step",t:"Tbreak",u:"Until",w:"Watch",x:"Diff",z:"Unbreak"},e=[];for(a in t)hasProp.call(t,a)&&(s=t[a],e.push({text:"."+a,displayText:"."+a+" <i>"+this.leftpad("("+s+")",14)+"</i>  ",render:function(t,e,n){return $(t).html(n.displayText)}}));return e}.call(t)})}}(this)),this.code_mirror.addKeyMap({Enter:this.newLineOrExecute.bind(this),Up:this.history.up.bind(this.history),Down:this.history.down.bind(this.history),"Ctrl-C":this.abort.bind(this),"Ctrl-D":function(t){return function(){if(!t.get())return t.wdb.die()}}(this),"Ctrl-F":function(){},"Ctrl-R":function(t){return function(){return t.searchBack()}}(this),"Ctrl-S":function(t){return function(){return t.searchBack(!1)}}(this),"Ctrl-K":"killLine","Ctrl-L":this.wdb.cls.bind(this.wdb),"Ctrl-Enter":"newlineAndIndent","Alt-Backspace":"delGroupBefore","Ctrl-Space":this.triggerAutocomplete.bind(this),"Ctrl-Up":function(t){return function(){return t.insertHistory("up")}}(this),"Ctrl-Down":function(t){return function(){return t.insertHistory("down")}}(this),PageUp:"goLineUp",PageDown:"goLineDown",PageDown:"goLineDown","Shift-PageUp":function(t){return function(){return t.wdb.interpreter.scroll(-1)}}(this),"Shift-PageDown":function(t){return function(){return t.wdb.interpreter.scroll(1)}}(this),Tab:function(t){return function(e,n){var r,o;return r=t.code_mirror.getCursor(),t.code_mirror.getRange({line:r.line,ch:0},r).trim()?t.triggerAutocomplete(e,n):(o=Array(t.code_mirror.getOption("indentUnit")+1).join(" "),t.code_mirror.replaceSelection(o))}}(this)}),this.code_mirror.on("keyup",function(t){return function(e,n){var r;if(e.getValue()&&!(8<(r=n.keyCode)&&r<42))return CodeMirror.commands.autocomplete(e,CodeMirror.hint.jedi,{async:!0,completeSingle:!1,extraKeys:{PageUp:"goPageUp",PageDown:"goPageDown",Home:"goLineStartSmart",Up:function(t,e){return e._dirty=!0,e.moveFocus(-1)},Down:function(t,e){return e._dirty=!0,e.moveFocus(1)},Enter:function(e,n){return n._dirty?n.pick():t.newLineOrExecute(e)},Right:function(t,e){return e._dirty?e.pick():CodeMirror.commands.goCharRight(t)},End:"goLineEnd"}})}}(this))}return extend(e,Log),e.prototype.complete=function(t){var e,n,r,o;return t.completions&&this.completion?(n=this.completion.cur,o=this.completion.tok,r={from:CodeMirror.Pos(n.line,o.start),to:CodeMirror.Pos(n.line,o.end),list:function(){var r,o,i,s;for(s=[],r=0,o=(i=t.completions).length;r<o;r++)e=i[r],s.push({text:e.base+e.complete,from:CodeMirror.Pos(n.line,n.ch-e.base.length),to:n,_completion:e,render:function(t,e,n){var r,o;return r=n._completion,o="<b>"+r.base+"</b>"+r.complete,$(t).html(o)}});return s}()},CodeMirror.on(r,"shown",function(t){return function(){var e;return e=t.code_mirror.state.completionActive.options.completeSingle?"triggered":"auto",$(t.code_mirror.state.completionActive.widget.hints).addClass(e)}}(this)),void this.completion.callback(r)):t.imports?CodeMirror.commands.autocomplete(this.code_mirror,function(e,n){var r;return{from:CodeMirror.Pos(0,0),to:CodeMirror.Pos(0,0),list:function(){var e,n,o,i;for(i=[],e=0,n=(o=t.imports).length;e<n;e++)r=o[e],i.push({text:r,from:CodeMirror.Pos(0,0),to:CodeMirror.Pos(0,0),render:function(t,e,n){var r;return r="<em>"+n.text+"</em>",$(t).html(r)}});return i}()}},{async:!1,completeSingle:!1}):void 0},e.prototype.triggerAutocomplete=function(t,e){return CodeMirror.commands.autocomplete(t,CodeMirror.hint.jedi,{async:!0,extraKeys:{Right:function(t,e){return e.pick()}}})},e.prototype.newLineOrExecute=function(t){var e;if(e=t.getValue().trim())return t.setOption("readOnly","nocursor"),this.$container.addClass("loading"),this.wdb.execute(e)},e.prototype.focus=function(){return this.code_mirror.focus()},e.prototype.focused=function(){return this.$code_mirror.hasClass("CodeMirror-focused")},e.prototype.abort=function(){return this.history.reset(),this.set("")},e.prototype.ready=function(t){var e;return null==t&&(t=!1),t?this.code_mirror.execCommand("newlineAndIndent"):(e=this.code_mirror.getValue().trim(),this.history.historize(e),this.history.reset(),this.set("")),this.unlock()},e.prototype.unlock=function(){return this.$container.removeClass("loading"),this.code_mirror.setOption("readOnly",!1),this.focus()},e.prototype.get=function(){return this.code_mirror.getValue()},e.prototype.set=function(t){return this.code_mirror.setValue(t)},e.prototype.leftpad=function(t,e,n){var r,o;for(null==n&&(n=" "),r=0,o=e-t.length;0<=o?r<=o:r>=o;0<=o?++r:--r)t=n+t;return t},e.prototype.searchBack=function(t){var e;return null==t&&(t=!0),this.$code_mirror.addClass("extra-dialog"),e=this.code_mirror.openDialog('<span class="search-dialog-title">\n  Search '+(t?"backward":"forward")+':\n</span>\n<input type="text" style="width: 10em" class="CodeMirror-search-field"/>',function(t){return function(e,n){return t.history.commitSearch()}}(this),{bottom:!0,onInput:function(t){return function(e,n,r){if(n)return t.history.resetSearch(),$(".CodeMirror-search-field").toggleClass("not-found",n&&!t.history[r.back?"searchNext":"searchPrev"](n))}}(this),onKeyDown:function(t){return function(e,n,r){return(82===e.keyCode&&e.ctrlKey||83===e.keyCode&&e.altKey)&&(r.back=!0,$(".search-dialog-title").text("Search backward:"),$(".CodeMirror-search-field").toggleClass("not-found",n&&!t.history.searchNext(n)),e.preventDefault(),e.stopPropagation()),(83===e.keyCode&&e.ctrlKey||82===e.keyCode&&e.altKey)&&(r.back=!1,$(".search-dialog-title").text("Search forward:"),$(".CodeMirror-search-field").toggleClass("not-found",n&&!t.history.searchPrev(n)),e.preventDefault(),e.stopPropagation()),67===e.keyCode&&e.ctrlKey&&r(),!1}}(this),onClose:function(t){return function(e){return t.history.rollbackSearch(),t.$code_mirror.removeClass("extra-dialog")}}(this)}),e.back=t},e.prototype.insert=function(t){return this.code_mirror.replaceRange(t,this.code_mirror.getCursor())},e.prototype.changes=function(){return window.setTimeout(function(t){return function(){return t.wdb.interpreter.scroll()}}(this))},e.prototype.insertHistory=function(t){var e;return e=this.history.getHistory(t).reverse().join("\n"),this.history.reset(),this.set(e)},e}(),Watchers=function(t){function e(t){this.wdb=t,e.__super__.constructor.apply(this,arguments),this.$watchers=$(".watchers").on("click",".watching .name",this.unwatch.bind(this))}return extend(e,Log),e.prototype.unwatch=function(t){var e;return e=$(t.currentTarget).closest(".watching").attr("data-expr"),this.wdb.unwatch(e)},e.prototype.updateAll=function(t){var e,n;for(n in t)hasProp.call(t,n)&&(e=t[n],this.update(n,e));return this.$watchers.find(".watching:not(.updated)").remove(),this.$watchers.find(".watching").removeClass("updated")},e.prototype.update=function(t,e){var n,r,o;return(o=this.$watchers.find(".watching").filter(function(e){return $(e).attr("data-expr")===t})).length?(o.find(".value code").remove(),this.wdb.code(o.find(".value"),e.toString(),[],!0)):(n=$("<code>",{class:"name"}),r=$("<div>",{class:"value"}),this.$watchers.append(o=$("<div>",{class:"watching"}).attr("data-expr",t).append(n.text(t),$("<code>").text(": "),r)),this.wdb.code(r,e.toString(),[],!0)),o.addClass("updated")},e}(),Switch=function(t){function e(t){this.wdb=t,e.__super__.constructor.apply(this,arguments),this.$trace=$(".trace"),this.$switches=$(".switch").click(function(t){return function(e){return t.switch($(e.currentTarget))}}(this)),this.$command=$(".command").click(function(t){return function(e){return t.command($(e.currentTarget))}}(this)),this.$source=$(".source"),this.$interpreter=$(".interpreter")}return extend(e,Log),e.prototype.switch=function(t){if(t.is(".power")){if(t.is(".off"))return this.wdb.disable();if(t.is(".on"))return parent.postMessage("activate","*")}else if(t.is(".code")){if(t.is(".off"))return this.open_code();if(t.is(".on"))return this.close_code()}else if(t.is(".term")){if(t.is(".off"))return this.open_term();if(t.is(".on"))return this.close_term()}},e.prototype.open_trace=function(){return this.$trace.addClass("mdl-layout--fixed-drawer")},e.prototype.close_trace=function(){return this.$trace.removeClass("mdl-layout--fixed-drawer")},e.prototype.open_code=function(){return this.$switches.filter(".code").removeClass("off").addClass("on").removeClass("mdl-button--accent"),this.$source.removeClass("hidden"),this.wdb.source.size()},e.prototype.close_code=function(){return this.$switches.filter(".code").removeClass("on").addClass("off").addClass("mdl-button--accent"),this.$source.addClass("hidden"),this.wdb.source.size()},e.prototype.open_term=function(){return this.$switches.filter(".term").removeClass("off").addClass("on").removeClass("mdl-button--accent"),this.$interpreter.removeClass("hidden"),this.wdb.source.size()},e.prototype.close_term=function(){return this.$switches.filter(".term").removeClass("on").addClass("off").addClass("mdl-button--accent"),this.$interpreter.addClass("hidden"),this.wdb.source.size()},e.prototype.command=function(t){return this.wdb.execute("."+t.attr("data-command"))},e}(),help='<div class="mdl-tabs mdl-js-tabs mdl-js-ripple-effect">\n  <div class="mdl-tabs__tab-bar">\n      <a href="#help-stepping" class="mdl-tabs__tab is-active">Stepping</a>\n      <a href="#help-breakpoints" class="mdl-tabs__tab">Breakpoints</a>\n      <a href="#help-inspecting" class="mdl-tabs__tab">Inspecting</a>\n      <a href="#help-prompt" class="mdl-tabs__tab">Prompt</a>\n      <a href="#help-misc" class="mdl-tabs__tab">Misc</a>\n  </div>\n\n  <div class="mdl-tabs__panel is-active" id="help-stepping">\n    <table class="mdl-data-table mdl-js-data-table mdl-shadow--2dp">\n      <tr>\n        <td class="cmd">\n          <samp>.s</samp> or <kbd>Alt</kbd> + <kbd>↓</kbd> or <kbd>F11</kbd>\n        </td>\n        <td class="mdl-data-table__cell--non-numeric dfn">\n          Step into\n        </td>\n      </tr>\n      <tr>\n        <td class="cmd">\n          <samp>.n</samp> or <kbd>Alt</kbd> + <kbd>→</kbd> or <kbd>F10</kbd>\n        </td>\n        <td class="mdl-data-table__cell--non-numeric dfn">\n          Step over (Next)\n        </td>\n      </tr>\n      <tr>\n        <td class="cmd">\n          <samp>.u</samp> or <kbd>Alt</kbd> + <kbd>←</kbd> or <kbd>F7</kbd>\n        </td>\n        <td class="mdl-data-table__cell--non-numeric dfn">\n          Until (Next over loops)\n        </td>\n      </tr>\n      <tr>\n        <td class="cmd">\n          <samp>.r</samp> or <kbd>Alt</kbd> + <kbd>↑</kbd> or <kbd>F9</kbd>\n        </td>\n        <td class="mdl-data-table__cell--non-numeric dfn">\n          Step out (Return)\n        </td>\n      </tr>\n      <tr>\n        <td class="cmd">\n          <samp>.c</samp> or <kbd>Alt</kbd> + <kbd>Enter</kbd> or <kbd>F8</kbd>\n        </td>\n        <td class="mdl-data-table__cell--non-numeric dfn">\n          Continue\n        </td>\n      </tr>\n      <tr>\n        <td class="cmd"><samp>.j</samp> lineno</td>\n        <td class="mdl-data-table__cell--non-numeric dfn">\n          Jump to lineno (Must be at bottom frame and in the same function)\n        </td>\n      </tr>\n      <tr>\n        <td class="cmd"><samp>.q</samp></td>\n        <td class="mdl-data-table__cell--non-numeric dfn">\n          Quit\n        </td>\n      </tr>\n    </table>\n    <aside class="note">\n      All commands are prefixed with a dot and can be\n      executed with <kbd>Alt</kbd> + <kbd>the-command-letter</kbd>,\n      i.e.: <kbd>Alt</kbd> + <kbd>h</kbd>\n    </aside>\n  </div>\n  <div class="mdl-tabs__panel" id="help-breakpoints">\n    <table class="mdl-data-table mdl-js-data-table mdl-shadow--2dp">\n      <tr>\n        <td class="cmd"><samp>.b</samp> arg</td>\n        <td class="mdl-data-table__cell--non-numeric dfn">\n          Set a session breakpoint\n        </td>\n      </tr>\n      <tr>\n        <td class="cmd"><samp>.t</samp> arg</td>\n        <td class="mdl-data-table__cell--non-numeric dfn">\n          Set a temporary breakpoint\n        </td>\n      </tr>\n      <tr>\n        <td class="cmd"><samp>.z</samp> arg</td>\n        <td class="mdl-data-table__cell--non-numeric dfn">\n          Delete existing breakpoint\n        </td>\n      </tr>\n      <tr>\n        <td class="cmd"><samp>.l</samp></td>\n        <td class="mdl-data-table__cell--non-numeric dfn">\n          List active breakpoints\n        </td>\n      </tr>\n      <tr>\n        <td class="cmd">Breakpoint argument format</td>\n        <td class="mdl-data-table__cell--non-numeric dfn">\n          <code>[file/module][:lineno][#function][,condition]</code>\n        </td>\n      </tr>\n      <tr>\n        <td class="cmd"><code>[file]</code></td>\n        <td class="mdl-data-table__cell--non-numeric dfn">\n          Break if any line of <code>file</code> is executed</td>\n      </tr>\n      <tr>\n        <td class="cmd"><code>[file]:lineno</code></td>\n        <td class="mdl-data-table__cell--non-numeric dfn">\n          Break on <code>file</code> at <code>lineno</code></td>\n      </tr>\n      <tr>\n        <td class="cmd"><code>[file][:lineno],condition</code></td>\n        <td class="mdl-data-table__cell--non-numeric dfn">\n            Break on <code>file</code> at <code>lineno</code> if\n            <code>condition</code> is <code>True</code>\n            (ie: <code>i == 10)</code></td>\n      </tr>\n      <tr>\n        <td class="cmd"><code>[file]#function</code></td>\n        <td class="mdl-data-table__cell--non-numeric dfn">\n          Break when inside <code>function</code> function</td>\n      </tr>\n    </table>\n    <aside class="note">\n      File is always current file by default and you can also\n      specify a module like <code>logging.config</code>.\n    </aside>\n  </div>\n  <div class="mdl-tabs__panel" id="help-inspecting">\n    <table class="mdl-data-table mdl-js-data-table mdl-shadow--2dp">\n    <tr>\n      <td class="cmd"><samp>.a</samp></td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Echo all typed commands in the current debugging session\n      </td>\n    </tr>\n    <tr>\n      <td class="cmd"><samp>.d</samp> expression</td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Dump the result of expression in a table\n      </td>\n    </tr>\n    <tr>\n      <td class="cmd"><samp>.w</samp> expression</td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Watch expression in current file (Click on the name to remove)\n      </td>\n    </tr>\n    <tr>\n      <td class="cmd"><samp>.i</samp> [mime/type;]expression</td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Display the result in an embed, mime type defaults to "text/html"\n      </td>\n    </tr>\n    <tr>\n      <td class="cmd"><samp>.x</samp> left ? right</td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Display the difference between the pretty print of \'left\' and \'right\'\n      </td>\n    </tr>\n    <tr>\n      <td class="cmd"><samp>.x</samp> left <> right</td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Display the difference between the repr of \'left\' and \'right\'\n      </td>\n    </tr>\n    <tr>\n      <td class="cmd"><samp>.f</samp> key in expression</td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Search recursively the presence of key in expression object tree\n      </td>\n    </tr>\n    <tr>\n      <td class="cmd"><samp>.f</samp> test of expression</td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Search recursively values that match test in expression inner tree.\n        i.e.: .f type(x) == int of sys\n      </td>\n    </tr>\n  </table>\n</div>\n<div class="mdl-tabs__panel" id="help-prompt">\n  <table class="mdl-data-table mdl-js-data-table mdl-shadow--2dp">\n    <tr>\n      <td class="cmd">iterable!sthg</td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        If <a href="https://github.com/paradoxxxzero/cutter">\n          cutter\n        </a> is installed, executes cut(iterable).sthg\n      </td>\n    </tr>\n    <tr>\n      <td class="cmd">expr >! file</td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Write the result of expr in file\n      </td>\n    </tr>\n    <tr>\n      <td class="cmd">!< file</td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Eval the content of file\n      </td>\n    </tr>\n    <tr>\n      <td class="cmd"><kbd>Enter</kbd></td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Eval the current selected text in page,\n        useful to eval code in the source\n      </td>\n    </tr>\n    <tr>\n      <td class="cmd"><kbd>Shift</kbd> + <kbd>Enter</kbd></td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Insert the current selected text in page in the prompt\n      </td>\n    </tr>\n    <tr>\n      <td class="cmd"><kbd>Ctrl</kbd> + <kbd>Enter</kbd></td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Force multiline prompt\n      </td>\n    </tr>\n  </table>\n</div>\n<div class="mdl-tabs__panel" id="help-misc">\n  <table class="mdl-data-table mdl-js-data-table mdl-shadow--2dp">\n    <tr>\n      <td class="cmd"><samp>.h</samp></td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Get some help\n      </td>\n    </tr>\n    <tr>\n      <td class="cmd"><samp>.m</samp></td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Restart program\n      </td>\n    </tr>\n    <tr>\n      <td class="cmd"><samp>.e</samp></td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Toggle file edition mode\n      </td>\n    </tr>\n    <tr>\n      <td class="cmd"><samp>.o</samp></td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Try to open file in external ($EDITOR / $VISUAL / xdg-open) editor.\n        <br>\n        Add an argument (or hold shift with alt+o) if your editor does not\n        support the file:lno:col syntax.\n      </td>\n    </tr>\n    <tr>\n      <td class="cmd"><samp>.g</samp></td>\n      <td class="mdl-data-table__cell--non-numeric dfn">\n        Clear scrollback\n      </td>\n    </tr>\n  </table>\n</div>',Wdb=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.started=!1,this.cwd=null,this.file_cache={},this.last_cmd=null,this.evalTime=null,this.ws=new Websocket(this,$("[data-uuid]").attr("data-uuid")),this.traceback=new Traceback(this),this.source=new Source(this),this.interpreter=new Interpreter(this),this.prompt=new Prompt(this),this.switch=new Switch(this),this.watchers=new Watchers(this),this.$patience=$(".patience"),$(window).on("beforeunload",this.unload.bind(this))}return extend(e,Log),e.prototype.__version__="3.1.10",e.prototype.opening=function(){return this.started||($(window).on("keydown",this.global_key.bind(this)),this.started=!0),this.ws.send("Start"),this.switch.open_term()},e.prototype.working=function(){return $("body,.activity").addClass("is-active")},e.prototype.chilling=function(){return $("body,.activity").removeClass("is-active")},e.prototype.done=function(){return this.interpreter.scroll(),this.prompt.ready(),this.chilling()},e.prototype.init=function(t){var e,n,r,o,i,s,a;for(t.version!==this.constructor.prototype.__version__&&this.print({for:"Client Server version mismatch !",result:"Server is "+this.constructor.prototype.__version__+" and Client is "+(t.version||"<= 2.0")}),this.cwd=t.cwd,a=[],o=0,i=(r=t.breaks).length;o<i;o++)n=r[o],null==(e=this.source.breakpoints)[s=n.fn]&&(e[s]=[]),a.push(this.source.breakpoints[n.fn].push(n));return a},e.prototype.title=function(t){return $(".title").text(t.title).attr("title",t.title),$(".subtitle").text(t.subtitle).attr("title",t.subtitle)},e.prototype.trace=function(t){return this.switch.open_trace(),this.traceback.make_trace(t.trace)},e.prototype.select_trace=function(t){return this.ws.send("Select",t)},e.prototype.selectcheck=function(t){return t.name in this.file_cache?(t.file=this.file_cache[t.name],this.select(t)):this.ws.send("File",t.name)},e.prototype.select=function(t){var e;return e=t.frame,this.switch.open_code(),$(".trace-line").removeClass("selected"),$(".trace-"+e.level).addClass("selected"),this.file_cache[t.name]=t.file,this.source.open(t,e),this.done()},e.prototype.ellipsize=function(t){return t.find("span.cm-string").each(function(){var t;if((t=$(this).text()).length>128)return $(this).text(""),$(this).append($('<span class="short close">').text(t.substr(0,128))),$(this).append($('<span class="long">').text(t.substr(128)))})},e.prototype.code=function(t,e,n,r,o,i){var s,a,l,c,d;if(null==n&&(n=[]),null==r&&(r=!1),null==o&&(o=null),null==i&&(i="python"),r)a="<"!==e[0]||">"!==e.slice(-1)?$("<div>",{class:"out"}).html(e):$(e),t.append(a),a.add(a.find("*")).contents().filter(function(){return 3===this.nodeType&&this.nodeValue.length>0&&!$(this.parentElement).closest("thead").length}).wrap("<code>").parent().each(function(t){return function(e,r){var s,a,l,c;for((s=$(r)).addClass("waiting_for_hl").addClass("cm-s-default"),l=0,c=n.length;l<c;l++)a=n[l],s.addClass(a);return o&&s.attr("title",o),setTimeout(function(){return CodeMirror.runMode(s.text(),i,s.get(0)),s.removeClass("waiting_for_hl"),t.ellipsize(s)},50)}}(this));else{for(s=$("<code>",{class:"cm-s-default"}),c=0,d=n.length;c<d;c++)l=n[c],s.addClass(l);o&&s.attr("title",o),t.append(s),CodeMirror.runMode(e,i,s.get(0)),this.ellipsize(s)}return s},e.prototype.execute=function(t){var e,n,r,o,i;if(e=function(t){return function(){return t.ws.send.apply(t.ws,arguments),t.last_cmd=arguments,t.working()}}(this),0===t.indexOf("."))return(i=t.indexOf(" "))>-1?(r=t.substr(1,i-1),n=t.substr(i+1)):(r=t.substr(1),n=""),void(function(){switch(r){case"a":return this.printHistory();case"b":return this.toggle_break(n);case"c":return e("Continue");case"d":if(n)return e("Dump",n);break;case"e":return this.source.toggle_edition();case"f":if(n)return e("Find",n);break;case"g":return this.cls();case"h":return this.printHelp();case"i":if(n)return e("Display",n);break;case"j":if(n)return e("Jump",n);break;case"k":return this.clearHistory();case"l":return e("Breakpoints");case"m":return e("Restart");case"n":return e("Next");case"o":return this.source.external(!n);case"q":return e("Quit");case"r":return e("Return");case"s":return e("Step");case"t":return this.toggle_break(n,!0);case"u":return e("Until");case"w":if(n)return e("Watch",n);break;case"x":if(n)return e("Diff",n);break;case"z":return this.toggle_break(n,!1,!0)}}.call(this)||this.prompt.unlock());if(0!==t.indexOf("?")){if(""!==t||!this.last_cmd)return t?(this.working(),this.ws.send("Eval",t),this.evalTime="undefined"!=typeof performance&&null!==performance?performance.now():void 0,this.$patience.text(this.pretty_time(0)),o=function(t){return function(){var e;{if(t.evalTime)return e=parseInt(1e3*(performance.now()-t.evalTime)),t.$patience.text(t.pretty_time(e)),requestAnimationFrame(o);t.$patience.text("")}}}(this),requestAnimationFrame(o)):void 0;e.apply(this,this.last_cmd)}else e("Dump",t.slice(1).trim())},e.prototype.cls=function(){return this.interpreter.clear(),this.done()},e.prototype.printHistory=function(t){return this.print({for:"History",result:this.prompt.history.getSessionHistory().reverse().filter(function(t){return 0!==t.indexOf(".")}).join("\n")})},e.prototype.clearHistory=function(){return this.prompt.history.clear()},e.prototype.printHelp=function(){return this.dialog("Help",help),this.done()},e.prototype.print=function(t){var e,n,r,o,i,s;return this.evalTime&&(o=parseInt(1e3*(performance.now()-this.evalTime)),s=performance.now(),this.evalTime=null),e=$("<div>",{class:"printed scroll-line"}),this.interpreter.write(e),e.append(r=$("<div>")),this.code(e,t.for,["for prompted"]),n=$("<div>",{class:"result"}),e.append(n),this.code(n,t.result||" ",["val"],!0),i=parseInt(1e3*(performance.now()-s)),t.duration&&this.code(r,this.pretty_time(t.duration),["duration"],!1,"Total "+this.pretty_time(o)+" + "+this.pretty_time(i)+" of rendering"),this.done()},e.prototype.echo=function(t){var e,n;return e=$("<div>",{class:"echoed scroll-line"}),this.interpreter.write(e),this.code(e,t.for,["for prompted"]),n=$("<div>",{class:"result"}),e.append(n),this.code(n,t.val||"",["val"],!0,null,t.mode),this.done()},e.prototype.rawhtml=function(t){var e;return e=$("<div>",{class:"rawhtml scroll-line"}),this.interpreter.write(e),this.code(e,t.for,["for prompted"]),this.interpreter.write(t.val),this.done()},e.prototype.dump=function(t){var e,n,r,o,i,s,a,l,c,d,p,u,h;s=$("<div>",{class:"dump scroll-line"}),this.interpreter.write(s),this.code(s,t.for,["for prompted"]),r=$("<div>"),c=$("<table>",{class:"mdl-data-table mdl-js-data-table mdl-shadow--2dp object"}).appendTo(r),o=$("<thead>",{class:"toggle closed"}).append($("<tr>").append($("<th>",{class:"core",colspan:2}).text("Core Members"))).appendTo(c),i=$("<tbody>",{class:"core closed"}).appendTo(c),a=$("<thead>",{class:"toggle closed"}).append($("<tr>").append($("<th>",{class:"method",colspan:2}).text("Methods"))).appendTo(c),l=$("<tbody>",{class:"method closed"}).appendTo(c),e=$("<thead>",{class:"toggle closed"}).append($("<tr>").append($("<th>",{class:"attr",colspan:2}).text("Attributes"))).appendTo(c),n=$("<tbody>",{class:"attr closed"}).appendTo(c),u=t.val;for(p in u)h=u[p],d=n,0===p.indexOf("__")&&-1!==p.indexOf("__",p.length-2)?d=i:-1!==h.type.indexOf("method")&&(d=l),d.append($("<tr>").append($("<td>",{class:"key"}).text(p)).append($("<td>",{class:"mdl-data-table__cell--non-numeric val"}).html(h.val)));return 0===i.find("tr").length&&(o.remove(),i.remove()),0===n.find("tr").length&&(e.remove(),n.remove()),0===l.find("tr").length&&(a.remove(),l.remove()),t.doc&&(c.append($("<thead>",{class:"toggle closed"}).append($("<tr>").append($("<th>",{class:"doc",colspan:2}).text("Documentation")))),$("<tbody>",{class:"doc closed"}).append($("<tr>").append($("<td>",{class:"mdl-data-table__cell--non-numeric doc",colspan:2}).text(t.doc))).appendTo(c)),t.source&&(c.append($("<thead>",{class:"toggle closed"}).append($("<tr>").append($("<th>",{class:"source",colspan:2}).text("Source")))),$("<tbody>",{class:"source closed"}).append($("<tr>").append($("<td>",{class:"mdl-data-table__cell--non-numeric source",colspan:2}).text(t.source))).appendTo(c)),componentHandler.upgradeElement(c.get(0)),this.code(s,r.html(),[],!0),this.done()},e.prototype.breakset=function(t){var e;return this.source.set_breakpoint(t),"."!==this.prompt.get()[0]||"b"!==(e=this.prompt.get()[1])&&"t"!==e?this.chilling():this.done()},e.prototype.breakunset=function(t){var e;return this.source.clear_breakpoint(t),"."!==this.prompt.get()[0]||"b"!==(e=this.prompt.get()[1])&&"t"!==e&&"z"!==e?this.chilling():this.done()},e.prototype.split=function(t,e){var n;return indexOf.call(t,e)>=0?(n=t.split(e),[n[0],n.slice(1).join(e).trim()]):[t,null]},e.prototype.toggle_break=function(t,e,n){var r,o,i,s,a,l,c,d,p,u,h;for(null==e&&(e=!1),null==n&&(n=!1),r={lno:null,cond:null,fun:null,fn:null,temporary:e},h=t,h=(c=this.split(h,","))[0],r.cond=c[1],h=(d=this.split(h,"#"))[0],r.fun=d[1],h=(p=this.split(h,":"))[0],r.lno=p[1],r.fn=h||this.source.state.fn,r.lno=parseInt(r.lno)||null,s=!1,a=0,l=(u=this.source.breakpoints[r.fn]||[]).length;a<l;a++)if((i=u[a]).fn===r.fn&&i.lno===r.lno&&i.cond===r.cond&&i.fun===r.fun&&(i.temporary===r.temporary||n)){s=!0,r=i;break}return s||n?(this.source.clear_breakpoint(r),o="Unbreak",r.temporary||(o="Broadcast|"+o),this.ws.send(o,r),void this.working()):(r.lno&&this.source.ask_breakpoint(r.lno),o="Break",e||(o="Broadcast|"+o),this.ws.send(o,r),this.working())},e.prototype.watched=function(t){return this.watchers.updateAll(t)},e.prototype.ack=function(){return this.done()},e.prototype.display=function(t){var e,n;return e=$("<div>",{class:"display scroll-line"}),this.interpreter.write(e),this.code(e,t.for,["for prompted"]),(n=t.type.indexOf("image")>=0?$("<img>"):t.type.indexOf("audio")>=0?$("<audio>",{controls:"controls",autoplay:"autoplay"}):t.type.indexOf("video")>=0||t.type.indexOf("/ogg")>=0?$("<video>",{controls:"controls",autoplay:"autoplay"}):$("<iframe>")).addClass("display"),n.attr("src","data:"+t.type+";charset=UTF-8;base64,"+t.val),e.append(n),this.done()},e.prototype.suggest=function(t){if(t)return this.prompt.complete(t)},e.prototype.die=function(){if(this.title({title:"Dead",subtitle:"Program has exited"}),this.ws.ws.close(),$("body").addClass("is-dead"),!$("body").attr("data-debug"))return setTimeout(function(){return window.close()},10)},e.prototype.global_key=function(t){var e,n,r,o,i,s;if(this.source.rw)return!0;if(s=this.source.focused()&&this.source.code_mirror.getSelection(),t.altKey&&(65<=(r=t.keyCode)&&r<=90||37<=(o=t.keyCode)&&o<=40||13===t.keyCode)||118<=(i=t.keyCode)&&i<=122)return e=function(){switch(t.keyCode){case 37:case 118:return"u";case 13:case 119:return"c";case 38:case 120:return"r";case 39:case 121:return"n";case 40:case 122:return"s";default:return String.fromCharCode(t.keyCode)}}(),e=e.toLowerCase(),n="","b"!==e&&"t"!==e&&"z"!==e||(n+=" :"+this.source.state.lno),"i"===e&&(n=" "+s),"o"===e&&t.shiftKey&&(n=" !"),this.execute("."+e+n),!1;if(13===t.keyCode){if(this.prompt.focused())return;if(!s)return;return t.shiftKey?(this.prompt.insert(s),this.prompt.focus()):t.ctrlKey?this.ws.send("Watch",s):(this.prompt.history.historize(s),this.execute(s)),!1}},e.prototype.newline=function(){return this.prompt.ready(!0),this.chilling()},e.prototype.inspect=function(t){return this.ws.send("Inspect",t),this.working(),!1},e.prototype.unwatch=function(t){return this.ws.send("Unwatch",t),this.working()},e.prototype.paste_target=function(t){var e;if(""===(e=$(t.target).text().trim()))return!0;if(t.shiftKey)this.prompt.insert(e);else{if(!t.ctrlKey)return this.prompt.history.historize(e),this.ws.send("Dump",e),this.working(),!1;this.ws.send("Watch",e)}},e.prototype.disable=function(){return this.ws.send("Disable")},e.prototype.shell=function(){return this.switch.close_trace(),this.switch.close_code(),this.switch.open_term(),this.done()},e.prototype.dialog=function(t,e){var n,r;return $(".modals").append(n=$('<dialog class="mdl-dialog">\n  <h3 class="mdl-dialog__title">'+t+'</h3>\n  <div class="mdl-dialog__content">\n    '+e+'\n  </div>\n  <div class="mdl-dialog__actions">\n    <button type="button" class="mdl-button dialog-close">Close</button>\n  </div>\n</dialog>')),n.find(".dialog-close").on("click",function(){return n.get(0).close(),n.remove()}),n.find(".mdl-tabs,.mdl-data-table").each(function(){return componentHandler.upgradeElement(this)}),n.on("close",function(t){return function(){return t.prompt.ready()}}(this)),r=n.get(0),"undefined"!=typeof dialogPolyfill&&null!==dialogPolyfill&&dialogPolyfill.registerDialog(r),r.showModal()},e.prototype.pretty_time=function(t){var e,n,r,o;return t<1e3?t+"μs":(t/=1e3)<10?t.toFixed(2)+"ms":t<100?t.toFixed(1)+"ms":t<1e3?t.toFixed(0)+"ms":(t/=1e3)<10?t.toFixed(2)+"s":t<60?t.toFixed(1)+"s":(o=function(t){return 1===(t=t.toString()).length?"0"+t:t},n=Math.floor(t/60),r=(t-60*n).toFixed(0),n<60?n+"m"+o(r)+"s":(e=Math.floor(n/60),n=(n-60*e).toFixed(0),e+"h"+o(n)+"m"+o(r)+"s"))},e.prototype.unload=function(){return this.ws.ws.close()},e}(),$(function(){return window.wdb=new Wdb});