

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>AWS EC2 &mdash; Rambo 0.4.0.dev documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex/"/>
        <link rel="search" title="Search" href="../../search/"/>
    <link rel="top" title="Rambo 0.4.0.dev documentation" href="../../"/>
        <link rel="next" title="DigitalOcean" href="../digitalocean/"/>
        <link rel="prev" title="Environment Variables" href="../../core/env_vars/"/>

<link rel="stylesheet" href="../../_static/custom.css" type="text/css">



  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../" class="icon icon-home"> Rambo
          

          
          </a>

          
            
            
              <div class="version">
                0.4.0.dev
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Usage Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../core/quickstart/">Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../core/quickstart/#hardware-recommendations">Hardware Recommendations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../core/quickstart/#supported-host-operating-systems">Supported Host Operating Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../core/quickstart/#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../core/quickstart/#create-project">Create Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../core/quickstart/#providers">Providers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../core/quickstart/#default-provider-virtualbox">Default Provider - VirtualBox:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../core/api/">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../core/cli/">CLI</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../core/cli/#commands">Commands</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../core/cli/#createproject">createproject</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/cli/#destroy">destroy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/cli/#export-vagrant-conf">export-vagrant-conf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/cli/#halt">halt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/cli/#install-plugins">install-plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/cli/#scp">scp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/cli/#ssh">ssh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/cli/#up">up</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/cli/#vagrant">vagrant</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../core/cli/#rambo-conf">rambo.conf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../core/cli/#environment-variables">Environment Variables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../core/conf/">rambo.conf</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../core/conf/#option-names">Option Names</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../core/conf/#option-precedence">Option Precedence</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../core/customizing/">Customizing Rambo</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../core/customizing/#custom-provisioning">Custom Provisioning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../core/customizing/#saltstack">SaltStack</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/customizing/#other-provisioners">Other Provisioners</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../core/customizing/#custom-providers-provider-configuration">Custom Providers / Provider configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../core/env_vars/">Environment Variables</a></li>
</ul>
<p class="caption"><span class="caption-text">Provider Specific Documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">AWS EC2</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#create-account">Create Account</a></li>
<li class="toctree-l2"><a class="reference internal" href="#create-ssh-keys">Create SSH Keys</a></li>
<li class="toctree-l2"><a class="reference internal" href="#create-security-group">Create Security Group</a></li>
<li class="toctree-l2"><a class="reference internal" href="#create-api-token">Create API Token</a></li>
<li class="toctree-l2"><a class="reference internal" href="#edit-script-to-load-environment-variables">Edit Script to Load Environment Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="#launching-your-aws-ec2-instance">Launching Your AWS EC2 Instance</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../digitalocean/">DigitalOcean</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../digitalocean/#create-account">Create Account</a></li>
<li class="toctree-l2"><a class="reference internal" href="../digitalocean/#create-ssh-keys">Create SSH Keys</a></li>
<li class="toctree-l2"><a class="reference internal" href="../digitalocean/#create-api-token">Create API Token</a></li>
<li class="toctree-l2"><a class="reference internal" href="../digitalocean/#edit-script-to-load-environment-variables">Edit Script to Load Environment Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../digitalocean/#launching-your-digitalocean-instance">Launching Your DigitalOcean Instance</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../docker/">Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lxc/">LXC</a></li>
</ul>
<p class="caption"><span class="caption-text">Changelog:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG/">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../CHANGELOG/#dev-tbd">0.4.dev (TBD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../CHANGELOG/#november-28-2017">0.3.3 (November 28, 2017)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../CHANGELOG/#november-27-2017">0.3.2 (November 27, 2017)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../CHANGELOG/#november-8-2017">0.3.1 (November 8, 2017)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../CHANGELOG/#october-26-2017">0.3.0 (October 26, 2017)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../CHANGELOG/#august-9-2017">0.2.1 (August 9, 2017)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../CHANGELOG/#august-3-2017">0.2.0 (August 3, 2017)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../CHANGELOG/#may-22-2017">0.1.0 (May 22, 2017)</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../">Rambo</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../">Docs</a> &raquo;</li>
        
      <li>AWS EC2</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="aws-ec2">
<span id="aws-ec2"></span><h1>AWS EC2<a class="headerlink" href="#aws-ec2" title="Permalink to this headline">¶</a></h1>
<div class="section" id="create-account">
<span id="create-account"></span><h2>Create Account<a class="headerlink" href="#create-account" title="Permalink to this headline">¶</a></h2>
<p>After you installed the dependencies on your host computer you now need to create an account at AWS.
This repo will create real resources on AWS so you need to provide AWS with valid payment and remember you might rack up a bill if you run a whole bunch of machines. You have been warned.</p>
</div>
<div class="section" id="create-ssh-keys">
<span id="create-ssh-keys"></span><h2>Create SSH Keys<a class="headerlink" href="#create-ssh-keys" title="Permalink to this headline">¶</a></h2>
<p>Next you need to create a SSH key pair for AWS.</p>
<p>Run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="n">auth</span><span class="o">/</span><span class="n">keys</span>
<span class="n">cd</span> <span class="n">auth</span><span class="o">/</span><span class="n">keys</span>
<span class="n">ssh</span><span class="o">-</span><span class="n">keygen</span> <span class="o">-</span><span class="n">t</span> <span class="n">rsa</span> <span class="o">-</span><span class="n">N</span> <span class="s1">&#39;&#39;</span> <span class="o">-</span><span class="n">f</span> <span class="s2">&quot;aws.pem&quot;</span>
</pre></div>
</div>
<p>*If you want multiple users or computers to access the same AWS profile or team, you must have unique key names. For example, you will need to change the base name of your <code class="docutils literal notranslate"><span class="pre">.pem</span></code> and <code class="docutils literal notranslate"><span class="pre">.pem.pub</span></code> files to something else like <code class="docutils literal notranslate"><span class="pre">aws-myname</span></code>.</p>
<p><strong>Create a new key and name the key the same as the base name of your SSH key. If AWS’s key name and the one one your host don’t match, you won’t communicate to your VM.</strong></p>
<p>Now go to AWS’s “EC2 Dashboard”, on the left hand side go to “Key Pairs” and click the “Import Key Pair” button.</p>
<p>Here are instructions on how to setup SSH keys with aws:</p>
<p>http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html</p>
<p>You will need to copy the contents of <code class="docutils literal notranslate"><span class="pre">aws.pem.pub</span></code>.</p>
<p><strong>NOTE: You need the aws.pem file and the aws.pem.pub file. The aws.pem file needs permissions set to 600 and The aws.pem.pub file needs permissions set to 644</strong></p>
<p>Be careful not to commit this file to the repo. We setup this repo to ignore all files ending in <code class="docutils literal notranslate"><span class="pre">.pem</span></code>. But, you could theoretically still commit the pem file (by forcing a commit for example).
Store this pem file in a safe place with restricted access. Anyone who has this file can log into your machines on AWS and run arbitrary commands on them.</p>
</div>
<div class="section" id="create-security-group">
<span id="create-security-group"></span><h2>Create Security Group<a class="headerlink" href="#create-security-group" title="Permalink to this headline">¶</a></h2>
<p>Now go to AWS’s “EC2 Dashboard”, on the left hand side go to “Security Group” and click the “Create Security Group” button.</p>
<p>Name the new security group <strong>salted_server</strong>.</p>
<p>Add these inbound rules to the security group</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;All ICMP - IPv4&quot;</span><span class="p">,</span> <span class="n">ICMP</span><span class="p">,</span> <span class="mi">0</span> <span class="o">-</span> <span class="mi">65535</span><span class="p">,</span> <span class="n">anywhere</span>

<span class="s2">&quot;SSH&quot;</span><span class="p">,</span> <span class="n">TCP</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="n">anywhere</span>

<span class="s2">&quot;HTTP&quot;</span><span class="p">,</span> <span class="n">TCP</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="n">anywhere</span>

<span class="s2">&quot;HTTPS&quot;</span><span class="p">,</span> <span class="n">TCP</span><span class="p">,</span> <span class="mi">443</span><span class="p">,</span> <span class="n">anywhere</span>

<span class="s2">&quot;Custom TCP Rule&quot;</span><span class="p">,</span> <span class="n">TCP</span><span class="p">,</span> <span class="mi">4505</span><span class="p">,</span> <span class="n">anywhere</span>

<span class="s2">&quot;Custom TCP Rule&quot;</span><span class="p">,</span> <span class="n">TCP</span><span class="p">,</span> <span class="mi">4506</span><span class="p">,</span> <span class="n">anywhere</span>

<span class="s2">&quot;Custom TCP Rule&quot;</span><span class="p">,</span> <span class="n">TCP</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="n">anywhere</span>

<span class="s2">&quot;Custom TCP Rule&quot;</span><span class="p">,</span> <span class="n">TCP</span><span class="p">,</span> <span class="mi">8080</span><span class="p">,</span> <span class="n">anywhere</span>

<span class="s2">&quot;Custom TCP Rule&quot;</span><span class="p">,</span> <span class="n">TCP</span><span class="p">,</span> <span class="mi">8888</span><span class="p">,</span> <span class="n">anywhere</span>
</pre></div>
</div>
</div>
<div class="section" id="create-api-token">
<span id="create-api-token"></span><h2>Create API Token<a class="headerlink" href="#create-api-token" title="Permalink to this headline">¶</a></h2>
<p>Next you need to manually create an API access token on AWS.</p>
<p>Go to the “IAM Dashboard”, then go to “users”, now click on the user who will be creating the AWS EC2 instances. Click on the “Security Credectials” tab, click the “create access key” button.</p>
<p>You MUST get both the <strong>Access key ID</strong> and the <strong>Secret access key</strong>.</p>
<p><strong>NOTE: AWS will only show you this key ONCE.</strong></p>
</div>
<div class="section" id="edit-script-to-load-environment-variables">
<span id="edit-script-to-load-environment-variables"></span><h2>Edit Script to Load Environment Variables<a class="headerlink" href="#edit-script-to-load-environment-variables" title="Permalink to this headline">¶</a></h2>
<p>Here is the contents of the aws.env.sh file. Edit it by replacing the placeholder tags with your keys and tokens.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1"># for aws</span>
<span class="n">export</span> <span class="n">AWS_ACCESS_KEY_ID</span><span class="o">=&lt;</span><span class="n">YOUR</span> <span class="n">AWS</span> <span class="n">KEY</span> <span class="n">ID</span><span class="o">&gt;</span>
<span class="n">export</span> <span class="n">AWS_SECRET_ACCESS_KEY</span><span class="o">=&lt;</span><span class="n">YOUR</span> <span class="n">AWS</span> <span class="n">ACCESS</span> <span class="n">KEY</span><span class="o">&gt;</span>
<span class="n">export</span> <span class="n">AWS_KEYPAIR_NAME</span><span class="o">=</span><span class="s2">&quot;Vagrant&quot;</span>
<span class="n">export</span> <span class="n">AWS_SSH_PRIVKEY</span><span class="o">=</span><span class="s2">&quot;auth/keys/aws.pem&quot;</span>
</pre></div>
</div>
<p>Put your aws access key token in the line:
<code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">AWS_ACCESS_KEY_ID=&lt;YOUR</span> <span class="pre">AWS</span> <span class="pre">KEY</span> <span class="pre">ID&gt;</span></code></p>
<p>Put your aws secret acces key token in the line:
<code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">AWS_SECRET_ACCESS_KEY=&lt;YOUR</span> <span class="pre">AWS</span> <span class="pre">ACCESS</span> <span class="pre">KEY&gt;</span></code></p>
<p>Put the <strong>name</strong> of your aws ssh private key in the line:
<code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">AWS_KEYPAIR_NAME=&quot;aws&quot;</span></code></p>
<p>Put the <strong>path</strong> to your aws ssh private key in the line:
<code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">AWS_SSH_PRIVKEY=&quot;auth/keys/aws.pem&quot;</span></code></p>
<p>After editing, your aws.env.sh file will look similar to this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1"># for aws</span>
<span class="n">export</span> <span class="n">AWS_ACCESS_KEY_ID</span><span class="o">=</span><span class="s2">&quot;AKIAITT673DAF4YNV7MA&quot;</span>
<span class="n">export</span> <span class="n">AWS_SECRET_ACCESS_KEY</span><span class="o">=</span><span class="s2">&quot;m25AyjXtiYB2cCWMv1vQeyZtWqiWg0nqxi2Wm2QX&quot;</span>
<span class="n">export</span> <span class="n">AWS_KEYPAIR_NAME</span><span class="o">=</span><span class="s2">&quot;aws&quot;</span>
<span class="n">export</span> <span class="n">AWS_SSH_PRIVKEY</span><span class="o">=</span><span class="s2">&quot;auth/keys/aws.pem&quot;</span>
</pre></div>
</div>
<p>Note: the public key must be in the same dir as the private key and the public key must share the same base name as the private key (just append “.pub” on the public key file’s name).</p>
<p>Now you need to source the aws.env.sh file. cd into the repo and run:</p>
<p><code class="docutils literal notranslate"><span class="pre">source</span> <span class="pre">aws.env.sh</span></code></p>
</div>
<div class="section" id="launching-your-aws-ec2-instance">
<span id="launching-your-aws-ec2-instance"></span><h2>Launching Your AWS EC2 Instance<a class="headerlink" href="#launching-your-aws-ec2-instance" title="Permalink to this headline">¶</a></h2>
<p>Finally, run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rambo</span> <span class="n">up</span> <span class="o">-</span><span class="n">p</span> <span class="n">ec2</span>
<span class="n">rambo</span> <span class="n">ssh</span>
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../digitalocean/" class="btn btn-neutral float-right" title="DigitalOcean" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../../core/env_vars/" class="btn btn-neutral" title="Environment Variables" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Terminal Labs.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'0.4.0.dev',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>