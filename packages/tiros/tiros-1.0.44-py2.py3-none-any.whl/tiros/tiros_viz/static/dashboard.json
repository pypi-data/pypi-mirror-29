[
  {
    "uuid": "1",
    "Name": "Open outbound connection",
    "Description": "List of instances that have open outbound internet connection",
    "Inputs": [],
    "Queries": [{
        "ResultHeader": "These instances have open outbound internet connection",
        "PulseColor": "green",
        "QueryString": "list: instance-can-connect-to-internet(I)"
      }
    ],
    "Tags": "instance,outbound,internet"
  },
  {
    "uuid": "2",
    "Name": "Internet can connect to instance",
    "Description": "Checks if INSTANCE can be accessed from the public internet",
    "Inputs": [{
        "Name": "INSTANCE",
        "Type": "InstanceId"
      }
    ],
    "Queries": [{
        "ResultHeader": "Can ${INSTANCE} be accessed from the public internet?",
        "PulseColor": "green",
        "QueryString": "internet-can-connect-to-instance(${INSTANCE})."
      }
    ],
    "Tags": "instance,connectivity,public,internet,access"
  },
  {
    "uuid": "3",
    "Name": "Running instances",
    "Description": "Provides a list of all instances in state \"running\" under a subnet in \"OK\" state.",
    "Inputs": [],
    "Queries": [{
        "ResultHeader": "These instances are in state \"running\" under a subnet in \"OK\" state",
        "PulseColor": "green",
        "QueryString": "list: instance-ok(I)."
      }
    ],
    "Tags": "health,instance,status,check"
  },
  {
    "uuid": "4",
    "Name": "Find instances by tag",
    "Description": "List all instances that have a specific tag",
    "Inputs": [{
        "Name": "TAG",
        "Type": "tag"
      }
    ],
    "Queries": [
      {
        "ResultHeader": "These instances are tagged ${TAG}",
        "PulseColor": "blue",
        "QueryString": "list: instance-has-tag1(Instance, tag-key/Name, tag-value/${TAG})."
      }
    ],
    "Tags": "appsec,security,tag,demo"
  },
  {
    "uuid": "5",
    "Name": "Open outbound connection except one Resource",
    "Description": "List of instances that have open outbound connection except one RESOURCE",
    "Inputs": [
      {
        "Name": "PL",
        "Type": "prefixlist"
      }
    ],
    "Queries": [{
        "ResultHeader": "This is the list of instances that have open outbound connection except ${PL}",
        "PulseColor": "blue",
        "QueryString": "list: ex LocalPort PubIp RemotePort Proto: instance-has-eni(Instance, Eni) && reachable-public-tcp-udp(Direction, Proto, Eni, LocalPort, PubIp, RemotePort) && !pl-matches-public-ip(${PL}, PubIp)."
      }
    ],
    "Tags": "instances, public ip"
  },
  {
    "uuid": "6",
    "Name": "Internet can SSH to instance",
    "Description": "Checks if one can ssh to INSTANCE from the public internet",
    "Inputs": [
      {
        "Name": "INSTANCE",
        "Type": "InstanceId"
      }
    ],
    "Queries": [{
        "ResultHeader": "Can you ssh to ${INSTANCE} from the public internet?",
        "PulseColor": "green",
        "QueryString": "internet-can-ssh-to-instance(${INSTANCE})"
      }
    ],
    "Tags": "instance,connectivity,public,internet,ssh,access"
  },
  {
    "uuid": "7",
    "Name": "Instances with open admin ports",
    "Description": "List any instances that have Admin ports (SSH or RDP) accessible from a point on the Internet",
    "Inputs": [],
    "Queries": [
      {
        "ResultHeader": "These instances have SSH or RDP accessible from a point on the internet.",
        "PulseColor": "red",
        "QueryString": "list: instance-has-eni(Instance, Eni) && reachable-public-tcp-udp(dir/ingress, proto/6, Eni, Port, public-ip/8-8-8-8, port/40000) && (Port in {port/22, port/3389})."
      }
    ],
    "Tags": "appsec,application,security,admin,ports,open"
  },
  {
    "uuid": "8",
    "Name": "Instances with open port",
    "Description": "Lists any instances that have PORT open to the public internet",
    "Inputs": [{
        "Name": "PORT",
        "Type": "Port"
      }
    ],
    "Queries": [{
        "ResultHeader": "These instances have port ${PORT} open to the public internet",
        "PulseColor": "blue",
        "QueryString": "list: reachable-public-tcp-udp(dir/ingress, proto/6, Eni, ${PORT}, public-ip/8-8-8-8, port/40000)."
      }
    ],
    "Tags": "appsec,application,security,open,ports"
  },
  {
    "uuid": "9",
    "Name": "Instances with telnet open",
    "Description": "Looks for instances that have telnet accesible from the internet.",
    "Inputs": [],
    "Queries": [ {
        "ResultHeader": "These instances have telnet open to the public internet",
        "PulseColor": "red",
        "QueryString": "list: reachable-public-tcp-udp(dir/ingress, proto/6, Eni, port/23, public-ip/8-8-8-8, port/40000)."
      }
    ],
    "Tags": "appsec,security,telnet,open,port"
  },
  {
    "uuid": "10",
    "Name": "Instances with FTP Open",
    "Description": "Looks for instances that have ftp accesible from the internet.",
    "Inputs": [],
    "Queries": [ {
        "ResultHeader": "These instances have ftp open to the public internet",
        "PulseColor": "red",
        "QueryString": "list: reachable-public-tcp-udp(dir/ingress, proto/6, Eni, port/21, public-ip/8-8-8-8, port/40000)."
      }
    ],
    "Tags": "appsec,security,ftp,open,port"
  },
  {
    "uuid": "11",
    "Name": "1-Hop Internet Accessibility",
    "Description": "For a list of instances that are not internet accessible, which internet-accessible instances can access them?",
    "Inputs": [],
    "Queries": [ {
        "ResultHeader": "These are internet-accessible instances that can access non-internet-accessible instances",
        "PulseColor": "blue",
        "QueryString": "list: ex Reachable: internet-can-connect-to-instance(Reachable) && !internet-can-connect-to-instance(Unreachable) && instance-can-connect-to-instance(Reachable, Unreachable)."
      }
    ],
    "Tags": "appsec,security,internet,accessible"
  },
  {
    "uuid": "12",
    "Name": "Check Only Bastions Internet Accessible",
    "Description": "Returns true if all instances tagged as 'Bastion' are Internet accessible, and if those are the ONLY instances that are internet accessible",
    "Inputs": [],
    "Queries": [ {
        "ResultHeader": "Are the only internet accessible instances tagged 'Bastion'?",
        "PulseColor": "blue",
        "QueryString": "all Instance: instance-has-tag1(Instance, tag-key/Name, tag-value/Bastion) <=> internet-can-ssh-to-instance(Instance)."
      }
    ],
    "Tags": "appsec,security,bastion,internet"
  }
]
