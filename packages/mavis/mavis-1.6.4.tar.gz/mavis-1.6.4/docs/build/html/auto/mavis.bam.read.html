

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>read module &mdash; MAVIS  documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
        <link rel="author" title="About these documents"
              href="../about.html"/>
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="MAVIS  documentation" href="../index.html"/>
        <link rel="up" title="bam subpackage" href="../mavis.bam.html"/>
        <link rel="next" title="stats module" href="mavis.bam.stats.html"/>
        <link rel="prev" title="cigar module" href="mavis.bam.cigar.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> MAVIS
          

          
          </a>

          
            
            
              <div class="version">
                1.6.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pipeline.html">Running the Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mavis_input.html">MAVIS standard input file format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference.html">Reference Input Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Configuration and Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools_supported.html">Supported SV Callers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../illustrations.html">Illustrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faqs.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory.html">Theory and Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development.html">Guidelines for Contributors</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../package.html">Package Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="mavis.align.html">align module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mavis.annotate.html">annotate subpackage</a></li>
<li class="toctree-l2"><a class="reference internal" href="mavis.assemble.html">assemble module</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../mavis.bam.html">bam subpackage</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="mavis.bam.cache.html">cache module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mavis.bam.cigar.html">cigar module</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">read module</a></li>
<li class="toctree-l3"><a class="reference internal" href="mavis.bam.stats.html">stats module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mavis.blat.html">blat module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mavis.breakpoint.html">breakpoint module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mavis.checker.html">checker module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mavis.cluster.html">cluster subpackage</a></li>
<li class="toctree-l2"><a class="reference internal" href="mavis.config.html">config module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mavis.constants.html">constants module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mavis.error.html">error module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mavis.illustrate.html">illustrate subpackage</a></li>
<li class="toctree-l2"><a class="reference internal" href="mavis.interval.html">interval module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mavis.pairing.html">pairing subpackage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mavis.validate.html">validate subpackage</a></li>
<li class="toctree-l2"><a class="reference internal" href="mavis.submit.html">submit module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mavis.summary.html">summary subpackage</a></li>
<li class="toctree-l2"><a class="reference internal" href="mavis.tools.html">tools module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mavis.util.html">util module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citations.html">Literature</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MAVIS</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../package.html">Package Documentation</a> &raquo;</li>
        
          <li><a href="../mavis.bam.html">bam subpackage</a> &raquo;</li>
        
      <li>read module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/auto/mavis.bam.read.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-mavis.bam.read">
<span id="read-module"></span><h1>read module<a class="headerlink" href="#module-mavis.bam.read" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="mavis.bam.read.SamRead">
<em class="property">class </em><code class="descclassname">mavis.bam.read.</code><code class="descname">SamRead</code><span class="sig-paren">(</span><em>reference_name=None</em>, <em>next_reference_name=None</em>, <em>alignment_score=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mavis/bam/read.html#SamRead"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mavis.bam.read.SamRead" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">pysam.libcalignedsegment.AlignedSegment</span></code></p>
<p>Subclass to extend the pysam.AlignedSegment class adding some utility methods and convenient representations</p>
<p>Allows next_reference_name and reference_name to be set directly so that is does not depend on a bam header</p>
<dl class="attribute">
<dt id="mavis.bam.read.SamRead.alignment_id">
<code class="descname">alignment_id</code><a class="headerlink" href="#mavis.bam.read.SamRead.alignment_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="mavis.bam.read.SamRead.copy">
<em class="property">classmethod </em><code class="descname">copy</code><span class="sig-paren">(</span><em>pysamread</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mavis/bam/read.html#SamRead.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mavis.bam.read.SamRead.copy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="mavis.bam.read.SamRead.copy_onto">
<em class="property">classmethod </em><code class="descname">copy_onto</code><span class="sig-paren">(</span><em>pysamread</em>, <em>copyread=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mavis/bam/read.html#SamRead.copy_onto"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mavis.bam.read.SamRead.copy_onto" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="mavis.bam.read.SamRead.deletion_sequences">
<code class="descname">deletion_sequences</code><span class="sig-paren">(</span><em>reference_genome</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mavis/bam/read.html#SamRead.deletion_sequences"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mavis.bam.read.SamRead.deletion_sequences" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the reference sequences for all deletions</p>
</dd></dl>

<dl class="method">
<dt id="mavis.bam.read.SamRead.insertion_sequences">
<code class="descname">insertion_sequences</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mavis/bam/read.html#SamRead.insertion_sequences"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mavis.bam.read.SamRead.insertion_sequences" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the inserted sequence for all insertions</p>
</dd></dl>

<dl class="attribute">
<dt id="mavis.bam.read.SamRead.next_reference_name">
<code class="descname">next_reference_name</code><a class="headerlink" href="#mavis.bam.read.SamRead.next_reference_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="mavis.bam.read.SamRead.query_length">
<code class="descname">query_length</code><a class="headerlink" href="#mavis.bam.read.SamRead.query_length" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="mavis.bam.read.SamRead.reference_name">
<code class="descname">reference_name</code><a class="headerlink" href="#mavis.bam.read.SamRead.reference_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="mavis.bam.read.breakpoint_pos">
<code class="descclassname">mavis.bam.read.</code><code class="descname">breakpoint_pos</code><span class="sig-paren">(</span><em>read</em>, <em>orient='?'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mavis/bam/read.html#breakpoint_pos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mavis.bam.read.breakpoint_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>assumes the breakpoint is the position following softclipping on the side with more
softclipping (unless and orientation has been specified)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>read</strong> (<a class="reference external" href="http://pysam.readthedocs.io/en/latest/api.html#pysam.AlignedSegment" title="(in pysam v0.13)"><code class="xref py py-class docutils literal"><span class="pre">AlignedSegment</span></code></a>) – the read object</li>
<li><strong>orient</strong> (<a class="reference internal" href="mavis.constants.html#mavis.constants.ORIENT" title="mavis.constants.ORIENT"><em>ORIENT</em></a>) – the orientation</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">the position of the breakpoint in the input read</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)">int</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mavis.bam.read.calculate_alignment_score">
<code class="descclassname">mavis.bam.read.</code><code class="descname">calculate_alignment_score</code><span class="sig-paren">(</span><em>read</em>, <em>consec_bonus=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mavis/bam/read.html#calculate_alignment_score"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mavis.bam.read.calculate_alignment_score" title="Permalink to this definition">¶</a></dt>
<dd><p>calculates a score for comparing alignments</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>read</strong> (<a class="reference external" href="http://pysam.readthedocs.io/en/latest/api.html#pysam.AlignedSegment" title="(in pysam v0.13)"><em>pysam.AlignedSegment</em></a>) – the input read</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the score</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)">float</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mavis.bam.read.convert_events_to_softclipping">
<code class="descclassname">mavis.bam.read.</code><code class="descname">convert_events_to_softclipping</code><span class="sig-paren">(</span><em>read</em>, <em>orientation</em>, <em>max_event_size</em>, <em>min_anchor_size=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mavis/bam/read.html#convert_events_to_softclipping"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mavis.bam.read.convert_events_to_softclipping" title="Permalink to this definition">¶</a></dt>
<dd><p>given an alignment, simplifies the alignment by grouping everything past the first anchor and including the
first event considered too large and unaligning them turning them into softclipping</p>
</dd></dl>

<dl class="function">
<dt id="mavis.bam.read.get_samtools_version">
<code class="descclassname">mavis.bam.read.</code><code class="descname">get_samtools_version</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mavis/bam/read.html#get_samtools_version"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mavis.bam.read.get_samtools_version" title="Permalink to this definition">¶</a></dt>
<dd><p>executes a subprocess to try and run samtools and parse the version number from the output</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">get_samtools_version</span><span class="p">()</span>
<span class="go">(1, 2, 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mavis.bam.read.map_ref_range_to_query_range">
<code class="descclassname">mavis.bam.read.</code><code class="descname">map_ref_range_to_query_range</code><span class="sig-paren">(</span><em>read</em>, <em>ref_range</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mavis/bam/read.html#map_ref_range_to_query_range"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mavis.bam.read.map_ref_range_to_query_range" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ref_range</strong> (<a class="reference internal" href="mavis.interval.html#mavis.interval.Interval" title="mavis.interval.Interval"><em>Interval</em></a>) – 1-based inclusive</li>
<li><strong>read</strong> (<a class="reference external" href="http://pysam.readthedocs.io/en/latest/api.html#pysam.AlignedSegment" title="(in pysam v0.13)"><em>pysam.AlignedSegment</em></a>) – read used for the mapping</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">1-based inclusive range</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="mavis.interval.html#mavis.interval.Interval" title="mavis.interval.Interval">Interval</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mavis.bam.read.nsb_align">
<code class="descclassname">mavis.bam.read.</code><code class="descname">nsb_align</code><span class="sig-paren">(</span><em>ref</em>, <em>seq</em>, <em>weight_of_score=0.5</em>, <em>min_overlap_percent=1</em>, <em>min_match=0</em>, <em>min_consecutive_match=1</em>, <em>scoring_function=&lt;function calculate_alignment_score&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mavis/bam/read.html#nsb_align"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mavis.bam.read.nsb_align" title="Permalink to this definition">¶</a></dt>
<dd><p>given some reference string and a smaller sequence string computes the best non-space-breaking alignment
i.e. an alignment that does not allow for indels (straight-match). Positions in the aligned segments are
given relative to the length of the reference sequence (1-based)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ref</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – the reference sequence</li>
<li><strong>seq</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – the sequence being aligned</li>
<li><strong>weight_of_score</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – when scoring alignments this determines the amount
of weight to place on the cigar match. Should be a number between 0 and 1</li>
<li><strong>min_overlap_percent</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – the minimum amount of overlap of the input sequence to the reference
should be a number between 0 and 1</li>
<li><strong>min_match</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – the minimum number of matches compared to total</li>
<li><strong>scoring_function</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#callable" title="(in Python v3.6)"><em>callable</em></a>) – any function that will take a read as input and return a float
used in comparing alignments to choose the best alignment</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">list of aligned segments</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3.6/library/stdtypes.html#list" title="(in Python v3.6)"><code class="xref py py-class docutils literal"><span class="pre">list</span></code></a> of <a class="reference external" href="http://pysam.readthedocs.io/en/latest/api.html#pysam.AlignedSegment" title="(in pysam v0.13)"><code class="xref py py-class docutils literal"><span class="pre">AlignedSegment</span></code></a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">using a higher min_match may improve performance as low quality alignments are rejected more quickly. However
this may also result in no match being returned when there is no high quality match to be found.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="mavis.bam.read.orientation_supports_type">
<code class="descclassname">mavis.bam.read.</code><code class="descname">orientation_supports_type</code><span class="sig-paren">(</span><em>read</em>, <em>event_type</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mavis/bam/read.html#orientation_supports_type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mavis.bam.read.orientation_supports_type" title="Permalink to this definition">¶</a></dt>
<dd><p>checks if the orientation is compatible with the type of event</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>read</strong> (<a class="reference external" href="http://pysam.readthedocs.io/en/latest/api.html#pysam.AlignedSegment" title="(in pysam v0.13)"><code class="xref py py-class docutils literal"><span class="pre">AlignedSegment</span></code></a>) – a read from the pair</li>
<li><strong>event_type</strong> (<a class="reference internal" href="mavis.constants.html#mavis.constants.SVTYPE" title="mavis.constants.SVTYPE"><em>SVTYPE</em></a>) – the type of event to check</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><ul class="simple">
<li><code class="docutils literal"><span class="pre">True</span></code> - the read pair is in the correct orientation for this event type</li>
<li><code class="docutils literal"><span class="pre">False</span></code> - the read is not in the correct orientation</li>
</ul>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3.6/library/functions.html#bool" title="(in Python v3.6)">bool</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mavis.bam.read.pileup">
<code class="descclassname">mavis.bam.read.</code><code class="descname">pileup</code><span class="sig-paren">(</span><em>reads</em>, <em>filter_func=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mavis/bam/read.html#pileup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mavis.bam.read.pileup" title="Permalink to this definition">¶</a></dt>
<dd><p>For a given set of reads generate a pileup of all reads (exlcuding those for which the filter_func returns True)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>reads</strong> (<em>iterable of pysam.AlignedSegment</em>) – reads to pileup</li>
<li><strong>filter_func</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#callable" title="(in Python v3.6)"><em>callable</em></a>) – function which takes in a  read and returns True if it should be ignored and False otherwise</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">tuples of genomic position and read count at that position</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">iterable of tuple of int and int</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">returns positions using 1-based indexing</p>
</div>
</dd></dl>

<dl class="function">
<dt id="mavis.bam.read.read_pair_type">
<code class="descclassname">mavis.bam.read.</code><code class="descname">read_pair_type</code><span class="sig-paren">(</span><em>read</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mavis/bam/read.html#read_pair_type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mavis.bam.read.read_pair_type" title="Permalink to this definition">¶</a></dt>
<dd><p>assumptions based on illumina pairs: only 4 possible combinations</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>read</strong> (<a class="reference external" href="http://pysam.readthedocs.io/en/latest/api.html#pysam.AlignedSegment" title="(in pysam v0.13)"><code class="xref py py-class docutils literal"><span class="pre">AlignedSegment</span></code></a>) – the input read</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the type of input read pair</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">READ_PAIR_TYPE</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3.6/library/exceptions.html#NotImplementedError" title="(in Python v3.6)"><code class="xref py py-exc docutils literal"><span class="pre">NotImplementedError</span></code></a> – for any read that does not fall into the four expected configurations (see below)</td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">++++&gt;</span> <span class="o">&lt;----</span> <span class="ow">is</span> <span class="n">LR</span> <span class="n">same</span><span class="o">-</span><span class="n">strand</span>
<span class="o">++++&gt;</span> <span class="o">++++&gt;</span> <span class="ow">is</span> <span class="n">LL</span> <span class="n">opposite</span>
<span class="o">&lt;----</span> <span class="o">&lt;----</span> <span class="ow">is</span> <span class="n">RR</span> <span class="n">opposite</span>
<span class="o">&lt;----</span> <span class="o">++++&gt;</span> <span class="ow">is</span> <span class="n">RL</span> <span class="n">same</span><span class="o">-</span><span class="n">strand</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mavis.bam.read.samtools_v0_sort">
<code class="descclassname">mavis.bam.read.</code><code class="descname">samtools_v0_sort</code><span class="sig-paren">(</span><em>input_bam</em>, <em>output_bam</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mavis/bam/read.html#samtools_v0_sort"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mavis.bam.read.samtools_v0_sort" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="mavis.bam.read.samtools_v1_sort">
<code class="descclassname">mavis.bam.read.</code><code class="descname">samtools_v1_sort</code><span class="sig-paren">(</span><em>input_bam</em>, <em>output_bam</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mavis/bam/read.html#samtools_v1_sort"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mavis.bam.read.samtools_v1_sort" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="mavis.bam.read.sequenced_strand">
<code class="descclassname">mavis.bam.read.</code><code class="descname">sequenced_strand</code><span class="sig-paren">(</span><em>read</em>, <em>strand_determining_read=2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mavis/bam/read.html#sequenced_strand"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mavis.bam.read.sequenced_strand" title="Permalink to this definition">¶</a></dt>
<dd><p>determines the strand that was sequenced</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>read</strong> (<a class="reference external" href="http://pysam.readthedocs.io/en/latest/api.html#pysam.AlignedSegment" title="(in pysam v0.13)"><code class="xref py py-class docutils literal"><span class="pre">AlignedSegment</span></code></a>) – the read being used to determine the strand</li>
<li><strong>strand_determining_read</strong> (<a class="reference external" href="https://docs.python.org/3.6/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – which read in the read pair is the same as the sequenced strand</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">the strand that was sequenced</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><a class="reference internal" href="mavis.constants.html#mavis.constants.STRAND" title="mavis.constants.STRAND">STRAND</a></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3.6/library/exceptions.html#ValueError" title="(in Python v3.6)"><code class="xref py py-exc docutils literal"><span class="pre">ValueError</span></code></a> – if strand_determining_read is not 1 or 2</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">if the input pair is unstranded the information will not be representative of the
strand sequenced since the assumed convention is not followed</p>
</div>
</dd></dl>

</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="mavis.bam.stats.html" class="btn btn-neutral float-right" title="stats module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="mavis.bam.cigar.html" class="btn btn-neutral" title="cigar module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, creisle.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>