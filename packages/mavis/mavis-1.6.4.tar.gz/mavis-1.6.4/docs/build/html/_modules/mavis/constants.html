

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>mavis.constants &mdash; MAVIS  documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
        <link rel="author" title="About these documents"
              href="../../about.html"/>
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="MAVIS  documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> MAVIS
          

          
          </a>

          
            
            
              <div class="version">
                1.6.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pipeline.html">Running the Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mavis_input.html">MAVIS standard input file format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference.html">Reference Input Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configuration.html">Configuration and Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools_supported.html">Supported SV Callers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../illustrations.html">Illustrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faqs.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../theory.html">Theory and Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development.html">Guidelines for Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../package.html">Package Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../citations.html">Literature</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MAVIS</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>mavis.constants</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for mavis.constants</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">module responsible for small utility functions and constants used throughout the structural_variant package</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="kn">from</span> <span class="nn">Bio.Alphabet</span> <span class="k">import</span> <span class="n">Gapped</span>
<span class="kn">from</span> <span class="nn">Bio.Alphabet.IUPAC</span> <span class="k">import</span> <span class="n">ambiguous_dna</span>
<span class="kn">from</span> <span class="nn">Bio.Data.IUPACData</span> <span class="k">import</span> <span class="n">ambiguous_dna_values</span>
<span class="kn">from</span> <span class="nn">Bio.Seq</span> <span class="k">import</span> <span class="n">Seq</span>
<span class="kn">from</span> <span class="nn">tab</span> <span class="k">import</span> <span class="n">cast_boolean</span><span class="p">,</span> <span class="n">cast_null</span>


<div class="viewcode-block" id="MavisNamespace"><a class="viewcode-back" href="../../auto/mavis.constants.html#mavis.align.MavisNamespace">[docs]</a><span class="k">class</span> <span class="nc">MavisNamespace</span><span class="p">(</span><span class="n">argparse</span><span class="o">.</span><span class="n">Namespace</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Namespace to hold module constants</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; nspace = MavisNamespace(thing=1, otherthing=2)</span>
<span class="sd">        &gt;&gt;&gt; nspace.thing</span>
<span class="sd">        1</span>
<span class="sd">        &gt;&gt;&gt; nspace.otherthing</span>
<span class="sd">        2</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">reserved_attr</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;_types&#39;</span><span class="p">,</span> <span class="s1">&#39;_defns&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">MavisNamespace</span><span class="o">.</span><span class="n">reserved_attr</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s1">&#39;reserved attribute </span><span class="si">{}</span><span class="s1"> cannot be used&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defns</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_types</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">argparse</span><span class="o">.</span><span class="n">Namespace</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">attr</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">attr</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_set_type</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>

<div class="viewcode-block" id="MavisNamespace.items"><a class="viewcode-back" href="../../auto/mavis.constants.html#mavis.align.MavisNamespace.items">[docs]</a>    <span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; MavisNamespace(thing=1, otherthing=2).items()</span>
<span class="sd">            [(&#39;thing&#39;, 1), (&#39;otherthing&#39;, 2)]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[(</span><span class="n">k</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span></div>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">MavisNamespace</span><span class="o">.</span><span class="n">reserved_attr</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s1">&#39;reserved attribute </span><span class="si">{}</span><span class="s1"> cannot be used&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>

<div class="viewcode-block" id="MavisNamespace.flatten"><a class="viewcode-back" href="../../auto/mavis.constants.html#mavis.align.MavisNamespace.flatten">[docs]</a>    <span class="k">def</span> <span class="nf">flatten</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        returns the namespace (minus types and definitions) as a dictionary</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; MavisNamespace(thing=1, otherthing=2).flatten()</span>
<span class="sd">            {&#39;thing&#39;: 1, &#39;otherthing&#39;: 2}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">items</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">items</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">items</span></div>

<div class="viewcode-block" id="MavisNamespace.get"><a class="viewcode-back" href="../../auto/mavis.constants.html#mavis.align.MavisNamespace.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="o">*</span><span class="n">pos</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get an attribute, return a default (if given) if the attribute does not exist</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; nspace = MavisNamespace(thing=1, otherthing=2)</span>
<span class="sd">            &gt;&gt;&gt; nspace.get(&#39;thing&#39;, 2)</span>
<span class="sd">            1</span>
<span class="sd">            &gt;&gt;&gt; nspace.get(&#39;nonexistant_thing&#39;, 2)</span>
<span class="sd">            2</span>
<span class="sd">            &gt;&gt;&gt; nspace.get(&#39;nonexistant_thing&#39;)</span>
<span class="sd">            Traceback (most recent call last):</span>
<span class="sd">            ....</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;too many arguments. get takes a single </span><span class="se">\&#39;</span><span class="s1">default</span><span class="se">\&#39;</span><span class="s1"> value argument&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pos</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">raise</span> <span class="n">err</span></div>

<div class="viewcode-block" id="MavisNamespace.keys"><a class="viewcode-back" href="../../auto/mavis.constants.html#mavis.align.MavisNamespace.keys">[docs]</a>    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get the attribute keys as a list</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; MavisNamespace(thing=1, otherthing=2).keys()</span>
<span class="sd">            [&#39;thing&#39;, &#39;otherthing&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)]</span></div>

<div class="viewcode-block" id="MavisNamespace.values"><a class="viewcode-back" href="../../auto/mavis.constants.html#mavis.align.MavisNamespace.values">[docs]</a>    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get the attribute values as a list</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; MavisNamespace(thing=1, otherthing=2).values()</span>
<span class="sd">            [1, 2]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span></div>

<div class="viewcode-block" id="MavisNamespace.enforce"><a class="viewcode-back" href="../../auto/mavis.constants.html#mavis.align.MavisNamespace.enforce">[docs]</a>    <span class="k">def</span> <span class="nf">enforce</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        checks that the current namespace has a given value</span>

<span class="sd">        Returns:</span>
<span class="sd">            the input value</span>

<span class="sd">        Raises:</span>
<span class="sd">            KeyError: the value did not exist</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; nspace = MavisNamespace(thing=1, otherthing=2)</span>
<span class="sd">            &gt;&gt;&gt; nspace.enforce(1)</span>
<span class="sd">            1</span>
<span class="sd">            &gt;&gt;&gt; nspace.enforce(3)</span>
<span class="sd">            Traceback (most recent call last):</span>
<span class="sd">            ....</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s1">&#39;value </span><span class="si">{0}</span><span class="s1"> is not a valid member&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">value</span></div>

<div class="viewcode-block" id="MavisNamespace.reverse"><a class="viewcode-back" href="../../auto/mavis.constants.html#mavis.align.MavisNamespace.reverse">[docs]</a>    <span class="k">def</span> <span class="nf">reverse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        for a given value, return the associated key</span>

<span class="sd">        Args:</span>
<span class="sd">            value: the value to get the key/attribute name for</span>

<span class="sd">        Raises:</span>
<span class="sd">            KeyError: the value is not unique</span>
<span class="sd">            KeyError: the value is not assigned</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; nspace = MavisNamespace(thing=1, otherthing=2)</span>
<span class="sd">            &gt;&gt;&gt; nspace.reverse(1)</span>
<span class="sd">            &#39;thing&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">==</span> <span class="n">value</span><span class="p">:</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s1">&#39;could not reverse, the mapping is not unique&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">result</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s1">&#39;input value is not assigned to a key&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_set_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">cast_type</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">cast_type</span> <span class="o">==</span> <span class="nb">bool</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_types</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="n">cast_boolean</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_types</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="n">cast_type</span>

<div class="viewcode-block" id="MavisNamespace.type"><a class="viewcode-back" href="../../auto/mavis.constants.html#mavis.align.MavisNamespace.type">[docs]</a>    <span class="k">def</span> <span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        returns the type</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; nspace = MavisNamespace(thing=1, otherthing=2)</span>
<span class="sd">            &gt;&gt;&gt; nspace.type(&#39;thing&#39;)</span>
<span class="sd">            &lt;class &#39;int&#39;&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_types</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span></div>

<div class="viewcode-block" id="MavisNamespace.define"><a class="viewcode-back" href="../../auto/mavis.constants.html#mavis.align.MavisNamespace.define">[docs]</a>    <span class="k">def</span> <span class="nf">define</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="o">*</span><span class="n">pos</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the definition of a given attribute or return a default (when given) if the attribute does not exist</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: definition for the attribute</span>

<span class="sd">        Raises:</span>
<span class="sd">            KeyError: the attribute does not exist and a default was not given</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; nspace = MavisNamespace()</span>
<span class="sd">            &gt;&gt;&gt; nspace.add(&#39;thing&#39;, 1, defn=&#39;I am a thing&#39;)</span>
<span class="sd">            &gt;&gt;&gt; nspace.add(&#39;otherthing&#39;, 2)</span>
<span class="sd">            &gt;&gt;&gt; nspace.define(&#39;thing&#39;)</span>
<span class="sd">            &#39;I am a thing&#39;</span>
<span class="sd">            &gt;&gt;&gt; nspace.define(&#39;otherthing&#39;)</span>
<span class="sd">            Traceback (most recent call last):</span>
<span class="sd">            ....</span>
<span class="sd">            &gt;&gt;&gt; nspace.define(&#39;otherthing&#39;, &#39;I am some other thing&#39;)</span>
<span class="sd">            &#39;I am some other thing&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;too many arguments. define takes a single </span><span class="se">\&#39;</span><span class="s1">default</span><span class="se">\&#39;</span><span class="s1"> value argument&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_defns</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pos</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">raise</span> <span class="n">err</span></div>

<div class="viewcode-block" id="MavisNamespace.add"><a class="viewcode-back" href="../../auto/mavis.constants.html#mavis.align.MavisNamespace.add">[docs]</a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="o">*</span><span class="n">pos</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add an attribute to the name space. Optionally include cast_type and definition</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; nspace = MavisNamespace()</span>
<span class="sd">            &gt;&gt;&gt; nspace.add(&#39;thing&#39;, 1, int, &#39;I am a thing&#39;)</span>
<span class="sd">            &gt;&gt;&gt; nspace = MavisNamespace()</span>
<span class="sd">            &gt;&gt;&gt; nspace.add(&#39;thing&#39;, 1, int)</span>
<span class="sd">            &gt;&gt;&gt; nspace = MavisNamespace()</span>
<span class="sd">            &gt;&gt;&gt; nspace.add(&#39;thing&#39;, 1)</span>
<span class="sd">            &gt;&gt;&gt; nspace = MavisNamespace()</span>
<span class="sd">            &gt;&gt;&gt; nspace.add(&#39;thing&#39;, value=1, cast_type=int, defn=&#39;I am a thing&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;add() takes 3 positional arguments but more were given&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">value</span><span class="p">,</span> <span class="n">argname</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;cast_type&#39;</span><span class="p">,</span> <span class="s1">&#39;defn&#39;</span><span class="p">][:</span><span class="nb">len</span><span class="p">(</span><span class="n">pos</span><span class="p">)]):</span>
            <span class="k">if</span> <span class="n">argname</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;add() got multiple values for argument </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">argname</span><span class="p">)))</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">if</span> <span class="s1">&#39;cast_type&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_type</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_types</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;cast_type&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;defn&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_defns</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;defn&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;invalid arguments: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span></div>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">enforce</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Invalid value </span><span class="si">{}</span><span class="s1">. Cannot cast to type </span><span class="si">{}</span><span class="s1">. Must be a valid member: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="nb">repr</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span></div>


<div class="viewcode-block" id="float_fraction"><a class="viewcode-back" href="../../auto/mavis.constants.html#mavis.align.float_fraction">[docs]</a><span class="k">def</span> <span class="nf">float_fraction</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    cast input to a float</span>

<span class="sd">    Args:</span>
<span class="sd">        num: input to cast</span>

<span class="sd">    Returns:</span>
<span class="sd">        float</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: if the input cannot be cast to a float or the number is not between 0 and 1</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">num</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentTypeError</span><span class="p">(</span><span class="s1">&#39;Must be a value between 0 and 1&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">num</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">num</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentTypeError</span><span class="p">(</span><span class="s1">&#39;Must be a value between 0 and 1&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">num</span></div>


<div class="viewcode-block" id="nullable_int"><a class="viewcode-back" href="../../auto/mavis.constants.html#mavis.align.nullable_int">[docs]</a><span class="k">def</span> <span class="nf">nullable_int</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    casts input to an int if not an accepted null value. See :func:tab.tab.cast_null</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">cast_null</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">)</span></div>


<span class="n">COMPLETE_STAMP</span> <span class="o">=</span> <span class="s1">&#39;MAVIS.COMPLETE&#39;</span>

<span class="n">SUBCOMMAND</span> <span class="o">=</span> <span class="n">MavisNamespace</span><span class="p">(</span>
    <span class="n">ANNOTATE</span><span class="o">=</span><span class="s1">&#39;annotate&#39;</span><span class="p">,</span>
    <span class="n">VALIDATE</span><span class="o">=</span><span class="s1">&#39;validate&#39;</span><span class="p">,</span>
    <span class="n">PIPELINE</span><span class="o">=</span><span class="s1">&#39;pipeline&#39;</span><span class="p">,</span>
    <span class="n">CLUSTER</span><span class="o">=</span><span class="s1">&#39;cluster&#39;</span><span class="p">,</span>
    <span class="n">PAIR</span><span class="o">=</span><span class="s1">&#39;pairing&#39;</span><span class="p">,</span>
    <span class="n">SUMMARY</span><span class="o">=</span><span class="s1">&#39;summary&#39;</span><span class="p">,</span>
    <span class="n">CHECKER</span><span class="o">=</span><span class="s1">&#39;checker&#39;</span><span class="p">,</span>
    <span class="n">CONFIG</span><span class="o">=</span><span class="s1">&#39;config&#39;</span><span class="p">,</span>
    <span class="n">CONVERT</span><span class="o">=</span><span class="s1">&#39;convert&#39;</span><span class="p">,</span>
    <span class="n">OVERLAY</span><span class="o">=</span><span class="s1">&#39;overlay&#39;</span>
<span class="p">)</span>
<span class="sd">&quot;&quot;&quot;:class:`MavisNamespace`: holds controlled vocabulary for allowed pipeline stage values</span>

<span class="sd">- annotate</span>
<span class="sd">- validate</span>
<span class="sd">- pipeline</span>
<span class="sd">- cluster</span>
<span class="sd">- pairing</span>
<span class="sd">- summary</span>
<span class="sd">- checker</span>
<span class="sd">- config</span>
<span class="sd">- convert</span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="n">CODON_SIZE</span> <span class="o">=</span> <span class="mi">3</span>
<span class="sd">&quot;&quot;&quot;:class:`int`: the number of bases making up a codon&quot;&quot;&quot;</span>


<div class="viewcode-block" id="reverse_complement"><a class="viewcode-back" href="../../auto/mavis.constants.html#mavis.align.reverse_complement">[docs]</a><span class="k">def</span> <span class="nf">reverse_complement</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    wrapper for the Bio.Seq reverse_complement method</span>

<span class="sd">    Args:</span>
<span class="sd">        s (str): the input DNA sequence</span>

<span class="sd">    Returns:</span>
<span class="sd">        :class:`str`: the reverse complement of the input sequence</span>

<span class="sd">    Warning:</span>
<span class="sd">        assumes the input is a DNA sequence</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; reverse_complement(&#39;ATCCGGT&#39;)</span>
<span class="sd">        &#39;ACCGGAT&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">input_string</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;^[A-Za-z]*$&#39;</span><span class="p">,</span> <span class="n">input_string</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;unexpected sequence format. cannot reverse complement&#39;</span><span class="p">,</span> <span class="n">input_string</span><span class="p">)</span>
    <span class="n">input_string</span> <span class="o">=</span> <span class="n">Seq</span><span class="p">(</span><span class="n">input_string</span><span class="p">,</span> <span class="n">DNA_ALPHABET</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">input_string</span><span class="o">.</span><span class="n">reverse_complement</span><span class="p">())</span></div>


<div class="viewcode-block" id="translate"><a class="viewcode-back" href="../../auto/mavis.constants.html#mavis.align.translate">[docs]</a><span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">reading_frame</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    given a DNA sequence, translates it and returns the protein amino acid sequence</span>

<span class="sd">    Args:</span>
<span class="sd">        s (str): the input DNA sequence</span>
<span class="sd">        reading_frame (int): where to start translating the sequence</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: the amino acid sequence</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">reading_frame</span> <span class="o">=</span> <span class="n">reading_frame</span> <span class="o">%</span> <span class="n">CODON_SIZE</span>

    <span class="n">temp</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">reading_frame</span><span class="p">:]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">Seq</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">DNA_ALPHABET</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">translate</span><span class="p">())</span></div>


<span class="n">GAP</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span>

<span class="n">ORIENT</span> <span class="o">=</span> <span class="n">MavisNamespace</span><span class="p">(</span><span class="n">LEFT</span><span class="o">=</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="n">RIGHT</span><span class="o">=</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="n">NS</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;:class:`MavisNamespace`: holds controlled vocabulary for allowed orientation values</span>

<span class="sd">- ``LEFT``: left wrt to the positive/forward strand</span>
<span class="sd">- ``RIGHT``: right wrt to the positive/forward strand</span>
<span class="sd">- ``NS``: orientation is not specified</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="nb">setattr</span><span class="p">(</span><span class="n">ORIENT</span><span class="p">,</span> <span class="s1">&#39;expand&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="n">ORIENT</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">ORIENT</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">]</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">ORIENT</span><span class="o">.</span><span class="n">NS</span> <span class="k">else</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span>
<span class="nb">setattr</span><span class="p">(</span><span class="n">ORIENT</span><span class="p">,</span> <span class="s1">&#39;compare&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">ORIENT</span><span class="o">.</span><span class="n">NS</span> <span class="ow">in</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span> <span class="k">else</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="n">y</span><span class="p">))</span>

<span class="n">PROTOCOL</span> <span class="o">=</span> <span class="n">MavisNamespace</span><span class="p">(</span><span class="n">GENOME</span><span class="o">=</span><span class="s1">&#39;genome&#39;</span><span class="p">,</span> <span class="n">TRANS</span><span class="o">=</span><span class="s1">&#39;transcriptome&#39;</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;:class:`MavisNamespace`: holds controlled vocabulary for allowed protocol values</span>

<span class="sd">- ``GENOME``: genome</span>
<span class="sd">- ``TRANS``: transcriptome</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">DISEASE_STATUS</span> <span class="o">=</span> <span class="n">MavisNamespace</span><span class="p">(</span><span class="n">DISEASED</span><span class="o">=</span><span class="s1">&#39;diseased&#39;</span><span class="p">,</span> <span class="n">NORMAL</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;:class:`MavisNamespace`: holds controlled vocabulary for allowed disease status</span>

<span class="sd">- ``DISEASED``: diseased</span>
<span class="sd">- ``NORMAL``: normal</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">STRAND</span> <span class="o">=</span> <span class="n">MavisNamespace</span><span class="p">(</span><span class="n">POS</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">NEG</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">NS</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;:class:`MavisNamespace`: holds controlled vocabulary for allowed strand values</span>

<span class="sd">- ``POS``: the positive/forward strand</span>
<span class="sd">- ``NEG``: the negative/reverse strand</span>
<span class="sd">- ``NS``: strand is not specified</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="nb">setattr</span><span class="p">(</span><span class="n">STRAND</span><span class="p">,</span> <span class="s1">&#39;expand&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="n">STRAND</span><span class="o">.</span><span class="n">POS</span><span class="p">,</span> <span class="n">STRAND</span><span class="o">.</span><span class="n">NEG</span><span class="p">]</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">STRAND</span><span class="o">.</span><span class="n">NS</span> <span class="k">else</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span>
<span class="nb">setattr</span><span class="p">(</span><span class="n">STRAND</span><span class="p">,</span> <span class="s1">&#39;compare&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">STRAND</span><span class="o">.</span><span class="n">NS</span> <span class="ow">in</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span> <span class="k">else</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="n">y</span><span class="p">))</span>

<span class="n">SVTYPE</span> <span class="o">=</span> <span class="n">MavisNamespace</span><span class="p">(</span>
    <span class="n">DEL</span><span class="o">=</span><span class="s1">&#39;deletion&#39;</span><span class="p">,</span>
    <span class="n">TRANS</span><span class="o">=</span><span class="s1">&#39;translocation&#39;</span><span class="p">,</span>
    <span class="n">ITRANS</span><span class="o">=</span><span class="s1">&#39;inverted translocation&#39;</span><span class="p">,</span>
    <span class="n">INV</span><span class="o">=</span><span class="s1">&#39;inversion&#39;</span><span class="p">,</span>
    <span class="n">INS</span><span class="o">=</span><span class="s1">&#39;insertion&#39;</span><span class="p">,</span>
    <span class="n">DUP</span><span class="o">=</span><span class="s1">&#39;duplication&#39;</span>
<span class="p">)</span>
<span class="sd">&quot;&quot;&quot;:class:`MavisNamespace`: holds controlled vocabulary for acceptable structural variant classifications</span>

<span class="sd">- ``DEL``: deletion</span>
<span class="sd">- ``TRANS``: translocation</span>
<span class="sd">- ``ITRANS``: inverted translocation</span>
<span class="sd">- ``INV``: inversion</span>
<span class="sd">- ``INS``: insertion</span>
<span class="sd">- ``DUP``: duplication</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">CIGAR</span> <span class="o">=</span> <span class="n">MavisNamespace</span><span class="p">(</span><span class="n">M</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">S</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">H</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">P</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">EQ</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;:class:`MavisNamespace`: Enum-like. For readable cigar values</span>

<span class="sd">- ``M``: alignment match (can be a sequence match or mismatch)</span>
<span class="sd">- ``I``: insertion to the reference</span>
<span class="sd">- ``D``: deletion from the reference</span>
<span class="sd">- ``N``: skipped region from the reference</span>
<span class="sd">- ``S``: soft clipping (clipped sequences present in SEQ)</span>
<span class="sd">- ``H``: hard clipping (clipped sequences NOT present in SEQ)</span>
<span class="sd">- ``P``: padding (silent deletion from padded reference)</span>
<span class="sd">- ``EQ``: sequence match (=)</span>
<span class="sd">- ``X``: sequence mismatch</span>

<span class="sd">note: descriptions are taken from the `samfile documentation &lt;https://samtools.github.io/hts-specs/SAMv1.pdf&gt;`_</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">NA_MAPPING_QUALITY</span> <span class="o">=</span> <span class="mi">255</span>
<span class="sd">&quot;&quot;&quot;:class:`int`: mapping quality value to indicate mapping was not performed/calculated&quot;&quot;&quot;</span>

<span class="n">PYSAM_READ_FLAGS</span> <span class="o">=</span> <span class="n">MavisNamespace</span><span class="p">(</span>
    <span class="n">REVERSE</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
    <span class="n">MATE_REVERSE</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
    <span class="n">UNMAPPED</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">MATE_UNMAPPED</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
    <span class="n">FIRST_IN_PAIR</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
    <span class="n">LAST_IN_PAIR</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
    <span class="n">SECONDARY</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
    <span class="n">MULTIMAP</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">SUPPLEMENTARY</span><span class="o">=</span><span class="mi">2048</span><span class="p">,</span>
    <span class="n">TARGETED_ALIGNMENT</span><span class="o">=</span><span class="s1">&#39;ta&#39;</span><span class="p">,</span>
    <span class="n">RECOMPUTED_CIGAR</span><span class="o">=</span><span class="s1">&#39;rc&#39;</span><span class="p">,</span>
    <span class="n">BLAT_RANK</span><span class="o">=</span><span class="s1">&#39;br&#39;</span><span class="p">,</span>
    <span class="n">BLAT_SCORE</span><span class="o">=</span><span class="s1">&#39;bs&#39;</span><span class="p">,</span>
    <span class="n">BLAT_ALIGNMENTS</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">,</span>
    <span class="n">BLAT_PERCENT_IDENTITY</span><span class="o">=</span><span class="s1">&#39;bi&#39;</span><span class="p">,</span>
    <span class="n">BLAT_PMS</span><span class="o">=</span><span class="s1">&#39;bp&#39;</span>
<span class="p">)</span>

<span class="sd">&quot;&quot;&quot;:class:`MavisNamespace`: Enum-like. For readable PYSAM flag constants</span>

<span class="sd">- ``MULTIMAP``: template having multiple segments in sequencing</span>
<span class="sd">- ``UNMAPPED``: segment unmapped</span>
<span class="sd">- ``MATE_UNMAPPED``: next segment in the template unmapped</span>
<span class="sd">- ``REVERSE``: SEQ being reverse complemented</span>
<span class="sd">- ``MATE_REVERSE``: SEQ of the next segment in the template being reverse complemented</span>
<span class="sd">- ``FIRST_IN_PAIR``: the first segment in the template</span>
<span class="sd">- ``LAST_IN_PAIR``: the last segment in the template</span>
<span class="sd">- ``SECONDARY``: secondary alignment</span>
<span class="sd">- ``SUPPLEMENTARY``: supplementary alignment</span>

<span class="sd">note: descriptions are taken from the `samfile documentation &lt;https://samtools.github.io/hts-specs/SAMv1.pdf&gt;`_</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># read paired, read mapped in proper pair, mate reverse strand, first in pair</span>


<span class="k">def</span> <span class="nf">_match_ambiguous_dna</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    &gt;&gt;&gt; _match_ambiguous_dna(&#39;A&#39;, &#39;N&#39;)</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; _match_ambiguous_dna(&#39;A&#39;, &#39;T&#39;)</span>
<span class="sd">    False</span>
<span class="sd">    &gt;&gt;&gt; _match_ambiguous_dna(&#39;A&#39;, &#39;A&#39;)</span>
<span class="sd">    True</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="n">xset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">ambiguous_dna_values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
    <span class="n">yset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">ambiguous_dna_values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xset</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">yset</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="kc">True</span>


<span class="n">DNA_ALPHABET</span> <span class="o">=</span> <span class="n">alphabet</span> <span class="o">=</span> <span class="n">Gapped</span><span class="p">(</span><span class="n">ambiguous_dna</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">DNA_ALPHABET</span><span class="o">.</span><span class="n">match</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">_match_ambiguous_dna</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">FLAGS</span> <span class="o">=</span> <span class="n">MavisNamespace</span><span class="p">(</span><span class="n">LQ</span><span class="o">=</span><span class="s1">&#39;LOWQUAL&#39;</span><span class="p">)</span>

<span class="n">READ_PAIR_TYPE</span> <span class="o">=</span> <span class="n">MavisNamespace</span><span class="p">(</span><span class="n">RR</span><span class="o">=</span><span class="s1">&#39;RR&#39;</span><span class="p">,</span> <span class="n">LL</span><span class="o">=</span><span class="s1">&#39;LL&#39;</span><span class="p">,</span> <span class="n">RL</span><span class="o">=</span><span class="s1">&#39;RL&#39;</span><span class="p">,</span> <span class="n">LR</span><span class="o">=</span><span class="s1">&#39;LR&#39;</span><span class="p">)</span>

<span class="n">CALL_METHOD</span> <span class="o">=</span> <span class="n">MavisNamespace</span><span class="p">(</span><span class="n">CONTIG</span><span class="o">=</span><span class="s1">&#39;contig&#39;</span><span class="p">,</span> <span class="n">SPLIT</span><span class="o">=</span><span class="s1">&#39;split reads&#39;</span><span class="p">,</span> <span class="n">FLANK</span><span class="o">=</span><span class="s1">&#39;flanking reads&#39;</span><span class="p">,</span> <span class="n">SPAN</span><span class="o">=</span><span class="s1">&#39;spanning reads&#39;</span><span class="p">,</span> <span class="n">INPUT</span><span class="o">=</span><span class="s1">&#39;input&#39;</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;:class:`MavisNamespace`: holds controlled vocabulary for allowed call methods</span>

<span class="sd">- ``CONTIG``: a contig was assembled and aligned across the breakpoints</span>
<span class="sd">- ``SPLIT``: the event was called by :term:`split read`</span>
<span class="sd">- ``FLANK``: the event was called by :term:`flanking read pair`</span>
<span class="sd">- ``SPAN``: the event was called by :term:`spanning read`</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">GENE_PRODUCT_TYPE</span> <span class="o">=</span> <span class="n">MavisNamespace</span><span class="p">(</span><span class="n">SENSE</span><span class="o">=</span><span class="s1">&#39;sense&#39;</span><span class="p">,</span> <span class="n">ANTI_SENSE</span><span class="o">=</span><span class="s1">&#39;anti-sense&#39;</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;:class:`MavisNamespace`: controlled vocabulary for gene products</span>

<span class="sd">- ``SENSE``: the gene product is a sense fusion</span>
<span class="sd">- ``ANTI_SENSE``: the gene product is anti-sense</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">PRIME</span> <span class="o">=</span> <span class="n">MavisNamespace</span><span class="p">(</span><span class="n">FIVE</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">THREE</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;:class:`MavisNamespace`: holds controlled vocabulary</span>

<span class="sd">- ``FIVE``: five prime</span>
<span class="sd">- ``THREE``: three prime</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">START_AA</span> <span class="o">=</span> <span class="s1">&#39;M&#39;</span>
<span class="sd">&quot;&quot;&quot;:class:`str`: The amino acid expected to start translation</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">STOP_AA</span> <span class="o">=</span> <span class="s1">&#39;*&#39;</span>
<span class="sd">&quot;&quot;&quot;:class:`str`: The amino acid expected to end translation</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">GIEMSA_STAIN</span> <span class="o">=</span> <span class="n">MavisNamespace</span><span class="p">(</span>
    <span class="n">GNEG</span><span class="o">=</span><span class="s1">&#39;gneg&#39;</span><span class="p">,</span>
    <span class="n">GPOS50</span><span class="o">=</span><span class="s1">&#39;gpos50&#39;</span><span class="p">,</span>
    <span class="n">GPOS75</span><span class="o">=</span><span class="s1">&#39;gpos75&#39;</span><span class="p">,</span>
    <span class="n">GPOS25</span><span class="o">=</span><span class="s1">&#39;gpos25&#39;</span><span class="p">,</span>
    <span class="n">GPOS100</span><span class="o">=</span><span class="s1">&#39;gpos100&#39;</span><span class="p">,</span>
    <span class="n">ACEN</span><span class="o">=</span><span class="s1">&#39;acen&#39;</span><span class="p">,</span>
    <span class="n">GVAR</span><span class="o">=</span><span class="s1">&#39;gvar&#39;</span><span class="p">,</span>
    <span class="n">STALK</span><span class="o">=</span><span class="s1">&#39;stalk&#39;</span>
<span class="p">)</span>
<span class="sd">&quot;&quot;&quot;:class:`MavisNamespace`: holds controlled vocabulary relating to stains of chromosome bands&quot;&quot;&quot;</span>

<span class="c1"># content related to tabbed files for input/output</span>
<span class="c1"># ensure that we don&#39;t have to change ALL the code when we update column names</span>


<span class="n">COLUMNS</span> <span class="o">=</span> <span class="n">MavisNamespace</span><span class="p">(</span>
    <span class="n">tracking_id</span><span class="o">=</span><span class="s1">&#39;tracking_id&#39;</span><span class="p">,</span>
    <span class="n">library</span><span class="o">=</span><span class="s1">&#39;library&#39;</span><span class="p">,</span>
    <span class="n">cluster_id</span><span class="o">=</span><span class="s1">&#39;cluster_id&#39;</span><span class="p">,</span>
    <span class="n">cluster_size</span><span class="o">=</span><span class="s1">&#39;cluster_size&#39;</span><span class="p">,</span>
    <span class="n">validation_id</span><span class="o">=</span><span class="s1">&#39;validation_id&#39;</span><span class="p">,</span>
    <span class="n">annotation_id</span><span class="o">=</span><span class="s1">&#39;annotation_id&#39;</span><span class="p">,</span>
    <span class="n">product_id</span><span class="o">=</span><span class="s1">&#39;product_id&#39;</span><span class="p">,</span>
    <span class="n">event_type</span><span class="o">=</span><span class="s1">&#39;event_type&#39;</span><span class="p">,</span>
    <span class="n">pairing</span><span class="o">=</span><span class="s1">&#39;pairing&#39;</span><span class="p">,</span>
    <span class="n">inferred_pairing</span><span class="o">=</span><span class="s1">&#39;inferred_pairing&#39;</span><span class="p">,</span>
    <span class="n">gene1</span><span class="o">=</span><span class="s1">&#39;gene1&#39;</span><span class="p">,</span>
    <span class="n">gene1_direction</span><span class="o">=</span><span class="s1">&#39;gene1_direction&#39;</span><span class="p">,</span>
    <span class="n">gene2</span><span class="o">=</span><span class="s1">&#39;gene2&#39;</span><span class="p">,</span>
    <span class="n">gene2_direction</span><span class="o">=</span><span class="s1">&#39;gene2_direction&#39;</span><span class="p">,</span>
    <span class="n">gene1_aliases</span><span class="o">=</span><span class="s1">&#39;gene1_aliases&#39;</span><span class="p">,</span>
    <span class="n">gene2_aliases</span><span class="o">=</span><span class="s1">&#39;gene2_aliases&#39;</span><span class="p">,</span>
    <span class="n">gene_product_type</span><span class="o">=</span><span class="s1">&#39;gene_product_type&#39;</span><span class="p">,</span>
    <span class="n">transcript1</span><span class="o">=</span><span class="s1">&#39;transcript1&#39;</span><span class="p">,</span>
    <span class="n">transcript2</span><span class="o">=</span><span class="s1">&#39;transcript2&#39;</span><span class="p">,</span>
    <span class="n">fusion_splicing_pattern</span><span class="o">=</span><span class="s1">&#39;fusion_splicing_pattern&#39;</span><span class="p">,</span>
    <span class="n">fusion_cdna_coding_start</span><span class="o">=</span><span class="s1">&#39;fusion_cdna_coding_start&#39;</span><span class="p">,</span>
    <span class="n">fusion_cdna_coding_end</span><span class="o">=</span><span class="s1">&#39;fusion_cdna_coding_end&#39;</span><span class="p">,</span>
    <span class="n">fusion_mapped_domains</span><span class="o">=</span><span class="s1">&#39;fusion_mapped_domains&#39;</span><span class="p">,</span>
    <span class="n">fusion_sequence_fasta_id</span><span class="o">=</span><span class="s1">&#39;fusion_sequence_fasta_id&#39;</span><span class="p">,</span>
    <span class="n">fusion_sequence_fasta_file</span><span class="o">=</span><span class="s1">&#39;fusion_sequence_fasta_file&#39;</span><span class="p">,</span>
    <span class="n">fusion_protein_hgvs</span><span class="o">=</span><span class="s1">&#39;fusion_protein_hgvs&#39;</span><span class="p">,</span>
    <span class="n">annotation_figure</span><span class="o">=</span><span class="s1">&#39;annotation_figure&#39;</span><span class="p">,</span>
    <span class="n">annotation_figure_legend</span><span class="o">=</span><span class="s1">&#39;annotation_figure_legend&#39;</span><span class="p">,</span>
    <span class="n">genes_encompassed</span><span class="o">=</span><span class="s1">&#39;genes_encompassed&#39;</span><span class="p">,</span>
    <span class="n">genes_overlapping_break1</span><span class="o">=</span><span class="s1">&#39;genes_overlapping_break1&#39;</span><span class="p">,</span>
    <span class="n">genes_overlapping_break2</span><span class="o">=</span><span class="s1">&#39;genes_overlapping_break2&#39;</span><span class="p">,</span>
    <span class="n">genes_proximal_to_break1</span><span class="o">=</span><span class="s1">&#39;genes_proximal_to_break1&#39;</span><span class="p">,</span>
    <span class="n">genes_proximal_to_break2</span><span class="o">=</span><span class="s1">&#39;genes_proximal_to_break2&#39;</span><span class="p">,</span>
    <span class="n">break1_chromosome</span><span class="o">=</span><span class="s1">&#39;break1_chromosome&#39;</span><span class="p">,</span>
    <span class="n">break1_position_start</span><span class="o">=</span><span class="s1">&#39;break1_position_start&#39;</span><span class="p">,</span>
    <span class="n">break1_position_end</span><span class="o">=</span><span class="s1">&#39;break1_position_end&#39;</span><span class="p">,</span>
    <span class="n">break1_orientation</span><span class="o">=</span><span class="s1">&#39;break1_orientation&#39;</span><span class="p">,</span>
    <span class="n">exon_last_5prime</span><span class="o">=</span><span class="s1">&#39;exon_last_5prime&#39;</span><span class="p">,</span>
    <span class="n">exon_first_3prime</span><span class="o">=</span><span class="s1">&#39;exon_first_3prime&#39;</span><span class="p">,</span>
    <span class="n">break1_strand</span><span class="o">=</span><span class="s1">&#39;break1_strand&#39;</span><span class="p">,</span>
    <span class="n">break1_seq</span><span class="o">=</span><span class="s1">&#39;break1_seq&#39;</span><span class="p">,</span>
    <span class="n">break2_chromosome</span><span class="o">=</span><span class="s1">&#39;break2_chromosome&#39;</span><span class="p">,</span>
    <span class="n">break2_position_start</span><span class="o">=</span><span class="s1">&#39;break2_position_start&#39;</span><span class="p">,</span>
    <span class="n">break2_position_end</span><span class="o">=</span><span class="s1">&#39;break2_position_end&#39;</span><span class="p">,</span>
    <span class="n">break2_orientation</span><span class="o">=</span><span class="s1">&#39;break2_orientation&#39;</span><span class="p">,</span>
    <span class="n">break2_strand</span><span class="o">=</span><span class="s1">&#39;break2_strand&#39;</span><span class="p">,</span>
    <span class="n">break2_seq</span><span class="o">=</span><span class="s1">&#39;break2_seq&#39;</span><span class="p">,</span>
    <span class="n">opposing_strands</span><span class="o">=</span><span class="s1">&#39;opposing_strands&#39;</span><span class="p">,</span>
    <span class="n">stranded</span><span class="o">=</span><span class="s1">&#39;stranded&#39;</span><span class="p">,</span>
    <span class="n">protocol</span><span class="o">=</span><span class="s1">&#39;protocol&#39;</span><span class="p">,</span>
    <span class="n">disease_status</span><span class="o">=</span><span class="s1">&#39;disease_status&#39;</span><span class="p">,</span>
    <span class="n">tools</span><span class="o">=</span><span class="s1">&#39;tools&#39;</span><span class="p">,</span>
    <span class="n">call_method</span><span class="o">=</span><span class="s1">&#39;call_method&#39;</span><span class="p">,</span>
    <span class="n">break1_ewindow</span><span class="o">=</span><span class="s1">&#39;break1_ewindow&#39;</span><span class="p">,</span>
    <span class="n">break1_ewindow_count</span><span class="o">=</span><span class="s1">&#39;break1_ewindow_count&#39;</span><span class="p">,</span>
    <span class="n">break1_ewindow_practical_coverage</span><span class="o">=</span><span class="s1">&#39;break1_ewindow_practical_coverage&#39;</span><span class="p">,</span>
    <span class="n">break1_homologous_seq</span><span class="o">=</span><span class="s1">&#39;break1_homologous_seq&#39;</span><span class="p">,</span>
    <span class="n">break1_split_read_names</span><span class="o">=</span><span class="s1">&#39;break1_split_read_names&#39;</span><span class="p">,</span>
    <span class="n">break1_split_reads</span><span class="o">=</span><span class="s1">&#39;break1_split_reads&#39;</span><span class="p">,</span>
    <span class="n">break1_split_reads_forced</span><span class="o">=</span><span class="s1">&#39;break1_split_reads_forced&#39;</span><span class="p">,</span>
    <span class="n">break2_ewindow</span><span class="o">=</span><span class="s1">&#39;break2_ewindow&#39;</span><span class="p">,</span>
    <span class="n">break2_ewindow_count</span><span class="o">=</span><span class="s1">&#39;break2_ewindow_count&#39;</span><span class="p">,</span>
    <span class="n">break2_ewindow_practical_coverage</span><span class="o">=</span><span class="s1">&#39;break2_ewindow_practical_coverage&#39;</span><span class="p">,</span>
    <span class="n">break2_homologous_seq</span><span class="o">=</span><span class="s1">&#39;break2_homologous_seq&#39;</span><span class="p">,</span>
    <span class="n">break2_split_read_names</span><span class="o">=</span><span class="s1">&#39;break2_split_read_names&#39;</span><span class="p">,</span>
    <span class="n">break2_split_reads</span><span class="o">=</span><span class="s1">&#39;break2_split_reads&#39;</span><span class="p">,</span>
    <span class="n">break2_split_reads_forced</span><span class="o">=</span><span class="s1">&#39;break2_split_reads_forced&#39;</span><span class="p">,</span>
    <span class="n">contig_alignment_query_consumption</span><span class="o">=</span><span class="s1">&#39;contig_alignment_query_consumption&#39;</span><span class="p">,</span>
    <span class="n">contig_alignment_score</span><span class="o">=</span><span class="s1">&#39;contig_alignment_score&#39;</span><span class="p">,</span>
    <span class="n">contig_alignment_query_name</span><span class="o">=</span><span class="s1">&#39;contig_alignment_query_name&#39;</span><span class="p">,</span>
    <span class="n">contig_read_depth</span><span class="o">=</span><span class="s1">&#39;contig_read_depth&#39;</span><span class="p">,</span>
    <span class="n">contig_break1_read_depth</span><span class="o">=</span><span class="s1">&#39;contig_break1_read_depth&#39;</span><span class="p">,</span>
    <span class="n">contig_break2_read_depth</span><span class="o">=</span><span class="s1">&#39;contig_break2_read_depth&#39;</span><span class="p">,</span>
    <span class="n">contig_blat_rank</span><span class="o">=</span><span class="s1">&#39;contig_blat_rank&#39;</span><span class="p">,</span>
    <span class="n">contig_build_score</span><span class="o">=</span><span class="s1">&#39;contig_build_score&#39;</span><span class="p">,</span>
    <span class="n">contig_remap_score</span><span class="o">=</span><span class="s1">&#39;contig_remap_score&#39;</span><span class="p">,</span>
    <span class="n">contig_remap_coverage</span><span class="o">=</span><span class="s1">&#39;contig_remap_coverage&#39;</span><span class="p">,</span>
    <span class="n">contig_remapped_read_names</span><span class="o">=</span><span class="s1">&#39;contig_remapped_read_names&#39;</span><span class="p">,</span>
    <span class="n">contig_remapped_reads</span><span class="o">=</span><span class="s1">&#39;contig_remapped_reads&#39;</span><span class="p">,</span>
    <span class="n">contig_seq</span><span class="o">=</span><span class="s1">&#39;contig_seq&#39;</span><span class="p">,</span>
    <span class="n">contig_strand_specific</span><span class="o">=</span><span class="s1">&#39;contig_strand_specific&#39;</span><span class="p">,</span>
    <span class="n">contigs_aligned</span><span class="o">=</span><span class="s1">&#39;contigs_aligned&#39;</span><span class="p">,</span>
    <span class="n">contigs_assembled</span><span class="o">=</span><span class="s1">&#39;contigs_assembled&#39;</span><span class="p">,</span>
    <span class="n">spanning_reads</span><span class="o">=</span><span class="s1">&#39;spanning_reads&#39;</span><span class="p">,</span>
    <span class="n">spanning_read_names</span><span class="o">=</span><span class="s1">&#39;spanning_read_names&#39;</span><span class="p">,</span>
    <span class="n">flanking_median_fragment_size</span><span class="o">=</span><span class="s1">&#39;flanking_median_fragment_size&#39;</span><span class="p">,</span>
    <span class="n">flanking_pairs</span><span class="o">=</span><span class="s1">&#39;flanking_pairs&#39;</span><span class="p">,</span>
    <span class="n">flanking_pairs_compatible</span><span class="o">=</span><span class="s1">&#39;flanking_pairs_compatible&#39;</span><span class="p">,</span>
    <span class="n">flanking_pairs_read_names</span><span class="o">=</span><span class="s1">&#39;flanking_pairs_read_names&#39;</span><span class="p">,</span>
    <span class="n">flanking_pairs_compatible_read_names</span><span class="o">=</span><span class="s1">&#39;flanking_pairs_compatible_read_names&#39;</span><span class="p">,</span>
    <span class="n">flanking_stdev_fragment_size</span><span class="o">=</span><span class="s1">&#39;flanking_stdev_fragment_size&#39;</span><span class="p">,</span>
    <span class="n">linking_split_read_names</span><span class="o">=</span><span class="s1">&#39;linking_split_read_names&#39;</span><span class="p">,</span>
    <span class="n">linking_split_reads</span><span class="o">=</span><span class="s1">&#39;linking_split_reads&#39;</span><span class="p">,</span>
    <span class="n">raw_break1_half_mapped_reads</span><span class="o">=</span><span class="s1">&#39;raw_break1_half_mapped_reads&#39;</span><span class="p">,</span>
    <span class="n">raw_break1_split_reads</span><span class="o">=</span><span class="s1">&#39;raw_break1_split_reads&#39;</span><span class="p">,</span>
    <span class="n">raw_break2_half_mapped_reads</span><span class="o">=</span><span class="s1">&#39;raw_break2_half_mapped_reads&#39;</span><span class="p">,</span>
    <span class="n">raw_break2_split_reads</span><span class="o">=</span><span class="s1">&#39;raw_break2_split_reads&#39;</span><span class="p">,</span>
    <span class="n">raw_flanking_pairs</span><span class="o">=</span><span class="s1">&#39;raw_flanking_pairs&#39;</span><span class="p">,</span>
    <span class="n">raw_spanning_reads</span><span class="o">=</span><span class="s1">&#39;raw_spanning_reads&#39;</span><span class="p">,</span>
    <span class="n">untemplated_seq</span><span class="o">=</span><span class="s1">&#39;untemplated_seq&#39;</span><span class="p">,</span>
    <span class="n">filter_comment</span><span class="o">=</span><span class="s1">&#39;filter_comment&#39;</span><span class="p">,</span>
    <span class="n">cdna_synon</span><span class="o">=</span><span class="s1">&#39;cdna_synon&#39;</span><span class="p">,</span>
    <span class="n">protein_synon</span><span class="o">=</span><span class="s1">&#39;protein_synon&#39;</span><span class="p">,</span>
    <span class="n">supplementary_call</span><span class="o">=</span><span class="s1">&#39;supplementary_call&#39;</span><span class="p">,</span>
    <span class="n">net_size</span><span class="o">=</span><span class="s1">&#39;net_size&#39;</span><span class="p">,</span>
    <span class="n">repeat_count</span><span class="o">=</span><span class="s1">&#39;repeat_count&#39;</span><span class="p">,</span>
    <span class="n">assumed_untemplated</span><span class="o">=</span><span class="s1">&#39;assumed_untemplated&#39;</span>
<span class="p">)</span>
<span class="sd">&quot;&quot;&quot;:class:`MavisNamespace`: Column names for i/o files used throughout the pipeline</span>

<span class="sd">- :term:`annotation_figure_legend`</span>
<span class="sd">- :term:`annotation_figure`</span>
<span class="sd">- :term:`annotation_id`</span>
<span class="sd">- :term:`break1_chromosome`</span>
<span class="sd">- :term:`break1_ewindow_count`</span>
<span class="sd">- :term:`break1_ewindow_practical_coverage`</span>
<span class="sd">- :term:`break1_ewindow`</span>
<span class="sd">- :term:`break1_homologous_seq`</span>
<span class="sd">- :term:`break1_orientation`</span>
<span class="sd">- :term:`break1_position_end`</span>
<span class="sd">- :term:`break1_position_start`</span>
<span class="sd">- :term:`break1_seq`</span>
<span class="sd">- :term:`break1_split_reads_forced`</span>
<span class="sd">- :term:`break1_split_reads`</span>
<span class="sd">- :term:`break1_strand`</span>
<span class="sd">- :term:`break2_chromosome`</span>
<span class="sd">- :term:`break2_ewindow_count`</span>
<span class="sd">- :term:`break2_ewindow_practical_coverage`</span>
<span class="sd">- :term:`break2_ewindow`</span>
<span class="sd">- :term:`break2_homologous_seq`</span>
<span class="sd">- :term:`break2_orientation`</span>
<span class="sd">- :term:`break2_position_end`</span>
<span class="sd">- :term:`break2_position_start`</span>
<span class="sd">- :term:`break2_seq`</span>
<span class="sd">- :term:`break2_split_reads_forced`</span>
<span class="sd">- :term:`break2_split_reads`</span>
<span class="sd">- :term:`break2_strand`</span>
<span class="sd">- :term:`call_method`</span>
<span class="sd">- :term:`cdna_synon`</span>
<span class="sd">- :term:`cluster_id`</span>
<span class="sd">- :term:`cluster_size`</span>
<span class="sd">- :term:`contig_alignment_cigar`</span>
<span class="sd">- :term:`contig_alignment_query_name`</span>
<span class="sd">- :term:`contig_alignment_reference_start`</span>
<span class="sd">- :term:`contig_alignment_score`</span>
<span class="sd">- :term:`contig_build_score`</span>
<span class="sd">- :term:`contig_remap_coverage`</span>
<span class="sd">- :term:`contig_remap_score`</span>
<span class="sd">- :term:`contig_remapped_read_names`</span>
<span class="sd">- :term:`contig_remapped_reads`</span>
<span class="sd">- :term:`contig_seq`</span>
<span class="sd">- :term:`contig_strand_specific`</span>
<span class="sd">- :term:`contigs_aligned`</span>
<span class="sd">- :term:`contigs_assembled`</span>
<span class="sd">- :term:`event_type`</span>
<span class="sd">- :term:`flanking_median_fragment_size`</span>
<span class="sd">- :term:`flanking_pairs_compatible`</span>
<span class="sd">- :term:`flanking_pairs`</span>
<span class="sd">- :term:`flanking_stdev_fragment_size`</span>
<span class="sd">- :term:`fusion_cdna_coding_end`</span>
<span class="sd">- :term:`fusion_cdna_coding_end`</span>
<span class="sd">- :term:`fusion_cdna_coding_start`</span>
<span class="sd">- :term:`fusion_mapped_domains`</span>
<span class="sd">- :term:`fusion_sequence_fasta_file`</span>
<span class="sd">- :term:`fusion_sequence_fasta_id`</span>
<span class="sd">- :term:`fusion_splicing_pattern`</span>
<span class="sd">- :term:`fusion_protein_hgvs`</span>
<span class="sd">- :term:`gene1_aliases`</span>
<span class="sd">- :term:`gene1_direction`</span>
<span class="sd">- :term:`gene1`</span>
<span class="sd">- :term:`gene2_aliases`</span>
<span class="sd">- :term:`gene2_direction`</span>
<span class="sd">- :term:`gene2`</span>
<span class="sd">- :term:`gene_product_type`</span>
<span class="sd">- :term:`genes_encompassed`</span>
<span class="sd">- :term:`genes_overlapping_break1`</span>
<span class="sd">- :term:`genes_overlapping_break2`</span>
<span class="sd">- :term:`genes_proximal_to_break1`</span>
<span class="sd">- :term:`genes_proximal_to_break2`</span>
<span class="sd">- :term:`inferred_pairing`</span>
<span class="sd">- :term:`library`</span>
<span class="sd">- :term:`linking_split_reads`</span>
<span class="sd">- :term:`net_size`</span>
<span class="sd">- :term:`opposing_strands`</span>
<span class="sd">- :term:`pairing`</span>
<span class="sd">- :term:`product_id`</span>
<span class="sd">- :term:`protein_synon`</span>
<span class="sd">- :term:`protocol`</span>
<span class="sd">- :term:`raw_break1_split_reads`</span>
<span class="sd">- :term:`raw_break2_split_reads`</span>
<span class="sd">- :term:`raw_flanking_pairs`</span>
<span class="sd">- :term:`raw_spanning_reads`</span>
<span class="sd">- :term:`spanning_read_names`</span>
<span class="sd">- :term:`spanning_reads`</span>
<span class="sd">- :term:`stranded`</span>
<span class="sd">- :term:`tools`</span>
<span class="sd">- :term:`tracking_id`</span>
<span class="sd">- :term:`transcript1`</span>
<span class="sd">- :term:`transcript2`</span>
<span class="sd">- :term:`supplementary_call`</span>
<span class="sd">- :term:`untemplated_seq`</span>
<span class="sd">- :term:`validation_id`</span>
<span class="sd">- :term:`repeat_count`</span>
<span class="sd">- :term:`assumed_untemplated`</span>
<span class="sd">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="sort_columns"><a class="viewcode-back" href="../../auto/mavis.constants.html#mavis.align.sort_columns">[docs]</a><span class="k">def</span> <span class="nf">sort_columns</span><span class="p">(</span><span class="n">input_columns</span><span class="p">):</span>
    <span class="n">order</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">COLUMNS</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
        <span class="n">order</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">input_columns</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">order</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">order</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">temp</span> <span class="o">+</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">input_columns</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">order</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">temp</span></div>
</pre></div>

           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, creisle.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>