<div class="row clearfix">
    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">

        <div class="info-box">
            <div class="content col-lg-4 col-md-4 col-sm-4 col-xs-4"
                 ng-class="'status-' + vme.status">
                <!--{{vme.status=='running'?'bg-green':(vme.status=='restarting'?'bg-yellow':'bg-red')}}-->

                <p class="marker-text">{{vme.host.toUpperCase();}}</p>
            </div>
            <div class="content col-lg-8 col-md-8 col-sm-8 col-xs-8" >
                <div class="pull-right" style="font-size:45px;"><b>{{vme.message}}</b></div>
            </div>

        </div>

        <div class="info-box">
            <div class="content col-lg-4 col-md-4 col-sm-4 col-xs-4"
                 ng-class="'status-' + vme_lib.status">
                <p class="marker-text">Readout</p>
            </div>
            <div class="content col-lg-4 col-md-4 col-sm-4 col-xs-4">
                <b>
                    Events/s: {{vme_lib.stats.bl_r_events}}<br/>
                    kByte/s:  {{vme_lib.stats.bl_r_kbyte}}
                </b>
            </div>
            <div class="content col-lg-4 col-md-4 col-sm-4 col-xs-4" >
                <div class="pull-right" style="font-size:45px;"><b>{{vme_lib.message}}</b></div>
            </div>
        </div>

        <div class="info-box">
            <div class="content col-lg-4 col-md-4 col-sm-4 col-xs-4"
                 ng-class="'status-' + relay.status">
                <p class="marker-text">Relay</p>
            </div>
            <div class="content col-lg-8 col-md-8 col-sm-8 col-xs-8">
                <div class="pull-right" >
                    <b style="font-size:30px;">{{relay.message.split(' ')[0] + ': ' + relay.message.split(' ')[1]}}</b></br>
                    <b style="font-size:20px;">{{relay.message.split(' ')[2] + ': ' + relay.message.split(' ')[3]}}</b>
                </div>
            </div>
        </div>

        <div class="info-box">
            <div class="content col-lg-2 col-md-2 col-sm-2 col-xs-2"
                 ng-class="'status-' + go4.status">
                <p class="marker-text">Go4</p>

            </div>
            <div class="content col-lg-2 col-md-2 col-sm-2 col-xs-2"
                 ng-class="'status-' + go4.status">
                <!--<button class="pull-right repeat-btn glyphicon glyphicon-repeat" ng-hide="!currentUser" ng-click="restartGo4()"/>-->

            </div>
            <div class="content col-lg-8 col-md-8 col-sm-8 col-xs-8">
                <div class="pull-right" style="font-size:45px;"><b>{{go4.message}}</b></div>
            </div>
        </div>

        <div class="info-box">
            <div class="content col-lg-4 col-md-4 col-sm-4 col-xs-4"
                 ng-class="'status-' + sync.status">
                <p class="marker-text">Sync</p>
            </div>
            <div class="content col-lg-4 col-md-4 col-sm-4 col-xs-4">
                <div>
                    <b>Remote host:</b></br>
                    {{sync.target[0]}}
                </div>
            </div>
            <div class="content col-lg-4 col-md-4 col-sm-4 col-xs-4">
                <div class="pull-right" style="font-size:45px;"><b>{{sync.message}}</b></div>
            </div>
        </div>

        <div class="info-box">
            <div class="content col-lg-4 col-md-4 col-sm-4 col-xs-4"
                 ng-class="'status-' + mesytec.status">
                <p class="marker-text">Mesytec</p>

            </div>
            <div class="content col-lg-3 col-md-3 col-sm-3 col-xs-3">
                <div>
                    <b>Last check:</b></br>
                    {{toYYYYMMHHMMSS(mesytec.last_check)}}
                </div>
            </div>
            <div class="content col-lg-5 col-md-5 col-sm-5 col-xs-5">
                <div class="pull-right" style="font-size:45px;"><b>{{mesytec.message}}</b></div>
            </div>
        </div>

        <div class="card" ng-controller="TriggerCtrl">
            <script type="text/ng-template" id="TriggerView">
                <!--<form name="form" ng-submit="ok()">-->

                    <div class="card-heading">
                        <div class="row trigger-header" ng-class="setting ? 'status-starting' : ''">
                            <h4 class="col-lg-10 col-md-10 col-sm-10 col-xs-10 text-left card-title">
                                <span>Enable trigger</span>
                            </h4>
                        </div>
                    </div>
                    <div class="table-responsive" >
                        <div ng-repeat="v1 in FOUR track by $index">
                            <div   ng-repeat="v2 in FOUR track by $index"
                                 class="col-lg-3 col-md-3 col-sm-3 col-xs-3 trigger-status"
                                 ng-class="'trigger-' + selected[4*v1+v2]">
                                <div ng-click="selected[4*v1+v2]===null ? '' : selected[4*v1+v2] = !selected[4*v1+v2]" class="pull-left col-lg-7 col-md-7 col-sm-7 col-xs-7">
                                    <big>{{names[4*v1+v2]}}</big>
                                </div>
                                <div class="col-lg-5 col-md-5 col-sm-5 col-xs-5">
                                    <input type="number" class="form-control" ng-model="downscaling[4*v1+v2]" min="0" max="32">
                                </div>


                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <span class="pull-left" ><b>Note: The actual downscaling is 2<sup>n</sup></b></span>
                        <button class="btn btn-primary" ng-click="cancel()">Cancel</button>
                        <button class="btn btn-warning" ng-click="ok()">Apply</button>
                    </div>
                <!--</form>-->
            </script>
            <div class="table-responsive" >
                    <div class="card-heading">
                        <div class="row trigger-header" ng-class="setting ? 'status-starting' : ''">
                            <h4 class="col-lg-10 col-md-10 col-sm-10 col-xs-10 text-left card-title">
                                <span ng-hide="setting">Active trigger: {{trigger.active}}</span>
                                <span ng-show="setting">Setting trigger</span>
                            </h4>

                            <div class="col-lg-2 col-md-2 col-sm-2 col-xs-2 text-right">
                                <span ng-hide="!currentUser" ng-disabled="file.status == 'running'" class="glyphicon glyphicon-edit btn btn-default" ng-click="file.status == 'running' || open()"></span>
                            </div>
                        </div>
                    </div>

                <div ng-repeat="v1 in FOUR track by $index">
                    <div  ng-repeat="v2 in FOUR track by $index"
                         class="col-lg-3 col-md-3 col-sm-3 col-xs-3 trigger-status"
                         ng-class="'trigger-' + trigger.status[4*v1+v2]">
                        <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
                            <b >{{names[4*v1+v2]}}</b>
                        </div>
                        <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 downscaling">
                            <div ng-if="trigger.downscaling[4*v1+v2] > 0">
                                <span class="glyphicon glyphicon-arrow-down"></span><b>{{to_exp(trigger.downscaling[4*v1+v2])}}</b>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

        </div>
    </div>

    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12 file-taker">

        <div class="card filelog" >
            <div class="table-responsive" >
                <table class="table table-striped table-hover header-fixed log-table">
                    <thead>
                    <tr>
                        <th style="width:10%">Nr.</th>
                        <th style="width:20%">Beam</th>
                        <th style="width:20%">Target</th>
                        <th style="width:15%">Energy</th>
                        <th style="width:15%">Start</th>
                        <th style="width:15%">Stop</th>
                        <th style="width:5%"></th>
                        <th style="width:5%"></th>
                    </tr>
                    </thead>
                </table>
            </div>
            <div class="table-responsive file-log-pane">
                <table class="table table-striped table-hover log-table">
                    <tbody>
                    <tr ng-repeat="x in filelog | orderBy: '-run_number'">
                        <td style="width:10%">{{x.run_number}}</td>
                        <td style="width:20%">{{x.beam}}</td>
                        <td style="width:20%">{{x.target}}</td>
                        <td style="width:15%">{{x.beam_energy}} {{x.beam_energy_unit}}</td>
                        <td style="width:15%">{{toYYYYMMHHMMSS(x.start_time)}}</td>
                        <td style="width:15%">{{toYYYYMMHHMMSS(x.stop_time)}}</td>
                        <td style="width:5%"><span popover-trigger="mouseenter" popover="{{x.more_info}}" ng-show="x.more_info" class="glyphicon glyphicon-file ng-cloak"></span></td>
                        <td style="width:5%"><span popover-trigger="mouseenter" popover="{{x.personal}}" ng-show="x.personal" class="glyphicon glyphicon-user ng-cloak"/></td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="card" ng-controller="FileCtrl">

            <div class="body" block-ui="file_block">
                <div class="row clearfix" >
                    <script type="text/ng-template" id="LogInputView">
                        <div ng-hide="logState != 'running'" class="modal-header">
                            <h2>Please update runlog information!</h2>
                        </div>
                        <div ng-hide="logState != 'start'" class="modal-header">
                            <h2>Please fill runlog information</h2>
                            <h3>File IS running!</h3>
                        </div>
                        <div ng-hide="logState != 'stop'" class="modal-header">
                            <h2>Please confirm or update runlog information</h2>
                            <h3>File is no longer running!</h3>
                        </div>

                        <form name="form" ng-submit="ok()">
                            <div class="modal-body">
                                <div class="form-group">

                                    <h4>Facility</h4>
                                    <select ng-model="currentLog.facility">
                                        <option value="IFA">IFA</option>
                                        <option value="ISOLDE">ISOLDE</option>
                                    </select>

                                    <h4>Experiment</h4>
                                    <input type="text" name="experimentI" ng-model="currentLog.experiment" class="form-control form-line" placeholder="VeryFamousExperiment"/>

                                    <h4>Type</h4>
                                    <select ng-model="currentLog.type">
                                        <option value="Run">Run</option>
                                        <option value="Calibration">Calibration</option>
                                        <option value="Test">Test</option>
                                        <option value="Pulser">Pulser</option>
                                    </select>

                                    <h4>Beam</h4>
                                    <input type="text" name="beamI" ng-model="currentLog.beam" class="form-control form-line" placeholder="Rainbows"/>

                                    <h4>Beam energy
                                        <span class="asciierror" ng-show="form.beam_energyI.$error.beamenergy">Error: Format is &lt;number&gt;&lt;unit&gt;</span>
                                    </h4>
                                    <input type="text" name="beam_energyI" ng-model="currentLog.beam_e" beamenergy class="form-control form-line" placeholder="10hp"/>

                                    <h4>People on shift </h4>
                                    <input type="text" name="personalI" ng-model="currentLog.shifters" class="form-control form-line" placeholder="Lex Luther and friends"/>

                                    <h4>Target</h4>
                                    <input type="text" name="targetI" ng-model="currentLog.target" class="form-control form-line" placeholder="Unicorns"/>

                                    <h4>Comments</h4>
                                    <div class="form-line">
                                        <textarea ng-model="currentLog.comments"  rows="4" class="form-control no-resize" placeholder="We had ice cream during the run!"></textarea>
                                    </div>
                                </div>

                                <div class="modal-footer">
                                    <button class="btn btn-primary" ng-disabled="form.beam_energyI.$error.beamenergy">OK</button>
                                </div>
                            </div>
                        </form>

                    </script>
                    <div class="col-sm-12 col-lg-12 col-sm-12 col-xs-12">


                        <div class="content col-lg-2 col-md-2 col-sm-2 col-xs-2">

                            <button ng-hide="file.status!='stopped'" ng-disabled="form.$invalid" class="btn-primary btn" ng-click="logState='start'; submit()">
                                <b class="file-taker-btn">Start</b></br>
                            </button>
                            <button ng-hide="file.status!='running'" class="btn-danger btn" ng-click="logState='stop'; submit()">
                                <b class="file-taker-btn">Stop</b>
                            </button>
                            <button ng-hide="file.status!='stopping'" disabled class="btn-warning btn">
                                <b class="file-taker-btn">Stopping</b>
                            </button>

                        </div>

                        <div class="content col-lg-8 col-md-8 col-sm-8 col-xs-8">
                            <div class="text-center" style="font-size:20pt;">
                                <div ng-hide="file.status != 'running'">
                                    <b> {{file.name}}</b><br/>
                                    <small>Events: {{file.progress}} Errors: {{file.errors}}</small>
                                </div>
                                <div ng-hide="file.status != 'stopped'">
                                    <b> Not taking any file!</b></br>
                                    <small>-</small>
                                </div>
                                <div ng-hide="file.status != 'stopping'">
                                    <b> Building VME-log...</b></br>
                                    <small>-</small>
                                </div>
                            </div>
                        </div>
                        <!--</form>-->

                        <div class="content col-lg-2 col-md-2 col-sm-2 col-xs-2">
                            <div class="text-center ng-cloak blocking-hide" style="font-size:20pt;" ng-hide="file.status != 'running'">
                                <small>{{toHHMMSS(file.start_time)}}</small></br>
                                <small>{{file.file_length}}</small></br>
                                <span class="glyphicon glyphicon-edit btn btn-default" ng-click="logState = 'running';  open()"></span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card-footer" >
                    <big>File directory: {{datadir}} (<b>{{disk.message}}</b>)</big>
                    <div class="pull-right">
                        <select  ng-disabled="file.status != 'stopped'" class="pull-right" ng-model="file_size" style="vertical-align: middle;">
                            <option ng-repeat="option in file_sizes" value="{{option}}">{{option}}</option>
                        </select>
                    </div>
                </div>
            </div>

        </div>

    </div>
</div>
