
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>CSEM forward modelling &amp; Edge elements formulation &#8212; PETGEM 1.01 documentation</title>
    <link rel="stylesheet" href="_static/petgem.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.01',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Installation" href="Installation.html" />
    <link rel="prev" title="Features" href="Features.html" /> 
  </head>
  <body>
<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
  <a href="index.html"><img style="vertical-align: middle" src="_static/figures/petgem_logo.png" border="0" height="80px" alt="PETGEM"/></a>
    <a href="index.html"><strong><font color="#355f7c"> Parallel Edge-based Tool for Geophysical Electromagnetic Modelling</font></strong></a>
  <a href="http://www.bsc.es/"><img src="_static/figures/logo_bsc.jpeg" align="right" border="0" height="80px" alt="BSC"/></a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="Installation.html" title="Installation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="Features.html" title="Features"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Home</a>|&nbsp;</li>
        <li><a href="WhatIs.html">What is PETGEM?</a>|&nbsp;</li>
        <li><a href="Features.html">Features</a>|&nbsp;</li>
        <li><a href="#">CSEM FM modelling</a>|&nbsp;</li>
        <li><a href="Installation.html">Installation</a>|&nbsp;</li>
        <li><a href="Tutorial.html">Tutorial</a>|&nbsp;</li>
        <li><a href="Manual.html">Manual</a>|&nbsp;</li>
        <li><a href="Publications.html">Publications</a>|&nbsp;</li>
	      <li><a href="Download.html">Download</a>|&nbsp;</li>
        <li><a href="Contact.html">Contact</a></li>
 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="Features.html"
                        title="previous chapter">Features</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="Installation.html"
                        title="next chapter">Installation</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="csem-forward-modelling-edge-elements-formulation">
<span id="csem-edge-elements-formulation"></span><h1>CSEM forward modelling &amp; Edge elements formulation<a class="headerlink" href="#csem-forward-modelling-edge-elements-formulation" title="Permalink to this headline">¶</a></h1>
<p>The last decade has been a period of rapid growth for electromagnetic
methods (EM) in geophysics, mostly because of their industrial adoption.
In particular, the 3D marine controlled-source electromagnetic (3D CSEM) method
has become an important technique for reducing ambiguities in data
interpretation in hydrocarbon exploration. In order to be able to predict
the EM signature of a given geological structure, modelling tools provide us
with synthetic results which we can then compare to measured data. In particular,
if the geology is structurally complex, one might need to use methods able
to cope with such complexity in a natural way by means of, e.g., an
unstructured mesh representing its geometry. Among the modelling methods
for EM based upon 3D unstructured meshes, the Nédélec Edge Finite Element
Method (EFEM) offers a good trade-off between accuracy and number of degrees
of freedom, e.g. size of the problem. Furthermore, its divergence-free basis
is very well suited for solving Maxwell’s equation. On top of that, we choose
to support tetrahedral meshes, as these are the easiest to use for very large
domains or complex geometries. We present the numerical formulation and
results of 3D CSEM forward modelling (FM) using tetrahedral EFEM on
unstructured meshes.</p>
<div class="section" id="csem-problem">
<span id="id1"></span><h2>CSEM problem<a class="headerlink" href="#csem-problem" title="Permalink to this headline">¶</a></h2>
<p>3D CSEM FM is typically solved in frequency domain, which involves
the numerical solution of Maxwell’s equations in stationary regimes for
heterogeneous anisotropic electrically conductive domains. Furthermore,
CSEM surveys generally work with low frequency electromagnetic fields
(<img class="math" src="_images/math/5ecfb5efd13556512083272088a2baa0839e3c66.png" alt="\sim"/> 1 Hz to <img class="math" src="_images/math/5ecfb5efd13556512083272088a2baa0839e3c66.png" alt="\sim"/> 3 Hz) because the electric conductivity of the geological
structures is much larger than their dielectric permittivity. As a
consequence, in an unbound domain <img class="math" src="_images/math/d872993ed0c7c420e73e77a1d285ac100c516806.png" alt="\Gamma"/>, the electric field
can be obtained by solving Maxwell’s equations in their diffusive form:</p>
<div class="math" id="equation-maxwellDiffusive">
<p><span class="eqno">(1)<a class="headerlink" href="#equation-maxwellDiffusive" title="Permalink to this equation">¶</a></span><img src="_images/math/8c77da2488bbc1f116151218ea2db969e41278a9.png" alt="\nabla \times \mathbf{E} &amp;= i\omega \mu_{0}\mathbf H  \\
      \nabla \times \mathbf{H} &amp;= \mathbf J_{s} + \tilde{\sigma}\mathbf E"/></p>
</div><p>where the harmonic time dependence <img class="math" src="_images/math/949aeae100d4cedce0cdac415b623cb45987a610.png" alt="e^{-i \omega t}"/> is omitted,
with <img class="math" src="_images/math/b51aa99e0bc8cc8c3d17c0b9cf822db73e13293e.png" alt="\omega"/> is the angular frequency, <img class="math" src="_images/math/0637d483fd4572928af77d351880fa5d99de0639.png" alt="\mu_{0}"/> the free
space magnetic permeability, <img class="math" src="_images/math/cb5fc5bdb973c86de9def73a1a02062126b06948.png" alt="\mathbf J_{s}"/> the distribution of
source current, <img class="math" src="_images/math/1b1751f7c08678ec02839c883370e1f485bf1cfe.png" alt="\tilde{\sigma}\mathbf E"/> the induced current in
the conductive Earth and <img class="math" src="_images/math/54a34fd8abde26fa0013111971eccd6158094e8b.png" alt="\tilde{\sigma}"/> the electrical conductivity
which is assumed isotropic for simplicity.</p>
<p>In numerical approximations of EM fields there are two main drawbacks.
The first one is the inevitable spatial singularity at the source. The
second is the grid refinement requirements in order to capture the rapid
change of the primary field <a class="footnote-reference" href="#id8" id="id2">[1]</a>. In order to mitigate these issues,
PETGEM used a secondary field approach where the total electric
field <img class="math" src="_images/math/85bab93280badb33fa5af4e02512594786b8b96d.png" alt="\mathbf E"/> is obtained as:</p>
<div class="math" id="equation-total_electric_field">
<p><span class="eqno">(2)<a class="headerlink" href="#equation-total_electric_field" title="Permalink to this equation">¶</a></span><img src="_images/math/a6a3f8d12297ed2927849fdb3781c0b2a102a10f.png" alt="\mathbf E &amp;= \mathbf E_{p} + \mathbf E_{s} \\
\tilde{\sigma} &amp;=  \tilde{\sigma_{s}} + \Delta \tilde{\sigma}"/></p>
</div><p>where subscripts <img class="math" src="_images/math/27d463da4622be5b3ef1d4176ced7d7a323c6425.png" alt="p"/> and <img class="math" src="_images/math/63751cb2e98ba393b0f22e45ca127c3cebb61487.png" alt="s"/> represent a primary field and
secondary field respectively. For a general layered Earth model,
<img class="math" src="_images/math/4494e9b5e147f29c6cd47e00ad0805d3c13c0d99.png" alt="\mathbf E_{p}"/> can be computed semi-analytically by using Hankel
transform filters. Based on this decomposition and following the work by
<a class="footnote-reference" href="#id10" id="id3">[3]</a> the equation system to solve <img class="math" src="_images/math/eaa3cc725b3b1d2897f997f93c7b7a058130eb58.png" alt="\mathbf E_{s}"/> is:</p>
<div class="math" id="equation-electric_field_weak_form1">
<p><span class="eqno">(3)<a class="headerlink" href="#equation-electric_field_weak_form1" title="Permalink to this equation">¶</a></span><img src="_images/math/128cb7613c50e091d5ed0c4c631f94c14b2208ea.png" alt="\nabla \times \nabla \times \mathbf E_{s} + i \omega \mu \tilde{\sigma} \mathbf E_{s} = -i \omega \mu \Delta \sigma \mathbf E_{p}"/></p>
</div><p>where the electrical conductivity <img class="math" src="_images/math/011e5790a6c33043ceadca81d9657dde6c61d769.png" alt="\sigma"/> is a function of position
that is allowed to vary in 3D, whereas the vacuum permeability <img class="math" src="_images/math/d79e8a2c7ce54906c2b25549da38bdbe02cf40d6.png" alt="\mu"/>
is set to the free space value <img class="math" src="_images/math/0637d483fd4572928af77d351880fa5d99de0639.png" alt="\mu_{0}"/>. Homogeneous Dirichlet
boundary conditions, <img class="math" src="_images/math/8b5bfe447077684d8941d5813a7eac322b809de9.png" alt="\mathbf E_{s} = 0"/> on <img class="math" src="_images/math/7e2fc44f1822d652ad5eec7fb3a4091404b2bae9.png" alt="\partial\Gamma"/>,
are applied. The range of applicability of this conditions can be determined
based on the skin depth of the electric field <a class="footnote-reference" href="#id11" id="id4">[4]</a>.</p>
</div>
<div class="section" id="edge-finite-element-formulation">
<span id="id5"></span><h2>Edge finite element formulation<a class="headerlink" href="#edge-finite-element-formulation" title="Permalink to this headline">¶</a></h2>
<p>For the computation of <img class="math" src="_images/math/eaa3cc725b3b1d2897f997f93c7b7a058130eb58.png" alt="\mathbf E_{s}"/>, PETGEM implemented the
Nédélec EFEM which uses vector basis functions defined on the edges of
the corresponding elements. Its basis functions are divergence-free but
not curl-free <a class="footnote-reference" href="#id9" id="id6">[2]</a>. Thus, EFEM naturally ensures tangential continuity and
allows normal discontinuity of <img class="math" src="_images/math/eaa3cc725b3b1d2897f997f93c7b7a058130eb58.png" alt="\mathbf E_{s}"/> at material interfaces.
PETGEM used unstructured tetrahedral meshes because of their ability to
represent complex geological structures such as bathymetry or reservoirs as
well as the local refinement capability in order to improve the solution
accuracy. <a class="reference internal" href="#figure-4-1">Figure 4.1</a> shows the tetrahedral Nédélec elements (lowest order)
together with their node and edge indexing.</p>
<div class="figure align-center" id="id12">
<span id="figure-4-1"></span><a class="reference internal image-reference" href="_images/edgeElement.jpg"><img alt="Tetrahedral Nédélec edge element with node/edge indexing." src="_images/edgeElement.jpg" style="width: 396.96px; height: 241.44px;" /></a>
<p class="caption"><span class="caption-text">Figure 4.1. Tetrahedral Nédélec edge element with node/edge indexing.</span></p>
</div>
<p>In PETGEM workflow, the tangential component of the secondary electric
field is assigned to the edges in the mesh. Therefore, all components of the
electric field at a point <img class="math" src="_images/math/b9040d52d78d98aea6867a562560cc34dd30b780.png" alt="\mathbf x"/> located inside a tetrahedral
element <img class="math" src="_images/math/78a06cf7a34f39fde71fbba0d5539baae7c72d4e.png" alt="e"/> can be obtained as follows:</p>
<div class="math" id="equation-field_components_edge_element">
<p><span class="eqno">(4)<a class="headerlink" href="#equation-field_components_edge_element" title="Permalink to this equation">¶</a></span><img src="_images/math/0f61209c74e91af59effb0034a18c9e20842b9ad.png" alt="\mathbf E^{e}(\mathbf x) = \sum_{i=1}^{6} \mathbf N^{e}_{i}(\mathbf x) E^{e}_{i}"/></p>
</div><p>where <img class="math" src="_images/math/8dad0dea5e39bdc613bcdbee3df2aa308c4bfb36.png" alt="\mathbf N^{e}_{i}"/> are the vector basis functions associated
to each edge <img class="math" src="_images/math/df0deb143e5ac127f00bd248ee8001ecae572adc.png" alt="i"/> and <img class="math" src="_images/math/66c954fa19dbde81a9ef695623119ca386b322a8.png" alt="E^{e}_{i}"/> their degrees of freedom.
Considering the node and edge indexing in <a class="reference internal" href="#figure-4-1">Figure 4.1</a>, the vector basis
functions can be expressed as follows:</p>
<div class="math" id="equation-nedelec_basis">
<p><span class="eqno">(5)<a class="headerlink" href="#equation-nedelec_basis" title="Permalink to this equation">¶</a></span><img src="_images/math/b33ce3703c911a1378e4daee36821363ac79623a.png" alt="\mathbf N^{e}_{i} &amp;= (\lambda^{e}_{i1} \nabla \lambda^{e}_{i2} - \lambda^{e}_{i2} \nabla \lambda^{e}_{i1}) \ell^{e}_{i}"/></p>
</div><p>where subscripts <img class="math" src="_images/math/1b23b00cdc487a2b00a9d479e09947c43e8bf66b.png" alt="i1"/> and <img class="math" src="_images/math/a83d027b4a941b54bdc83c9dd2f8aa3c17632757.png" alt="i2"/> are the first and second nodes
linked to the <img class="math" src="_images/math/df0deb143e5ac127f00bd248ee8001ecae572adc.png" alt="i"/>-th edge, <img class="math" src="_images/math/18fbb1ca63534927f6185e7da753a45d89e8a6bb.png" alt="\lambda^{e}_{i}"/> are the linear
nodal basis functions, and <img class="math" src="_images/math/43e5f6f8941e97dad900f219e8296c1ead98fae7.png" alt="\ell^{e}_{i}"/> is the length of the
<img class="math" src="_images/math/df0deb143e5ac127f00bd248ee8001ecae572adc.png" alt="i"/>-th edge of the element <img class="math" src="_images/math/78a06cf7a34f39fde71fbba0d5539baae7c72d4e.png" alt="e"/>.</p>
<p>By substituting equation <a class="reference internal" href="#equation-field_components_edge_element">(4)</a> into
<a class="reference internal" href="#equation-electric_field_weak_form1">(3)</a>, and using Galerkin’s approach, the weak
form of the original differential equation becomes:</p>
<div class="math" id="equation-electric_field_weak_form2">
<p><span class="eqno">(6)<a class="headerlink" href="#equation-electric_field_weak_form2" title="Permalink to this equation">¶</a></span><img src="_images/math/ca92360eea377f62866449804d0938704a76f5bf.png" alt="Q_{i} = \int_{\Omega} \mathbf N_{i} \cdot [ \nabla \times \nabla \times \mathbf E_{s} -i \omega \mu \tilde{\sigma} \mathbf E_{s} + i \omega \mu \Delta \tilde{\sigma} \mathbf E_{p} ] dV"/></p>
</div><p>The compact discretized form of <a class="reference internal" href="#equation-electric_field_weak_form2">(6)</a> is
obtained after applying the Green’s theorem:</p>
<div class="math" id="equation-system_eq_edge_electric">
<p><span class="eqno">(7)<a class="headerlink" href="#equation-system_eq_edge_electric" title="Permalink to this equation">¶</a></span><img src="_images/math/382bac1ca802500dfe8557b2cc59091ce27a7357.png" alt="[K^{e}_{jk} + i \omega \tilde{\sigma}_{e} M^{e}_{jk}] \cdot  \{ E_{sk} \} = - i \omega \mu \Delta \tilde{\sigma}_{e} R^{e}_k"/></p>
</div><p>where <img class="math" src="_images/math/04615352c253577db465254c8472a56a22f929e3.png" alt="K^{e}"/> and <img class="math" src="_images/math/108b261d0fb9e1fc5ef05bca89d81f9536276306.png" alt="M^{e}"/> are the elemental stiffness
and mass matrices which can be calculated analytically
or numerically <a class="footnote-reference" href="#id9" id="id7">[2]</a>, and <img class="math" src="_images/math/92d87ddbc8556091823ce39983632b51a9017155.png" alt="R^{e}_k"/> is the right hand
side which requires numerical integration.</p>
<table class="docutils footnote" frame="void" id="id8" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[1]</a></td><td>Cai, H., Xiong, B., Han, M. and Zhdanov, M. (2014). 3D controlled-source electromagnetic modeling in anisotropic medium using edge-based finite element method. Computers &amp; Geosciences, 73, 164–176.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id9" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td><em>(<a class="fn-backref" href="#id6">1</a>, <a class="fn-backref" href="#id7">2</a>)</em> Jin, J. (2002). The Finite Element Method in Electromagnetics. Wiley, New York, second edn.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id10" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[3]</a></td><td>Newman, G.A. and Alumbaugh, D.L. (2002). Three-dimensional induction logging problems, Part 2: A finite difference solution. Geophysics, 67(2), 484–491.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id11" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[4]</a></td><td>Puzyrev, V., Koldan, J., de la Puente, J., Houzeaux, G., Vázquez, M. and Cela, J.M. (2013). A parallel finite-element method for three-dimensional controlled-source electromagnetic forward modelling. Geophysical Journal International, ggt027.</td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="Installation.html" title="Installation"
             >next</a> |</li>
        <li class="right" >
          <a href="Features.html" title="Features"
             >previous</a> |</li>
        <li><a href="index.html">Home</a>|&nbsp;</li>
        <li><a href="WhatIs.html">What is PETGEM?</a>|&nbsp;</li>
        <li><a href="Features.html">Features</a>|&nbsp;</li>
        <li><a href="#">CSEM FM modelling</a>|&nbsp;</li>
        <li><a href="Installation.html">Installation</a>|&nbsp;</li>
        <li><a href="Tutorial.html">Tutorial</a>|&nbsp;</li>
        <li><a href="Manual.html">Manual</a>|&nbsp;</li>
        <li><a href="Publications.html">Publications</a>|&nbsp;</li>
	      <li><a href="Download.html">Download</a>|&nbsp;</li>
        <li><a href="Contact.html">Contact</a></li>
 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Octavio Castillo Reyes.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.6.
    </div>
  </body>
</html>