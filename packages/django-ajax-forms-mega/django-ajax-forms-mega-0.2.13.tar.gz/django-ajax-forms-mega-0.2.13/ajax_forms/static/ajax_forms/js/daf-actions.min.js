(function(e){e.fn.daf_actions=function(t){var n=e.extend({},e.fn.daf_actions.defaults,t);var r=e(this);var i=false;var s=function(t){if(t){u()}else{f()}e(r).attr("checked",t).parent().parent().toggleClass(n.selectedClass,t)},o=function(){var t=e(r).filter(":checked").length;e(n.counterContainer).html(interpolate(ngettext("%(sel)s of %(cnt)s selected","%(sel)s of %(cnt)s selected",t),{sel:t,cnt:_actions_icnt},true));e(n.allToggle).attr("checked",function(){if(t==r.length){value=true;u()}else{value=false;l()}return value})},u=function(){e(n.acrossClears).hide();e(n.acrossQuestions).css("display",n.acrossQuestionsDisplay);e(n.allContainer).hide()},a=function(){e(n.acrossClears).css("display",n.acrossClearsDisplay);e(n.acrossQuestions).hide();e(n.actionContainer).toggleClass(n.selectedClass);e(n.allContainer).css("display",n.allContainerDisplay);e(n.counterContainer).hide()},f=function(){e(n.acrossClears).hide();e(n.acrossQuestions).hide();e(n.allContainer).hide();e(n.counterContainer).show()},l=function(){f();e(n.acrossInput).val(0);e(n.actionContainer).removeClass(n.selectedClass)};e(n.counterContainer).show();e(this).filter(":checked").each(function(t){e(this).parent().parent().toggleClass(n.selectedClass);o();if(e(n.acrossInput).val()==1){a()}});e(n.allToggle).show().click(function(){s(e(this).attr("checked"));o()});e(n.acrossQuestions).click(function(t){t.preventDefault();e(n.acrossInput).val(1);e(n.allToggle).attr("checked",true);s(1);a()});e(n.acrossClears).click(function(t){t.preventDefault();e(n.allToggle).attr("checked",false);l();s(0);o();u()});lastChecked=null;e(r).click(function(t){if(!t){t=window.event}var i=t.target?t.target:t.srcElement;if(lastChecked&&e.data(lastChecked)!=e.data(i)&&t.shiftKey===true){var s=false;e(lastChecked).attr("checked",i.checked).parent().parent().toggleClass(n.selectedClass,i.checked);e(r).each(function(){if(e.data(this)==e.data(lastChecked)||e.data(this)==e.data(i)){s=s?false:true}if(s){e(this).attr("checked",i.checked).parent().parent().toggleClass(n.selectedClass,i.checked)}})}e(i).parent().parent().toggleClass(n.selectedClass,i.checked);lastChecked=i;o()});e("form#changelist-form table#result_list tr").find("td:gt(0) :input").change(function(){i=true});e('form#changelist-form button[name="index"]').click(function(e){if(i){return confirm(gettext("You have unsaved changes on individual editable fields. If you run an action, your unsaved changes will be lost."))}});e('form#changelist-form input[name="_save"]').click(function(t){var n=false;e("div.actions select option:selected").each(function(){if(e(this).val()){n=true}});if(n){if(i){return confirm(gettext("You have selected an action, but you haven't saved your changes to individual fields yet. Please click OK to save. You'll need to re-run the action."))}else{return confirm(gettext("You have selected an action, and you haven't made any changes on individual fields. You're probably looking for the Go button rather than the Save button."))}}})};e.fn.daf_actions.defaults={actionContainer:"div.actions",counterContainer:"span.action-counter",allContainer:"div.actions span.all",allContainerDisplay:"inline-block",acrossInput:"div.actions input.select-across",acrossQuestions:"div.actions span.question",acrossQuestionsDisplay:"inline-block",acrossClears:"div.actions span.clear",acrossClearsDisplay:"inline-block",allToggle:"#action-toggle",selectedClass:"selected"}})(django.jQuery)