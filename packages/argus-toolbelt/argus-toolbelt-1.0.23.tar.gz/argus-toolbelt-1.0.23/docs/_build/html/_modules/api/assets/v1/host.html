
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>api.assets.v1.host &#8212; Argus-Toolbelt 1.0 documentation</title>
    <link rel="stylesheet" href="../../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
   
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for api.assets.v1.host</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Autogenerated API&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">argus_cli.plugin</span> <span class="k">import</span> <span class="n">register_command</span>



<div class="viewcode-block" id="search_host_assets_simplified"><a class="viewcode-back" href="../../../../api/api.assets.v1.html#api.assets.v1.host.search_host_assets_simplified">[docs]</a><span class="nd">@register_command</span><span class="p">(</span><span class="n">extending</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;assets&quot;</span><span class="p">,</span><span class="s2">&quot;v1&quot;</span><span class="p">,</span><span class="s2">&quot;host&quot;</span><span class="p">))</span>



<span class="k">def</span> <span class="nf">search_host_assets_simplified</span><span class="p">(</span>
    <span class="n">keywords</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">keywordField</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">name</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">hostID</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">serviceID</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">businessProcessID</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">customerID</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">ip</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">port</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">protocol</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">cpe</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">vulnID</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">vulnRef</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">includeFlag</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">excludeFlag</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">sortBy</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> 
    <span class="n">keywordMatch</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span> 
    
    <span class="n">json</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">verify</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">apiKey</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">authentication</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
  <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns as set of HostAssets defined by query parameters. (PUBLIC)</span>

<span class="sd">    :param list keywords: Search by keywords</span>
<span class="sd">    :param list keywordField: Set field strategy for keyword search</span>
<span class="sd">    :param list name: Search by name</span>
<span class="sd">    :param list hostID: Search by HostAsset ID</span>
<span class="sd">    :param list serviceID: Search by ServiceAsset ID</span>
<span class="sd">    :param list businessProcessID: Search by BusinessProcess ID</span>
<span class="sd">    :param list customerID: Search by customer ID</span>
<span class="sd">    :param list ip: Search by IP range</span>
<span class="sd">    :param list port: Search by application port</span>
<span class="sd">    :param list protocol: Search by application protocol</span>
<span class="sd">    :param list cpe: Search by CPE</span>
<span class="sd">    :param list vulnID: Search by vulnerability ID</span>
<span class="sd">    :param list vulnRef: Search by vulnerability reference</span>
<span class="sd">    :param list includeFlag: Include certain HostAssets in the search result based on set flags</span>
<span class="sd">    :param list excludeFlag: Exclude certain HostAssets from the search result based on set flags</span>
<span class="sd">    :param list sortBy: Sort search result</span>
<span class="sd">    :param int offset: Skip a number of results</span>
<span class="sd">    :param int limit: Maximum number of returned results</span>
<span class="sd">    :param str keywordMatch: Set match strategy for keyword search</span>
<span class="sd">    :raises AuthenticationFailedException: on 401</span>
<span class="sd">    :raises ValidationErrorException: on 412</span>
<span class="sd">    :raises AccessDeniedException: on 403</span>
<span class="sd">    :returns: {&#39;offset&#39;: 395, &#39;limit&#39;: 426, &#39;responseCode&#39;: 200, &#39;count&#39;: 878, &#39;data&#39;: [{&#39;id&#39;: &#39;Those thought former turn least per near.&#39;, &#39;ownedByUser&#39;: {&#39;id&#39;: 166, &#39;customerID&#39;: 607, &#39;userName&#39;: &#39;matthew06&#39;, &#39;name&#39;: &#39;Nicholas Martinez&#39;}, &#39;name&#39;: &#39;Taylor Henderson&#39;, &#39;description&#39;: &#39;Congress record return guess play.&#39;, &#39;totalCvss&#39;: 364, &#39;vulnerabilitiesCount&#39;: 647, &#39;createdTimestamp&#39;: 670655087, &#39;createdByUser&#39;: {&#39;id&#39;: 392, &#39;customerID&#39;: 573, &#39;userName&#39;: &#39;hlee&#39;, &#39;name&#39;: &#39;Wendy Leonard&#39;}, &#39;lastUpdatedTimestamp&#39;: 1276691337, &#39;lastUpdatedByUser&#39;: {&#39;id&#39;: 500, &#39;customerID&#39;: 411, &#39;userName&#39;: &#39;fullerjohn&#39;, &#39;name&#39;: &#39;Jillian Jensen&#39;}, &#39;deletedTimestamp&#39;: 1179079842, &#39;deletedByUser&#39;: {&#39;id&#39;: 361, &#39;customerID&#39;: 419, &#39;userName&#39;: &#39;jonathanbutler&#39;, &#39;name&#39;: &#39;Jacqueline Ruiz&#39;}, &#39;flags&#39;: [&#39;MISSING_FROM_CVM&#39;], &#39;properties&#39;: {&#39;additionalProperties&#39;: &#39;Professional mission account anything we follow.&#39;}, &#39;firstSeenTimestamp&#39;: 12933564, &#39;lastSeenTimestamp&#39;: 44080731, &#39;lastScanTimestamp&#39;: 1508773092, &#39;ipAddresses&#39;: [{&#39;host&#39;: False, &#39;maskBits&#39;: 514, &#39;ipv6&#39;: True, &#39;multicast&#39;: False, &#39;public&#39;: True, &#39;address&#39;: &#39;Son find south tell.&#39;}], &#39;aliases&#39;: [{&#39;fqdn&#39;: &#39;Run already oil member floor data.&#39;}], &#39;services&#39;: [{&#39;id&#39;: &#39;Respond get party professional region.&#39;, &#39;name&#39;: &#39;Kathy Harris&#39;}], &#39;applications&#39;: [{&#39;id&#39;: &#39;Of reality environment particular.&#39;, &#39;name&#39;: &#39;Debra Moore&#39;, &#39;description&#39;: &#39;Thousand religious city care.&#39;, &#39;createdTimestamp&#39;: 1473774753, &#39;lastUpdatedTimestamp&#39;: 319793551, &#39;deletedTimestamp&#39;: 1434276536, &#39;firstSeenTimestamp&#39;: 586121112, &#39;lastSeenTimestamp&#39;: 221816753, &#39;flags&#39;: [&#39;CONTROLLED_VERSION&#39;], &#39;properties&#39;: {&#39;additionalProperties&#39;: &#39;Owner perhaps drop mouth.&#39;}, &#39;cpe&#39;: &#39;Difficult continue participant financial.&#39;, &#39;sockets&#39;: [&#39;Former enjoy often.&#39;]}], &#39;vulnerabilities&#39;: [{&#39;id&#39;: &#39;Allow part occur rise another account.&#39;, &#39;vulnerabilityID&#39;: &#39;Message shoulder leave campaign.&#39;, &#39;references&#39;: [&#39;Push miss attorney.&#39;], &#39;name&#39;: &#39;Kevin Leon&#39;, &#39;description&#39;: &#39;Whatever rest newspaper travel parent source manager.&#39;, &#39;conclusion&#39;: &#39;Usually now national child cultural indeed.&#39;, &#39;solution&#39;: &#39;Home reality voice mouth try green war the.&#39;, &#39;rawOutput&#39;: &#39;Let everyone learn stay.&#39;, &#39;cvss&#39;: 969, &#39;createdTimestamp&#39;: 1267329465, &#39;lastUpdatedTimestamp&#39;: 1151314183, &#39;deletedTimestamp&#39;: 1106196342, &#39;firstSeenTimestamp&#39;: 65585162, &#39;lastSeenTimestamp&#39;: 679906854, &#39;resolutionTimestamp&#39;: 847398257, &#39;resolutionComment&#39;: &#39;End purpose offer run true.&#39;, &#39;resolution&#39;: &#39;UNRESOLVED&#39;, &#39;flags&#39;: [&#39;DETECTED_BY_CVM&#39;], &#39;properties&#39;: {&#39;additionalProperties&#39;: &#39;Morning market list yard base image fact.&#39;}, &#39;severity&#39;: &#39;info&#39;, &#39;socket&#39;: &#39;Up head effect of.&#39;}], &#39;operatingSystemCPE&#39;: &#39;Happen safe question operation feeling.&#39;}], &#39;metaData&#39;: {&#39;additionalProperties&#39;: {}}, &#39;messages&#39;: [{&#39;message&#39;: &#39;Him world same.&#39;, &#39;messageTemplate&#39;: &#39;Get realize wait leg spring fish first.&#39;, &#39;field&#39;: &#39;Collection team difficult after.&#39;, &#39;parameter&#39;: {}, &#39;timestamp&#39;: 821353051}], &#39;currentPage&#39;: 826, &#39;size&#39;: 676}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">requests</span> <span class="k">import</span> <span class="n">get</span>
    <span class="kn">from</span> <span class="nn">argus_api.exceptions</span> <span class="k">import</span> <span class="n">http</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://portal.mnemonic.no/web/api/assets/v1/host&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">()</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
        <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s1">&#39;ArgusToolbelt/&#39;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">apiKey</span><span class="p">:</span>
        <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;Argus-API-Key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">apiKey</span>
    <span class="k">elif</span> <span class="n">authentication</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">authentication</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">authentication</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">callable</span><span class="p">(</span><span class="n">authentication</span><span class="p">):</span>
        <span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">authentication</span><span class="p">(</span><span class="n">url</span><span class="p">))</span>

    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;offset&quot;</span><span class="p">:</span> <span class="n">offset</span><span class="p">,</span> 
        <span class="s2">&quot;limit&quot;</span><span class="p">:</span> <span class="n">limit</span><span class="p">,</span> 
        <span class="s2">&quot;keywordMatch&quot;</span><span class="p">:</span> <span class="n">keywordMatch</span><span class="p">,</span> 
        <span class="s2">&quot;keywords&quot;</span><span class="p">:</span> <span class="n">keywords</span><span class="p">,</span> 
        <span class="s2">&quot;keywordField&quot;</span><span class="p">:</span> <span class="n">keywordField</span><span class="p">,</span> 
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span> 
        <span class="s2">&quot;hostID&quot;</span><span class="p">:</span> <span class="n">hostID</span><span class="p">,</span> 
        <span class="s2">&quot;serviceID&quot;</span><span class="p">:</span> <span class="n">serviceID</span><span class="p">,</span> 
        <span class="s2">&quot;businessProcessID&quot;</span><span class="p">:</span> <span class="n">businessProcessID</span><span class="p">,</span> 
        <span class="s2">&quot;customerID&quot;</span><span class="p">:</span> <span class="n">customerID</span><span class="p">,</span> 
        <span class="s2">&quot;ip&quot;</span><span class="p">:</span> <span class="n">ip</span><span class="p">,</span> 
        <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="n">port</span><span class="p">,</span> 
        <span class="s2">&quot;protocol&quot;</span><span class="p">:</span> <span class="n">protocol</span><span class="p">,</span> 
        <span class="s2">&quot;cpe&quot;</span><span class="p">:</span> <span class="n">cpe</span><span class="p">,</span> 
        <span class="s2">&quot;vulnID&quot;</span><span class="p">:</span> <span class="n">vulnID</span><span class="p">,</span> 
        <span class="s2">&quot;vulnRef&quot;</span><span class="p">:</span> <span class="n">vulnRef</span><span class="p">,</span> 
        <span class="s2">&quot;includeFlag&quot;</span><span class="p">:</span> <span class="n">includeFlag</span><span class="p">,</span> 
        <span class="s2">&quot;excludeFlag&quot;</span><span class="p">:</span> <span class="n">excludeFlag</span><span class="p">,</span> 
        <span class="s2">&quot;sortBy&quot;</span><span class="p">:</span> <span class="n">sortBy</span>
    <span class="p">}</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span>
                    <span class="n">json</span><span class="o">=</span><span class="n">body</span> <span class="k">if</span> <span class="n">body</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">verify</span><span class="o">=</span><span class="n">verify</span><span class="p">,</span>
                    <span class="n">headers</span><span class="o">=</span><span class="n">headers</span>
                <span class="p">)</span>

    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">401</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">AuthenticationFailedException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">403</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">AccessDeniedException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">412</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">ValidationErrorException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">ObjectNotFoundException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span> <span class="k">if</span> <span class="n">json</span> <span class="k">else</span> <span class="n">response</span></div>

<div class="viewcode-block" id="add_host_asset"><a class="viewcode-back" href="../../../../api/api.assets.v1.html#api.assets.v1.host.add_host_asset">[docs]</a><span class="nd">@register_command</span><span class="p">(</span><span class="n">extending</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;assets&quot;</span><span class="p">,</span><span class="s2">&quot;v1&quot;</span><span class="p">,</span><span class="s2">&quot;host&quot;</span><span class="p">))</span>



<span class="k">def</span> <span class="nf">add_host_asset</span><span class="p">(</span>
    <span class="n">ownerID</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">customerID</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">properties</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">operatingSystemCPE</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">ipAddresses</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">aliases</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="nb">type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;SERVER&quot;</span><span class="p">,</span> 
    <span class="n">source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;USER&quot;</span><span class="p">,</span> 
    
    <span class="n">json</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">verify</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">apiKey</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">authentication</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
  <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Creates a new HostAsset. (PUBLIC)</span>

<span class="sd">    :param int ownerID: User who owns the asset. </span>
<span class="sd">    :param int customerID: Customer the asset belongs to. </span>
<span class="sd">    :param str name: Name of the asset.  =&gt; [\s\w\{\}\$\-\(\)\.\[\]&quot;\&#39;_/\\,\*\+\#:@!?;]*</span>
<span class="sd">    :param str description: Description of the asset.  =&gt; [\s\w\{\}\$\-\(\)\.\[\]&quot;\&#39;_/\\,\*\+\#:@!?;]*</span>
<span class="sd">    :param dict properties: Custom user-defined properties.  =&gt; [\s\w\{\}\$\-\(\)\.\[\]&quot;\&#39;_/\\,\*\+\#:@!?;]*</span>
<span class="sd">    :param str operatingSystemCPE: CPE of the host operating system. </span>
<span class="sd">    :param list ipAddresses: IP address(es) of the host. </span>
<span class="sd">    :param list aliases: Aliases (domain names) of the host. </span>
<span class="sd">    :param str type: Defines if host is a client or a server. (default SERVER)</span>
<span class="sd">    :param str source: Source of the request. (default USER)</span>
<span class="sd">    :raises AuthenticationFailedException: on 401</span>
<span class="sd">    :raises ValidationErrorException: on 412</span>
<span class="sd">    :raises AccessDeniedException: on 403</span>
<span class="sd">    :returns: {&#39;offset&#39;: 52, &#39;limit&#39;: 251, &#39;responseCode&#39;: 200, &#39;count&#39;: 652, &#39;metaData&#39;: {&#39;additionalProperties&#39;: {}}, &#39;messages&#39;: [{&#39;message&#39;: &#39;Agreement able head.&#39;, &#39;messageTemplate&#39;: &#39;Size voice read actually just interview picture financial.&#39;, &#39;field&#39;: &#39;Explain right together.&#39;, &#39;parameter&#39;: {}, &#39;timestamp&#39;: 231690513}], &#39;currentPage&#39;: 209, &#39;size&#39;: 826}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">requests</span> <span class="k">import</span> <span class="n">post</span>
    <span class="kn">from</span> <span class="nn">argus_api.exceptions</span> <span class="k">import</span> <span class="n">http</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://portal.mnemonic.no/web/api/assets/v1/host&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">()</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
        <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s1">&#39;ArgusToolbelt/&#39;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">apiKey</span><span class="p">:</span>
        <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;Argus-API-Key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">apiKey</span>
    <span class="k">elif</span> <span class="n">authentication</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">authentication</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">authentication</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">callable</span><span class="p">(</span><span class="n">authentication</span><span class="p">):</span>
        <span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">authentication</span><span class="p">(</span><span class="n">url</span><span class="p">))</span>

    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="nb">type</span><span class="p">,</span> 
        <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="n">source</span><span class="p">,</span> 
        <span class="s2">&quot;ownerID&quot;</span><span class="p">:</span> <span class="n">ownerID</span><span class="p">,</span> 
        <span class="s2">&quot;customerID&quot;</span><span class="p">:</span> <span class="n">customerID</span><span class="p">,</span> 
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span> 
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">description</span><span class="p">,</span> 
        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="n">properties</span><span class="p">,</span> 
        <span class="s2">&quot;operatingSystemCPE&quot;</span><span class="p">:</span> <span class="n">operatingSystemCPE</span><span class="p">,</span> 
        <span class="s2">&quot;ipAddresses&quot;</span><span class="p">:</span> <span class="n">ipAddresses</span><span class="p">,</span> 
        <span class="s2">&quot;aliases&quot;</span><span class="p">:</span> <span class="n">aliases</span>
    <span class="p">}</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span>
                    <span class="n">json</span><span class="o">=</span><span class="n">body</span> <span class="k">if</span> <span class="n">body</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">verify</span><span class="o">=</span><span class="n">verify</span><span class="p">,</span>
                    <span class="n">headers</span><span class="o">=</span><span class="n">headers</span>
                <span class="p">)</span>

    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">401</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">AuthenticationFailedException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">403</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">AccessDeniedException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">412</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">ValidationErrorException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">ObjectNotFoundException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span> <span class="k">if</span> <span class="n">json</span> <span class="k">else</span> <span class="n">response</span></div>

<div class="viewcode-block" id="bulk_update_host_asset"><a class="viewcode-back" href="../../../../api/api.assets.v1.html#api.assets.v1.host.bulk_update_host_asset">[docs]</a><span class="nd">@register_command</span><span class="p">(</span><span class="n">extending</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;assets&quot;</span><span class="p">,</span><span class="s2">&quot;v1&quot;</span><span class="p">,</span><span class="s2">&quot;host&quot;</span><span class="p">))</span>



<span class="k">def</span> <span class="nf">bulk_update_host_asset</span><span class="p">(</span>
    <span class="n">assetVulnerabilityAddRequests</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">assetVulnerabilityUpdateRequests</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">assetVulnerabilityResolveRequests</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">assetVulnerabilityDeleteRequests</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">hostApplicationAddRequests</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">hostApplicationUpdateRequests</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">hostApplicationDeleteRequests</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">hostAssetAddRequests</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">hostAssetUpdateRequests</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">hostAssetDeleteRequests</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;USER&quot;</span><span class="p">,</span> 
    
    <span class="n">json</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">verify</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">apiKey</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">authentication</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
  <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Performs multiple updates to HostAssets in a single transaction. (PUBLIC)</span>

<span class="sd">    :param list assetVulnerabilityAddRequests: List of AssetVulnerabilityAddRequests. </span>
<span class="sd">    :param list assetVulnerabilityUpdateRequests: List of AssetVulnerabilityUpdateRequests. </span>
<span class="sd">    :param list assetVulnerabilityResolveRequests: List of AssetVulnerabilityResolveRequests. </span>
<span class="sd">    :param list assetVulnerabilityDeleteRequests: List of AssetVulnerabilityDeleteRequests. </span>
<span class="sd">    :param list hostApplicationAddRequests: List of HostApplicationAddRequests. </span>
<span class="sd">    :param list hostApplicationUpdateRequests: List of HostApplicationUpdateRequests. </span>
<span class="sd">    :param list hostApplicationDeleteRequests: List of HostApplicationDeleteRequests. </span>
<span class="sd">    :param list hostAssetAddRequests: List of HostAssetAddRequests. Adding vulnerabilities/applications to added hosts must be done in separate transaction. </span>
<span class="sd">    :param list hostAssetUpdateRequests: List of HostAssetUpdateRequests. </span>
<span class="sd">    :param list hostAssetDeleteRequests: List of HostAssetDeleteRequests. </span>
<span class="sd">    :param str source: Source of the request. (default USER)</span>
<span class="sd">    :raises AuthenticationFailedException: on 401</span>
<span class="sd">    :raises ValidationErrorException: on 412</span>
<span class="sd">    :raises AccessDeniedException: on 403</span>
<span class="sd">    :raises ObjectNotFoundException: on 404</span>
<span class="sd">    :returns: {&#39;offset&#39;: 997, &#39;limit&#39;: 365, &#39;responseCode&#39;: 200, &#39;count&#39;: 723, &#39;metaData&#39;: {&#39;additionalProperties&#39;: {}}, &#39;messages&#39;: [{&#39;message&#39;: &#39;Style cut court their.&#39;, &#39;messageTemplate&#39;: &#39;Law around woman ok.&#39;, &#39;field&#39;: &#39;Over field lead test board road.&#39;, &#39;parameter&#39;: {}, &#39;timestamp&#39;: 374872856}], &#39;currentPage&#39;: 372, &#39;size&#39;: 363}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">requests</span> <span class="k">import</span> <span class="n">put</span>
    <span class="kn">from</span> <span class="nn">argus_api.exceptions</span> <span class="k">import</span> <span class="n">http</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://portal.mnemonic.no/web/api/assets/v1/host&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">()</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
        <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s1">&#39;ArgusToolbelt/&#39;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">apiKey</span><span class="p">:</span>
        <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;Argus-API-Key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">apiKey</span>
    <span class="k">elif</span> <span class="n">authentication</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">authentication</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">authentication</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">callable</span><span class="p">(</span><span class="n">authentication</span><span class="p">):</span>
        <span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">authentication</span><span class="p">(</span><span class="n">url</span><span class="p">))</span>

    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="n">source</span><span class="p">,</span> 
        <span class="s2">&quot;assetVulnerabilityAddRequests&quot;</span><span class="p">:</span> <span class="n">assetVulnerabilityAddRequests</span><span class="p">,</span> 
        <span class="s2">&quot;assetVulnerabilityUpdateRequests&quot;</span><span class="p">:</span> <span class="n">assetVulnerabilityUpdateRequests</span><span class="p">,</span> 
        <span class="s2">&quot;assetVulnerabilityResolveRequests&quot;</span><span class="p">:</span> <span class="n">assetVulnerabilityResolveRequests</span><span class="p">,</span> 
        <span class="s2">&quot;assetVulnerabilityDeleteRequests&quot;</span><span class="p">:</span> <span class="n">assetVulnerabilityDeleteRequests</span><span class="p">,</span> 
        <span class="s2">&quot;hostApplicationAddRequests&quot;</span><span class="p">:</span> <span class="n">hostApplicationAddRequests</span><span class="p">,</span> 
        <span class="s2">&quot;hostApplicationUpdateRequests&quot;</span><span class="p">:</span> <span class="n">hostApplicationUpdateRequests</span><span class="p">,</span> 
        <span class="s2">&quot;hostApplicationDeleteRequests&quot;</span><span class="p">:</span> <span class="n">hostApplicationDeleteRequests</span><span class="p">,</span> 
        <span class="s2">&quot;hostAssetAddRequests&quot;</span><span class="p">:</span> <span class="n">hostAssetAddRequests</span><span class="p">,</span> 
        <span class="s2">&quot;hostAssetUpdateRequests&quot;</span><span class="p">:</span> <span class="n">hostAssetUpdateRequests</span><span class="p">,</span> 
        <span class="s2">&quot;hostAssetDeleteRequests&quot;</span><span class="p">:</span> <span class="n">hostAssetDeleteRequests</span>
    <span class="p">}</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">put</span><span class="p">(</span><span class="n">url</span><span class="p">,</span>
                    <span class="n">json</span><span class="o">=</span><span class="n">body</span> <span class="k">if</span> <span class="n">body</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">verify</span><span class="o">=</span><span class="n">verify</span><span class="p">,</span>
                    <span class="n">headers</span><span class="o">=</span><span class="n">headers</span>
                <span class="p">)</span>

    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">401</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">AuthenticationFailedException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">403</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">AccessDeniedException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">412</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">ValidationErrorException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">ObjectNotFoundException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span> <span class="k">if</span> <span class="n">json</span> <span class="k">else</span> <span class="n">response</span></div>

<div class="viewcode-block" id="search_host_assets"><a class="viewcode-back" href="../../../../api/api.assets.v1.html#api.assets.v1.host.search_host_assets">[docs]</a><span class="nd">@register_command</span><span class="p">(</span><span class="n">extending</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;assets&quot;</span><span class="p">,</span><span class="s2">&quot;v1&quot;</span><span class="p">,</span><span class="s2">&quot;host&quot;</span><span class="p">))</span>



<span class="k">def</span> <span class="nf">search_host_assets</span><span class="p">(</span>
    <span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">subCriteria</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">customerID</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">name</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">startTimestamp</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">endTimestamp</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">keywords</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">keywordMatchStrategy</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">timeMatchStrategy</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">hostID</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">serviceID</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">businessProcessID</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">ipRange</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">applicationPort</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">applicationProtocol</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">cpe</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">hostCPE</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">applicationCPE</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">ownerID</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">criticality</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">minimumTotalCvss</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">maximumTotalCvss</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">vulnerabilityReference</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">vulnerabilityID</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">applicationRole</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="nb">type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">timeFieldStrategy</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">keywordFieldStrategy</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">sortBy</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">includeFlags</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">excludeFlags</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">includeDeleted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">exclude</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">required</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">includeVulnerabilityRawOutput</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">includeVulnerabilityConclusion</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">includeVulnerabilitySolution</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">includeVulnerabilities</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">includeApplications</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">includeServices</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">connectedToService</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    
    <span class="n">json</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">verify</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">apiKey</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">authentication</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
  <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns a set of HostAssets defined by a HostAssetSearchCriteria. (PUBLIC)</span>

<span class="sd">    :param int limit: Set this value to set max number of results. By default, no restriction on result set size. </span>
<span class="sd">    :param int offset: Set this value to skip the first (offset) objects. By default, return result from first object. </span>
<span class="sd">    :param list subCriteria: </span>
<span class="sd">    :param list customerID: Restrict search to data belonging to specified customers. </span>
<span class="sd">    :param list name: Restrict search to specific asset name </span>
<span class="sd">    :param int startTimestamp: Restrict search to a time frame based on the set TimeFieldStrategy (start timestamp). </span>
<span class="sd">    :param int endTimestamp: Restrict search to a time frame based on the set TimeFieldStrategy (end timestamp). </span>
<span class="sd">    :param list keywords: Search for keywords. </span>
<span class="sd">    :param str keywordMatchStrategy: Defines the MatchStrategy for keywords (default match all keywords). </span>
<span class="sd">    :param str timeMatchStrategy: Defines how strict to match against different timestamps (all/any) using start and end timestamp (default any) </span>
<span class="sd">    :param list hostID: Restrict search to specific host UUIDs. </span>
<span class="sd">    :param list serviceID: Restrict search to specific service UUIDs. </span>
<span class="sd">    :param list businessProcessID: Restrict search to specific business process UUIDs. </span>
<span class="sd">    :param list ipRange: Restrict search to entities related to these IP-addresses (may specify single IPs, IP networks or IP ranges. </span>
<span class="sd">    :param list applicationPort: Restrict to applications listening on specific ports. </span>
<span class="sd">    :param list applicationProtocol: Restrict to applications by transport protocol name. </span>
<span class="sd">    :param list cpe: Restrict to applications or hosts by CPE. </span>
<span class="sd">    :param list hostCPE: Restrict to hosts by CPE. </span>
<span class="sd">    :param list applicationCPE: Restrict to applications by CPE. </span>
<span class="sd">    :param list ownerID: Restrict search to specific ownerIDs </span>
<span class="sd">    :param list criticality: Restrict search to a range of criticality levels (add multiple CriticalitySearch objects to specify OR criteria). </span>
<span class="sd">    :param int minimumTotalCvss: Restrict search to a minimum total CVSS score. </span>
<span class="sd">    :param int maximumTotalCvss: Restrict search to a maximum total CVSS score. </span>
<span class="sd">    :param list vulnerabilityReference: Restrict to vulnerabilities identified by vulnerability reference. </span>
<span class="sd">    :param list vulnerabilityID: Restrict to vulnerabilities identified by vulnerability ID. </span>
<span class="sd">    :param list applicationRole: Restrict to applications with specific roles (list of role IDs). </span>
<span class="sd">    :param str type: Restrict search to a specific type of host (client or server). </span>
<span class="sd">    :param list timeFieldStrategy: Defines which timestamps will be included in the search (default lastUpdatedTimestamp on host). </span>
<span class="sd">    :param list keywordFieldStrategy: Defines which fields will be searched by keywords (default all supported fields). </span>
<span class="sd">    :param list sortBy: List of properties to sort by (prefix with &quot;-&quot; to sort descending). </span>
<span class="sd">    :param list includeFlags: Only include objects which have includeFlags set. </span>
<span class="sd">    :param list excludeFlags: Exclude objects which have excludeFlags set. </span>
<span class="sd">    :param bool includeDeleted: Set to true to include deleted objects. By default, exclude deleted objects. </span>
<span class="sd">    :param bool exclude: Only relevant for subcriteria. If set to true, objects matching this subcriteria object will be excluded. </span>
<span class="sd">    :param bool required: Only relevant for subcriteria. If set to true, objects matching this subcriteria are required (AND-ed together with parent criteria). </span>
<span class="sd">    :param bool includeVulnerabilityRawOutput: Include vulnerability rawOutput in result (default false). </span>
<span class="sd">    :param bool includeVulnerabilityConclusion: Include vulnerability conclusion in result (default false). </span>
<span class="sd">    :param bool includeVulnerabilitySolution: Include vulnerability solution in result (default false). </span>
<span class="sd">    :param bool includeVulnerabilities: Include host vulnerabilities in result (default false). </span>
<span class="sd">    :param bool includeApplications: Include host applications in result (default false). </span>
<span class="sd">    :param bool includeServices: Include related services in result (default false). </span>
<span class="sd">    :param bool connectedToService: If true, only return hosts connected to service(s). If false, return hosts not connected to any service. If not set, do not filter. </span>
<span class="sd">    :raises AuthenticationFailedException: on 401</span>
<span class="sd">    :raises ValidationErrorException: on 412</span>
<span class="sd">    :raises AccessDeniedException: on 403</span>
<span class="sd">    :returns: {&#39;offset&#39;: 538, &#39;limit&#39;: 281, &#39;responseCode&#39;: 200, &#39;count&#39;: 821, &#39;data&#39;: [{&#39;id&#39;: &#39;Page shoulder cultural relationship great responsibility himself.&#39;, &#39;ownedByUser&#39;: {&#39;id&#39;: 298, &#39;customerID&#39;: 455, &#39;userName&#39;: &#39;aaron86&#39;, &#39;name&#39;: &#39;Gloria Woods&#39;}, &#39;name&#39;: &#39;Aaron Hughes&#39;, &#39;description&#39;: &#39;Economy choice unit.&#39;, &#39;totalCvss&#39;: 654, &#39;vulnerabilitiesCount&#39;: 897, &#39;createdTimestamp&#39;: 672179060, &#39;createdByUser&#39;: {&#39;id&#39;: 425, &#39;customerID&#39;: 583, &#39;userName&#39;: &#39;zponce&#39;, &#39;name&#39;: &#39;Aaron Johnson&#39;}, &#39;lastUpdatedTimestamp&#39;: 314636528, &#39;lastUpdatedByUser&#39;: {&#39;id&#39;: 407, &#39;customerID&#39;: 678, &#39;userName&#39;: &#39;wwolfe&#39;, &#39;name&#39;: &#39;Maria Phillips&#39;}, &#39;deletedTimestamp&#39;: 618587141, &#39;deletedByUser&#39;: {&#39;id&#39;: 248, &#39;customerID&#39;: 761, &#39;userName&#39;: &#39;justin71&#39;, &#39;name&#39;: &#39;Ms. Shannon Wilson&#39;}, &#39;flags&#39;: [&#39;CREATED_BY_CVM&#39;], &#39;properties&#39;: {&#39;additionalProperties&#39;: &#39;Expect perform miss.&#39;}, &#39;firstSeenTimestamp&#39;: 1265030626, &#39;lastSeenTimestamp&#39;: 1154042419, &#39;lastScanTimestamp&#39;: 1461106155, &#39;ipAddresses&#39;: [{&#39;host&#39;: False, &#39;maskBits&#39;: 375, &#39;ipv6&#39;: True, &#39;multicast&#39;: False, &#39;public&#39;: False, &#39;address&#39;: &#39;Operation major technology seat stay lose.&#39;}], &#39;aliases&#39;: [{&#39;fqdn&#39;: &#39;Nothing hand pressure friend need.&#39;}], &#39;services&#39;: [{&#39;id&#39;: &#39;Likely school produce indicate.&#39;, &#39;name&#39;: &#39;Marcia Martinez&#39;}], &#39;applications&#39;: [{&#39;id&#39;: &#39;Try little region career moment blue reality price.&#39;, &#39;name&#39;: &#39;Raymond Rush&#39;, &#39;description&#39;: &#39;Improve seem me individual.&#39;, &#39;createdTimestamp&#39;: 198237260, &#39;lastUpdatedTimestamp&#39;: 1294782591, &#39;deletedTimestamp&#39;: 576509307, &#39;firstSeenTimestamp&#39;: 137337230, &#39;lastSeenTimestamp&#39;: 1500240908, &#39;flags&#39;: [&#39;UPDATED_BY_CVM&#39;], &#39;properties&#39;: {&#39;additionalProperties&#39;: &#39;Radio building order identify everyone over policy.&#39;}, &#39;cpe&#39;: &#39;Attorney foot like company.&#39;, &#39;sockets&#39;: [&#39;Various happy none about window.&#39;]}], &#39;vulnerabilities&#39;: [{&#39;id&#39;: &#39;Fill human happen particularly body throw.&#39;, &#39;vulnerabilityID&#39;: &#39;Feeling occur scientist pressure garden for.&#39;, &#39;references&#39;: [&#39;Read card bad imagine.&#39;], &#39;name&#39;: &#39;Catherine Andrews&#39;, &#39;description&#39;: &#39;Discuss break chance huge tell.&#39;, &#39;conclusion&#39;: &#39;Down leader fight simple fund.&#39;, &#39;solution&#39;: &#39;Arrive light issue write.&#39;, &#39;rawOutput&#39;: &#39;Conference anything sign beyond build manager.&#39;, &#39;cvss&#39;: 582, &#39;createdTimestamp&#39;: 729559987, &#39;lastUpdatedTimestamp&#39;: 1292555180, &#39;deletedTimestamp&#39;: 1323324791, &#39;firstSeenTimestamp&#39;: 1288476556, &#39;lastSeenTimestamp&#39;: 60099858, &#39;resolutionTimestamp&#39;: 904356071, &#39;resolutionComment&#39;: &#39;Structure opportunity road law against identify.&#39;, &#39;resolution&#39;: &#39;ACCEPTED&#39;, &#39;flags&#39;: [&#39;MISSING_FROM_CVM&#39;], &#39;properties&#39;: {&#39;additionalProperties&#39;: &#39;Night born evidence mother because.&#39;}, &#39;severity&#39;: &#39;medium&#39;, &#39;socket&#39;: &#39;Pretty back foreign suffer deal no mouth.&#39;}], &#39;operatingSystemCPE&#39;: &#39;Since character within professor.&#39;}], &#39;metaData&#39;: {&#39;additionalProperties&#39;: {}}, &#39;messages&#39;: [{&#39;message&#39;: &#39;Tree reason program approach see think age.&#39;, &#39;messageTemplate&#39;: &#39;Director practice campaign require discussion.&#39;, &#39;field&#39;: &#39;Next detail event claim open fight.&#39;, &#39;parameter&#39;: {}, &#39;timestamp&#39;: 393846466}], &#39;currentPage&#39;: 999, &#39;size&#39;: 835}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">requests</span> <span class="k">import</span> <span class="n">post</span>
    <span class="kn">from</span> <span class="nn">argus_api.exceptions</span> <span class="k">import</span> <span class="n">http</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://portal.mnemonic.no/web/api/assets/v1/host/search&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">()</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
        <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s1">&#39;ArgusToolbelt/&#39;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">apiKey</span><span class="p">:</span>
        <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;Argus-API-Key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">apiKey</span>
    <span class="k">elif</span> <span class="n">authentication</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">authentication</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">authentication</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">callable</span><span class="p">(</span><span class="n">authentication</span><span class="p">):</span>
        <span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">authentication</span><span class="p">(</span><span class="n">url</span><span class="p">))</span>

    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;limit&quot;</span><span class="p">:</span> <span class="n">limit</span><span class="p">,</span> 
        <span class="s2">&quot;offset&quot;</span><span class="p">:</span> <span class="n">offset</span><span class="p">,</span> 
        <span class="s2">&quot;includeDeleted&quot;</span><span class="p">:</span> <span class="n">includeDeleted</span><span class="p">,</span> 
        <span class="s2">&quot;subCriteria&quot;</span><span class="p">:</span> <span class="n">subCriteria</span><span class="p">,</span> 
        <span class="s2">&quot;exclude&quot;</span><span class="p">:</span> <span class="n">exclude</span><span class="p">,</span> 
        <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="n">required</span><span class="p">,</span> 
        <span class="s2">&quot;customerID&quot;</span><span class="p">:</span> <span class="n">customerID</span><span class="p">,</span> 
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span> 
        <span class="s2">&quot;startTimestamp&quot;</span><span class="p">:</span> <span class="n">startTimestamp</span><span class="p">,</span> 
        <span class="s2">&quot;endTimestamp&quot;</span><span class="p">:</span> <span class="n">endTimestamp</span><span class="p">,</span> 
        <span class="s2">&quot;keywords&quot;</span><span class="p">:</span> <span class="n">keywords</span><span class="p">,</span> 
        <span class="s2">&quot;keywordMatchStrategy&quot;</span><span class="p">:</span> <span class="n">keywordMatchStrategy</span><span class="p">,</span> 
        <span class="s2">&quot;timeMatchStrategy&quot;</span><span class="p">:</span> <span class="n">timeMatchStrategy</span><span class="p">,</span> 
        <span class="s2">&quot;hostID&quot;</span><span class="p">:</span> <span class="n">hostID</span><span class="p">,</span> 
        <span class="s2">&quot;serviceID&quot;</span><span class="p">:</span> <span class="n">serviceID</span><span class="p">,</span> 
        <span class="s2">&quot;businessProcessID&quot;</span><span class="p">:</span> <span class="n">businessProcessID</span><span class="p">,</span> 
        <span class="s2">&quot;ipRange&quot;</span><span class="p">:</span> <span class="n">ipRange</span><span class="p">,</span> 
        <span class="s2">&quot;applicationPort&quot;</span><span class="p">:</span> <span class="n">applicationPort</span><span class="p">,</span> 
        <span class="s2">&quot;applicationProtocol&quot;</span><span class="p">:</span> <span class="n">applicationProtocol</span><span class="p">,</span> 
        <span class="s2">&quot;cpe&quot;</span><span class="p">:</span> <span class="n">cpe</span><span class="p">,</span> 
        <span class="s2">&quot;hostCPE&quot;</span><span class="p">:</span> <span class="n">hostCPE</span><span class="p">,</span> 
        <span class="s2">&quot;applicationCPE&quot;</span><span class="p">:</span> <span class="n">applicationCPE</span><span class="p">,</span> 
        <span class="s2">&quot;ownerID&quot;</span><span class="p">:</span> <span class="n">ownerID</span><span class="p">,</span> 
        <span class="s2">&quot;criticality&quot;</span><span class="p">:</span> <span class="n">criticality</span><span class="p">,</span> 
        <span class="s2">&quot;minimumTotalCvss&quot;</span><span class="p">:</span> <span class="n">minimumTotalCvss</span><span class="p">,</span> 
        <span class="s2">&quot;maximumTotalCvss&quot;</span><span class="p">:</span> <span class="n">maximumTotalCvss</span><span class="p">,</span> 
        <span class="s2">&quot;vulnerabilityReference&quot;</span><span class="p">:</span> <span class="n">vulnerabilityReference</span><span class="p">,</span> 
        <span class="s2">&quot;vulnerabilityID&quot;</span><span class="p">:</span> <span class="n">vulnerabilityID</span><span class="p">,</span> 
        <span class="s2">&quot;applicationRole&quot;</span><span class="p">:</span> <span class="n">applicationRole</span><span class="p">,</span> 
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="nb">type</span><span class="p">,</span> 
        <span class="s2">&quot;timeFieldStrategy&quot;</span><span class="p">:</span> <span class="n">timeFieldStrategy</span><span class="p">,</span> 
        <span class="s2">&quot;keywordFieldStrategy&quot;</span><span class="p">:</span> <span class="n">keywordFieldStrategy</span><span class="p">,</span> 
        <span class="s2">&quot;includeVulnerabilityRawOutput&quot;</span><span class="p">:</span> <span class="n">includeVulnerabilityRawOutput</span><span class="p">,</span> 
        <span class="s2">&quot;includeVulnerabilityConclusion&quot;</span><span class="p">:</span> <span class="n">includeVulnerabilityConclusion</span><span class="p">,</span> 
        <span class="s2">&quot;includeVulnerabilitySolution&quot;</span><span class="p">:</span> <span class="n">includeVulnerabilitySolution</span><span class="p">,</span> 
        <span class="s2">&quot;includeVulnerabilities&quot;</span><span class="p">:</span> <span class="n">includeVulnerabilities</span><span class="p">,</span> 
        <span class="s2">&quot;includeApplications&quot;</span><span class="p">:</span> <span class="n">includeApplications</span><span class="p">,</span> 
        <span class="s2">&quot;includeServices&quot;</span><span class="p">:</span> <span class="n">includeServices</span><span class="p">,</span> 
        <span class="s2">&quot;connectedToService&quot;</span><span class="p">:</span> <span class="n">connectedToService</span><span class="p">,</span> 
        <span class="s2">&quot;sortBy&quot;</span><span class="p">:</span> <span class="n">sortBy</span><span class="p">,</span> 
        <span class="s2">&quot;includeFlags&quot;</span><span class="p">:</span> <span class="n">includeFlags</span><span class="p">,</span> 
        <span class="s2">&quot;excludeFlags&quot;</span><span class="p">:</span> <span class="n">excludeFlags</span>
    <span class="p">}</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span>
                    <span class="n">json</span><span class="o">=</span><span class="n">body</span> <span class="k">if</span> <span class="n">body</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">verify</span><span class="o">=</span><span class="n">verify</span><span class="p">,</span>
                    <span class="n">headers</span><span class="o">=</span><span class="n">headers</span>
                <span class="p">)</span>

    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">401</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">AuthenticationFailedException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">403</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">AccessDeniedException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">412</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">ValidationErrorException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">ObjectNotFoundException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span> <span class="k">if</span> <span class="n">json</span> <span class="k">else</span> <span class="n">response</span></div>

<div class="viewcode-block" id="get_host_asset"><a class="viewcode-back" href="../../../../api/api.assets.v1.html#api.assets.v1.host.get_host_asset">[docs]</a><span class="nd">@register_command</span><span class="p">(</span><span class="n">extending</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;assets&quot;</span><span class="p">,</span><span class="s2">&quot;v1&quot;</span><span class="p">,</span><span class="s2">&quot;host&quot;</span><span class="p">))</span>



<span class="k">def</span> <span class="nf">get_host_asset</span><span class="p">(</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
    
    <span class="n">json</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">verify</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">apiKey</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">authentication</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
  <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Returns a HostAsset identified by its ID. (PUBLIC)</span>

<span class="sd">    :param str id: HostAsset ID</span>
<span class="sd">    :raises AuthenticationFailedException: on 401</span>
<span class="sd">    :raises ValidationErrorException: on 412</span>
<span class="sd">    :raises AccessDeniedException: on 403</span>
<span class="sd">    :raises ObjectNotFoundException: on 404</span>
<span class="sd">    :returns: {&#39;offset&#39;: 62, &#39;limit&#39;: 696, &#39;responseCode&#39;: 200, &#39;count&#39;: 71, &#39;metaData&#39;: {&#39;additionalProperties&#39;: {}}, &#39;messages&#39;: [{&#39;message&#39;: &#39;Worker within budget week usually meeting cause.&#39;, &#39;messageTemplate&#39;: &#39;Woman suddenly between.&#39;, &#39;field&#39;: &#39;Man radio natural kind.&#39;, &#39;parameter&#39;: {}, &#39;timestamp&#39;: 1140189263}], &#39;currentPage&#39;: 66, &#39;size&#39;: 946}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">requests</span> <span class="k">import</span> <span class="n">get</span>
    <span class="kn">from</span> <span class="nn">argus_api.exceptions</span> <span class="k">import</span> <span class="n">http</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://portal.mnemonic.no/web/api/assets/v1/host/</span><span class="si">{id}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">)</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
        <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s1">&#39;ArgusToolbelt/&#39;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">apiKey</span><span class="p">:</span>
        <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;Argus-API-Key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">apiKey</span>
    <span class="k">elif</span> <span class="n">authentication</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">authentication</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">authentication</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">callable</span><span class="p">(</span><span class="n">authentication</span><span class="p">):</span>
        <span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">authentication</span><span class="p">(</span><span class="n">url</span><span class="p">))</span>

    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">}</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span>
                    <span class="n">json</span><span class="o">=</span><span class="n">body</span> <span class="k">if</span> <span class="n">body</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">verify</span><span class="o">=</span><span class="n">verify</span><span class="p">,</span>
                    <span class="n">headers</span><span class="o">=</span><span class="n">headers</span>
                <span class="p">)</span>

    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">401</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">AuthenticationFailedException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">403</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">AccessDeniedException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">412</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">ValidationErrorException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">ObjectNotFoundException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span> <span class="k">if</span> <span class="n">json</span> <span class="k">else</span> <span class="n">response</span></div>

<div class="viewcode-block" id="update_host_asset"><a class="viewcode-back" href="../../../../api/api.assets.v1.html#api.assets.v1.host.update_host_asset">[docs]</a><span class="nd">@register_command</span><span class="p">(</span><span class="n">extending</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;assets&quot;</span><span class="p">,</span><span class="s2">&quot;v1&quot;</span><span class="p">,</span><span class="s2">&quot;host&quot;</span><span class="p">))</span>



<span class="k">def</span> <span class="nf">update_host_asset</span><span class="p">(</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
    <span class="n">ownerID</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">addProperties</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">deleteProperties</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="nb">type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">operatingSystemCPE</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">addIpAddresses</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">deleteIpAddresses</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">addAliases</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">deleteAliases</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;USER&quot;</span><span class="p">,</span> 
    
    <span class="n">json</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">verify</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">apiKey</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">authentication</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
  <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Updates an existing HostAsset. (PUBLIC)</span>

<span class="sd">    :param str id: HostAsset ID</span>
<span class="sd">    :param int ownerID: Change user who owns the asset. </span>
<span class="sd">    :param str name: Change name of asset.  =&gt; [\s\w\{\}\$\-\(\)\.\[\]&quot;\&#39;_/\\,\*\+\#:@!?;]*</span>
<span class="sd">    :param str description: Change description of asset.  =&gt; [\s\w\{\}\$\-\(\)\.\[\]&quot;\&#39;_/\\,\*\+\#:@!?;]*</span>
<span class="sd">    :param dict addProperties: Add custom properties (updates a property if key already exists).  =&gt; [\s\w\{\}\$\-\(\)\.\[\]&quot;\&#39;_/\\,\*\+\#:@!?;]*</span>
<span class="sd">    :param list deleteProperties: Delete custom properties by key. </span>
<span class="sd">    :param str type: Change type of host (client or server). </span>
<span class="sd">    :param str operatingSystemCPE: Change CPE of host. </span>
<span class="sd">    :param list addIpAddresses: Add IP address(es) to host. </span>
<span class="sd">    :param list deleteIpAddresses: Delete IP address(es) from host. </span>
<span class="sd">    :param list addAliases: Add alias(es) (domain names) to host. </span>
<span class="sd">    :param list deleteAliases: Delete alias(es) from host. </span>
<span class="sd">    :param str source: Source of the request. (default USER)</span>
<span class="sd">    :raises AuthenticationFailedException: on 401</span>
<span class="sd">    :raises ValidationErrorException: on 412</span>
<span class="sd">    :raises AccessDeniedException: on 403</span>
<span class="sd">    :raises ObjectNotFoundException: on 404</span>
<span class="sd">    :returns: {&#39;offset&#39;: 116, &#39;limit&#39;: 485, &#39;responseCode&#39;: 200, &#39;count&#39;: 544, &#39;metaData&#39;: {&#39;additionalProperties&#39;: {}}, &#39;messages&#39;: [{&#39;message&#39;: &#39;Through mention whatever a.&#39;, &#39;messageTemplate&#39;: &#39;Citizen will describe safe season camera smile.&#39;, &#39;field&#39;: &#39;Employee audience issue land major compare.&#39;, &#39;parameter&#39;: {}, &#39;timestamp&#39;: 230211509}], &#39;currentPage&#39;: 466, &#39;size&#39;: 124}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">requests</span> <span class="k">import</span> <span class="n">put</span>
    <span class="kn">from</span> <span class="nn">argus_api.exceptions</span> <span class="k">import</span> <span class="n">http</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://portal.mnemonic.no/web/api/assets/v1/host/</span><span class="si">{id}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">)</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
        <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s1">&#39;ArgusToolbelt/&#39;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">apiKey</span><span class="p">:</span>
        <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;Argus-API-Key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">apiKey</span>
    <span class="k">elif</span> <span class="n">authentication</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">authentication</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">authentication</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">callable</span><span class="p">(</span><span class="n">authentication</span><span class="p">):</span>
        <span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">authentication</span><span class="p">(</span><span class="n">url</span><span class="p">))</span>

    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="n">source</span><span class="p">,</span> 
        <span class="s2">&quot;ownerID&quot;</span><span class="p">:</span> <span class="n">ownerID</span><span class="p">,</span> 
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span> 
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">description</span><span class="p">,</span> 
        <span class="s2">&quot;addProperties&quot;</span><span class="p">:</span> <span class="n">addProperties</span><span class="p">,</span> 
        <span class="s2">&quot;deleteProperties&quot;</span><span class="p">:</span> <span class="n">deleteProperties</span><span class="p">,</span> 
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="nb">type</span><span class="p">,</span> 
        <span class="s2">&quot;operatingSystemCPE&quot;</span><span class="p">:</span> <span class="n">operatingSystemCPE</span><span class="p">,</span> 
        <span class="s2">&quot;addIpAddresses&quot;</span><span class="p">:</span> <span class="n">addIpAddresses</span><span class="p">,</span> 
        <span class="s2">&quot;deleteIpAddresses&quot;</span><span class="p">:</span> <span class="n">deleteIpAddresses</span><span class="p">,</span> 
        <span class="s2">&quot;addAliases&quot;</span><span class="p">:</span> <span class="n">addAliases</span><span class="p">,</span> 
        <span class="s2">&quot;deleteAliases&quot;</span><span class="p">:</span> <span class="n">deleteAliases</span>
    <span class="p">}</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">put</span><span class="p">(</span><span class="n">url</span><span class="p">,</span>
                    <span class="n">json</span><span class="o">=</span><span class="n">body</span> <span class="k">if</span> <span class="n">body</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">verify</span><span class="o">=</span><span class="n">verify</span><span class="p">,</span>
                    <span class="n">headers</span><span class="o">=</span><span class="n">headers</span>
                <span class="p">)</span>

    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">401</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">AuthenticationFailedException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">403</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">AccessDeniedException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">412</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">ValidationErrorException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">ObjectNotFoundException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span> <span class="k">if</span> <span class="n">json</span> <span class="k">else</span> <span class="n">response</span></div>

<div class="viewcode-block" id="delete_host_asset"><a class="viewcode-back" href="../../../../api/api.assets.v1.html#api.assets.v1.host.delete_host_asset">[docs]</a><span class="nd">@register_command</span><span class="p">(</span><span class="n">extending</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;assets&quot;</span><span class="p">,</span><span class="s2">&quot;v1&quot;</span><span class="p">,</span><span class="s2">&quot;host&quot;</span><span class="p">))</span>



<span class="k">def</span> <span class="nf">delete_host_asset</span><span class="p">(</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
    <span class="n">source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;USER&quot;</span><span class="p">,</span> 
    
    <span class="n">json</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">verify</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">apiKey</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">authentication</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
  <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Marks a HostAsset as deleted. (PUBLIC)</span>

<span class="sd">    :param str id: HostAsset ID</span>
<span class="sd">    :param str source: Request source (default USER)</span>
<span class="sd">    :raises AuthenticationFailedException: on 401</span>
<span class="sd">    :raises ValidationErrorException: on 412</span>
<span class="sd">    :raises AccessDeniedException: on 403</span>
<span class="sd">    :raises ObjectNotFoundException: on 404</span>
<span class="sd">    :returns: {&#39;offset&#39;: 323, &#39;limit&#39;: 205, &#39;responseCode&#39;: 200, &#39;count&#39;: 853, &#39;metaData&#39;: {&#39;additionalProperties&#39;: {}}, &#39;messages&#39;: [{&#39;message&#39;: &#39;Black tonight nearly professional physical spring opportunity.&#39;, &#39;messageTemplate&#39;: &#39;Those understand career prove story.&#39;, &#39;field&#39;: &#39;Pay skin yes past course process without.&#39;, &#39;parameter&#39;: {}, &#39;timestamp&#39;: 919979182}], &#39;currentPage&#39;: 87, &#39;size&#39;: 84}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">requests</span> <span class="k">import</span> <span class="n">delete</span>
    <span class="kn">from</span> <span class="nn">argus_api.exceptions</span> <span class="k">import</span> <span class="n">http</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://portal.mnemonic.no/web/api/assets/v1/host/</span><span class="si">{id}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">)</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
        <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s1">&#39;ArgusToolbelt/&#39;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">apiKey</span><span class="p">:</span>
        <span class="n">headers</span><span class="p">[</span><span class="s2">&quot;Argus-API-Key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">apiKey</span>
    <span class="k">elif</span> <span class="n">authentication</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">authentication</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">authentication</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">callable</span><span class="p">(</span><span class="n">authentication</span><span class="p">):</span>
        <span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">authentication</span><span class="p">(</span><span class="n">url</span><span class="p">))</span>

    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="n">source</span>
    <span class="p">}</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span>
                    <span class="n">json</span><span class="o">=</span><span class="n">body</span> <span class="k">if</span> <span class="n">body</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">verify</span><span class="o">=</span><span class="n">verify</span><span class="p">,</span>
                    <span class="n">headers</span><span class="o">=</span><span class="n">headers</span>
                <span class="p">)</span>

    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">401</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">AuthenticationFailedException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">403</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">AccessDeniedException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">412</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">ValidationErrorException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">http</span><span class="o">.</span><span class="n">ObjectNotFoundException</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span> <span class="k">if</span> <span class="n">json</span> <span class="k">else</span> <span class="n">response</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../../index.html">Documentation overview</a><ul>
  <li><a href="../../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, mnemonic.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.7</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
    </div>

    

    
  </body>
</html>