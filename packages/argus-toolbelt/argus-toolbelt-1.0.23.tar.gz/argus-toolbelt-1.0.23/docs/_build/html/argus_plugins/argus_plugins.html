
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Argus Plugins &#8212; Argus-Toolbelt 1.0 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="argus-plugins">
<h1>Argus Plugins<a class="headerlink" href="#argus-plugins" title="Permalink to this headline">¶</a></h1>
<p>ArgusCLI provides an interface for your plugins, abstracting away tedious tasks such as
parameter validation and command line argument parsers from the developer.</p>
<p>By default, Argus Toolbelt provides the Argus Plugins package as a default set of plugins,
but creating your own plugins is easy, and we hope this will encourage developers to
contribute with their own plugin to interface with the Argus API.</p>
<div class="section" id="creating-a-new-plugin">
<h2>Creating a new plugin<a class="headerlink" href="#creating-a-new-plugin" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal"><span class="pre">register_command</span></code> decorator will register a command against a plugin with a given name.
Both the plugin and the name of the command can be changed via it’s parameters.
These parameters are <code class="docutils literal"><span class="pre">extending</span></code> and <code class="docutils literal"><span class="pre">alias</span></code>.</p>
<div class="section" id="function-metadata">
<h3>Function metadata<a class="headerlink" href="#function-metadata" title="Permalink to this headline">¶</a></h3>
<p>Argus CLI will by default introspect functions when they’ve been registered with the framework
using the <code class="docutils literal"><span class="pre">&#64;register_command()</span></code> decorator, which means that the function signature will be
used to create the command-line arguments, and the function docstring will be used to provide
command line documentation.</p>
<p>Since Python 3.5, Python supports <a class="reference external" href="https://www.python.org/dev/peps/pep-3107/">function annotations</a>,
and Argus CLI uses these to infer the argument types from the function signature, and create
the right type of command-line arguments for your plugin.</p>
<p>Commandline help-text, and parameter descriptions, is extracted from the function docstring,
expected to follow the <em>reSTructuredText</em> style used by Sphinx autodoc</p>
</div>
<div class="section" id="example-1-registering-a-command">
<h3>Example #1: Registering a command<a class="headerlink" href="#example-1-registering-a-command" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="nd">@register_command</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">your_plugin_command</span><span class="p">(</span><span class="n">your_argument</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Short description becomes the plugin help text</span>

<span class="sd">    Longer description follows after a newline</span>

<span class="sd">    :param your_argument: This parameter description becomes the commandline argument help text</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">your_argument</span>
</pre></div>
</div>
</div>
<div class="section" id="example-2-registering-a-command-with-extra-functionality">
<h3>Example #2: Registering a command with extra functionality<a class="headerlink" href="#example-2-registering-a-command-with-extra-functionality" title="Permalink to this headline">¶</a></h3>
<p>Pre-defined choices (enum fields) can be expressed as a <em>populated list</em>:
You can alias a keyword argument to something else using <code class="docutils literal"><span class="pre">:alias</span> <span class="pre">your_argument:</span> <span class="pre">something_else</span></code></p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="nd">@register_command</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">your_plugin_command</span><span class="p">(</span><span class="n">your_argument</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;option1&quot;</span><span class="p">,</span> <span class="s2">&quot;option2&quot;</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;This function has an argument that will be called something else on the command-line</span>

<span class="sd">    :param your_argument: This should be called something-else on the command-line</span>
<span class="sd">    :alias your_argument: something_else</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><strong>Note:</strong> Plugins and their arguments are turned from snake_case into kebab-case on the commandline</div>
</div>
</div>
</div>
<div class="section" id="guides">
<h2>Guides<a class="headerlink" href="#guides" title="Permalink to this headline">¶</a></h2>
<div class="section" id="creating-a-simple-plugin">
<h3>Creating a simple plugin<a class="headerlink" href="#creating-a-simple-plugin" title="Permalink to this headline">¶</a></h3>
<p>Creating a plugin should be easy: Just create a new python file inside on of your plugin directories,
as defined by your <code class="docutils literal"><span class="pre">.argus_cli.yaml</span></code> settings file created during installation. By default, this file
will be found in your <code class="docutils literal"><span class="pre">$HOME</span></code> folder.</p>
<p><strong>Step 1</strong>: Create the script</p>
<p>We want to call this plugin <code class="docutils literal"><span class="pre">basic-example</span></code>; so lets first create the file <code class="docutils literal"><span class="pre">basic_example.py</span></code>.
Argus CLI will now automatically load this file, and functions inside it that register commands
will be available on the commandline.</p>
<p><strong>Step 2</strong>: Add a function</p>
<p>Create a simple function that says <code class="docutils literal"><span class="pre">Hello,</span> <span class="pre">Argus</span></code>. This will be the base for our plugin.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">hello</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Hello, Argus&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Step 3</strong>: Register the command to the commandline</p>
<p>Plugin registration is done with the <code class="docutils literal"><span class="pre">register_command</span></code> decorator from <code class="docutils literal"><span class="pre">argus_cli.plugins</span></code>.
This <em>decorator</em> will register your command against your plugin (which is the name of the file, converted
to kebab-case).</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">argus_cli.plugins</span> <span class="kn">import</span> <span class="n">register_command</span>

<span class="nd">@register_command</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">hello</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Hello, Argus&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Step 4</strong>: Adding help text to the plugin command</p>
<p>Now, let’s add some <em>metadata</em> to our function. This metadata lets ArgusCLI give the user help text,
does type checking for arguments and create aliases. The framework is designed to force developers to
document their functions, so you’ll need to use docstrings to add metadata.</p>
<p>The format for this is like a normal <em>reST</em> docstring. It contains the help-text and description that
will show up when the user runs the application with <code class="docutils literal"><span class="pre">-h</span></code> or <code class="docutils literal"><span class="pre">--help</span></code> and <em>reST</em> metadata parameters
(<code class="docutils literal"><span class="pre">:&lt;metadata-field&gt;:</span></code>).</p>
<p>Any of these parts can be omitted, but it is recommended to at least have a help-text.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="s2">&quot;&quot;&quot;&lt;help text&gt;</span>

<span class="s2">&lt;command description&gt;</span>

<span class="s2">&lt;metadata&gt;</span>
</pre></div>
</div>
<p>Let’s update the command to provide some help-text:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">argus_cli.plugins</span> <span class="kn">import</span> <span class="n">register_command</span>

<span class="nd">@register_command</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">hello</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Print &#39;Hello, Argus&#39;&quot;&quot;&quot;</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Hello, Argus&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now let’s modify our command to say hello to the user instead.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">argus_cli.plugins</span> <span class="kn">import</span> <span class="n">register_command</span>

<span class="nd">@register_command</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">hello</span><span class="p">(</span><span class="n">username</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Says hello to the user</span>

<span class="sd">    :param str username: Your name</span>
<span class="sd">    :alias username: name</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Hello, </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">username</span><span class="p">)</span>
</pre></div>
</div>
<p>Now you can run your plugin by writing: <code class="docutils literal"><span class="pre">argus_cli</span> <span class="pre">basic-example</span> <span class="pre">hello</span> <span class="pre">--name</span> <span class="pre">Bob</span></code>.
Your terminal will now greet you, and you’ll see <code class="docutils literal"><span class="pre">Hello,</span> <span class="pre">Bob</span></code>!</p>
</div>
<div class="section" id="creating-an-api-plugin">
<h3>Creating an API plugin<a class="headerlink" href="#creating-an-api-plugin" title="Permalink to this headline">¶</a></h3>
<p>API plugins are super easy to write. The only thing you need to do to create a plugin
that use <em>ArgusAPI</em>, is to import the functions you need from <code class="docutils literal"><span class="pre">argus_api.api</span></code></p>
<p>Lets create a plugin that shows the user how many alarms there are in Argus.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">argus_api.api.alarms.v1.alarm</span> <span class="kn">import</span> <span class="n">get_alarms</span>
<span class="kn">from</span> <span class="nn">argus_cli.plugins</span> <span class="kn">import</span> <span class="n">register_command</span>

<span class="nd">@register_command</span><span class="p">(</span><span class="n">alias</span><span class="o">=</span><span class="s2">&quot;number_of_alarms&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">num_alarms</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Displays the number of alarms in argus&quot;&quot;&quot;</span>
    <span class="n">alarms</span> <span class="o">=</span> <span class="n">get_alarms</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;There are </span><span class="si">%d</span><span class="s2"> alarms&quot;</span> <span class="o">%</span> <span class="n">alarms</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>You’ll notice that this command introduces the <code class="docutils literal"><span class="pre">alias</span></code> parameter to <code class="docutils literal"><span class="pre">register_command</span></code>.
This parameter is handy for when you want to call your command something else than your function.
Now you can write <code class="docutils literal"><span class="pre">argus_cli</span> <span class="pre">basics</span> <span class="pre">number-of-alarms</span></code> to use the command.</p>
<p>The <a class="reference external" href="https://portal.mnemonic.no/web/secure/apidocs">Argus api documentation</a> is a valuable resource
when writing commands that use the API, so make sure to have it handy. You can also inspect
the API functions source code to see more information on their parameters and how to use them</p>
</div>
<div class="section" id="logging-from-a-plugin">
<h3>Logging from a plugin<a class="headerlink" href="#logging-from-a-plugin" title="Permalink to this headline">¶</a></h3>
<p>Any developer knows that troubleshooting is easier with a log that shows what the program is doing.
Because of this <em>ArgusCLI</em> has it’s own logger with a plugin log level.</p>
<p>This log level is below <code class="docutils literal"><span class="pre">DEBUG</span></code>, so make sure that your log level is set to DEBUG.</p>
<p>This logger can be imported from <code class="docutils literal"><span class="pre">argus_cli.helpers.log</span></code>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">argus_cli.plugins</span> <span class="kn">import</span> <span class="n">register_command</span>
<span class="kn">from</span> <span class="nn">argus_cli.helpers.log</span> <span class="kn">import</span> <span class="n">log</span>

<span class="nd">@register_command</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">i_do_things</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Does things&quot;&quot;&quot;</span>
    <span class="n">log</span><span class="o">.</span><span class="n">plugin</span><span class="p">(</span><span class="s2">&quot;I am entering the plugin!&quot;</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;Goodbye cruel world&quot;</span><span class="p">)</span>
    <span class="n">log</span><span class="o">.</span><span class="n">plugin</span><span class="p">(</span><span class="s2">&quot;And now I&#39;m leaving&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Your commandline will now show the logging and the print (or not, if you’ve set it to log it to a file).</p>
<div class="highlight-guess"><div class="highlight"><pre><span></span>[11:16:09.342][PLUGIN][basics.py:7]: I am entering the plugin!
Goodbye cruel world
[11:16:09.343][PLUGIN][basics.py:9]: And now I&#39;m leaving
</pre></div>
</div>
</div>
</div>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="argus_plugins.cases.html">argus_plugins.cases package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="argus_plugins.cases.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="argus_plugins.cases.html#argus-plugins-cases-remind-module">argus_plugins.cases.remind module</a></li>
<li class="toctree-l2"><a class="reference internal" href="argus_plugins.cases.html#module-argus_plugins.cases.utils">argus_plugins.cases.utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="argus_plugins.cases.html#module-argus_plugins.cases">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-argus_plugins.generate">
<span id="argus-plugins-generate-module"></span><h2>argus_plugins.generate module<a class="headerlink" href="#module-argus_plugins.generate" title="Permalink to this headline">¶</a></h2>
<div class="section" id="generator-plugin">
<h3>GENERATOR PLUGIN<a class="headerlink" href="#generator-plugin" title="Permalink to this headline">¶</a></h3>
<p>Generator is used to generate files based on templates — first and foremost, static API files. Generator creates the plugin hooks and redirects
to the appropriate generator methods, and can be run with:</p>
<p>argus-cli generate endpoint –name ENDPOINT_NAME -O api/folder/path
argus-cli generate endpoint –matching REGEX -O api/folder/path
argus-cli generate all</p>
<p>TODO: 
- Accept custom swagger.json URL
- Parse OAuth 3.0
- Resolve recursive references in JSONSchema
- Support different authentication modes from command line and generate authentication differently
- Templates for other languages
- Update API url from settings</p>
<dl class="function">
<dt id="argus_plugins.generate.all_endpoints">
<code class="descclassname">argus_plugins.generate.</code><code class="descname">all_endpoints</code><span class="sig-paren">(</span><em>directory: str</em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="../_modules/argus_plugins/generate.html#all_endpoints"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#argus_plugins.generate.all_endpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates all endpoints to a given directory</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><code class="docutils literal"><span class="pre">list</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Parameters:</th><td class="field-body"><strong>directory</strong> (<code class="docutils literal"><span class="pre">str</span></code>) – Output directory</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="module-argus_plugins">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-argus_plugins" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, mnemonic.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.7</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../_sources/argus_plugins/argus_plugins.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>