.. _libvirtd__ref_changelog:

Changelog
=========

.. include:: includes/all.rst

**debops.libvirtd**

This project adheres to `Semantic Versioning <http://semver.org/spec/v2.0.0.html>`__
and `human-readable changelog <http://keepachangelog.com/en/0.3.0/>`__.

The current role maintainer_ is drybjed_.


`debops.libvirtd master`_ - unreleased
--------------------------------------

.. _debops.libvirtd master: https://github.com/debops/ansible-libvirtd/compare/v0.3.3...master


`debops.libvirtd v0.3.3`_ - 2017-10-07
--------------------------------------

.. _debops.libvirtd v0.3.3: https://github.com/debops/ansible-libvirtd/compare/v0.3.2...v0.3.3

Changed
~~~~~~~

- On OpenNebula VM hosts, disable usage of the PolicyKit with
  :command:libvirtd` to avoid issues with older PolicyKit versions which might
  lock up due to too many authorization requests generated by OpenNebula. Ref:
  https://forum.opennebula.org/t/polkitd-traps-general-protection-ip-in-libmozjs-17-0-so/399/3
  [drybjed_]

- Enable use of ``jessie-backports`` repository on Debian Jessie to allow for
  VM migration between different OS releases. [drybjed_]

Fixed
~~~~~

- Fix a bug in the configuration template that resulted in
  "AnsibleUndefinedVariable: 'parameters' is undefined" error. [drybjed_]


`debops.libvirtd v0.3.2`_ - 2017-06-12
--------------------------------------

.. _debops.libvirtd v0.3.2: https://github.com/debops/ansible-libvirtd/compare/v0.3.1...v0.3.2

Changed
~~~~~~~

- Decrease minimum Ansible version requirement to v2.2.3. v2.2.x was also
  supported by previous 0.3.x role releases. [ypid_]

- Add the reference to the ``debops.libvirtd_qemu`` role in the example
  playbook and update the documentation. [drybjed_]


`debops.libvirtd v0.3.1`_ - 2017-05-30
--------------------------------------

.. _debops.libvirtd v0.3.1: https://github.com/debops/ansible-libvirtd/compare/v0.3.0...v0.3.1

Removed
~~~~~~~

- Remove mention of the ``debops.libvirtd_qemu`` role from the example playbook
  for now. It will be added back later when the role is released. [drybjed_]

- Don't enable the ``jessie-backports`` version of libvirt and qemu packages on
  Debian Jessie. It will be enabled after Debian Stretch is released. [drybjed_]


`debops.libvirtd v0.3.0`_ - 2017-05-29
--------------------------------------

.. _debops.libvirtd v0.3.0: https://github.com/debops/ansible-libvirtd/compare/v0.2.0...v0.3.0

Added
~~~~~

- Add ``qemu-utils`` package to list of installed packages. [bfabio_]

- Add optional support for `Kernel same-page merging <https://en.wikipedia.org/wiki/Kernel_same-page_merging>`_.
  It's not enabled by default due to potential security risks. [gaudenz]

- Configure APT preferences to prefer ``libvirt`` and ``qemu`` packages from
  the ``jessie-backports`` repository on Debian Jessie, to ensure feature
  parity with Debian Stretch. [drybjed_]

- Add support for management of the :file:`/etc/libvirt/libvirtd.conf`
  configuration file. [drybjed_]

- Add Ansible local facts for the ``debops.libvirtd`` role. [drybjed_]

- Add the :envvar:`libvirtd__deployment_mode` with a respective Ansible local
  fact, which can be used to change :command:`libvirtd` configuration
  conditionally depending on the deployment and management environment.
  Currently plain "libvirt" and OpenNebula environments are supported.
  [drybjed_]

- Add the ``debops.libvirtd_qemu`` role to the example playbook. [drybjed_]

Changed
~~~~~~~

- Change how the role detects the :command:`libvirtd` UNIX access group. [fyhertz]

- Update documentation and Changelog. [ypid_, drybjed_]

- Rename the ``libvirtd__group_map`` variable to ``libvirtd__access_groups``.
  [drybjed_]

- Use the ``getent`` Ansible module to get the list of UNIX groups present on
  the host. [drybjed_]

- Move the list of hardcoded APT packages to a new default variable. [drybjed_]

- Don't restart :command:`sysfsutils` on hosts with read-only :file:`/sys`
  filesystem, eg. LXC containers. [drybjed_]

- Divert original configuration files instead of overwriting them. [drybjed_]

- Change the way that ``libvirt`` UNIX group is detected. Instead of a task
  during execution, it's now done via local Ansible facts; this allows use of
  the group name in multiple places in the role. [drybjed_]

- Rename the ``libvirtd__access_group`` variable to
  :envvar:`libvirtd__unix_sock_group`. [drybjed_]

- Cleanup of the :file:`/etc/libvirt/libvirt.conf` configuration file. The
  ``libvirtd__connections`` variable is renamed to
  :envvar:`libvirtd__uri_aliases`. The ``libvirtd__uri`` variable is renamed to
  :envvar:`libvirtd__default_uri`. [drybjed_]

- Increase minimum Ansible version requirement to v2.3. [drybjed_]


`debops.libvirtd v0.2.0`_ - 2016-05-19
--------------------------------------

.. _debops.libvirtd v0.2.0: https://github.com/debops/ansible-libvirtd/compare/v0.1.2...v0.2.0

Changed
~~~~~~~

- Fix deprecation warnings in Ansible 2.1.0. [ypid_]

- Fix issue with wrong variable type conversion. [drybjed_]

- Changed variable namespace from ``libvirtd_`` to ``libvirtd__``.
  ``libvirtd_[^_]`` variables are hereby deprecated.

  You might need to update your inventory. This oneliner might come in handy to
  do this:

  .. code:: shell

     git ls-files -z | xargs --null -I '{}' find '{}' -type f -print0 \
     | xargs --null sed --in-place --regexp-extended 's/\<(libvirtd)_([^_])/\1__\2/g;'

  [ypid_]

Removed
~~~~~~~

- Remove most of the Ansible role dependencies, leaving only those that are
  required for the role to run correctly.

  Configuration of dependent services like firewall, TCP Wrappers, APT
  preferences is set in separate default variables. These variables can be used
  by Ansible playbooks to configure settings related to :program:`libvirtd` in other
  services. [ypid_]


`debops.libvirtd v0.1.2`_ - 2015-11-12
--------------------------------------

.. _debops.libvirtd v0.1.2: https://github.com/debops/ansible-libvirtd/compare/v0.1.1...v0.1.2

Changed
~~~~~~~

- Fix issue with empty ``ansible_ssh_user`` variable on Ansible v2. [drybjed_]


`debops.libvirtd v0.1.1`_ - 2015-07-27
--------------------------------------

.. _debops.libvirtd v0.1.1: https://github.com/debops/ansible-libvirtd/compare/v0.1.0...v0.1.1

Changed
~~~~~~~

- Fix documentation formatting. [drybjed_]


debops.libvirtd v0.1.0 - 2015-07-27
-----------------------------------

Added
~~~~~

- Initial release. [drybjed_]
