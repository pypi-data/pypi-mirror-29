%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax

\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
 \ifdefined\DeclareUnicodeCharacterAsOptional
  \DeclareUnicodeCharacter{"00A0}{\nobreakspace}
  \DeclareUnicodeCharacter{"2500}{\sphinxunichar{2500}}
  \DeclareUnicodeCharacter{"2502}{\sphinxunichar{2502}}
  \DeclareUnicodeCharacter{"2514}{\sphinxunichar{2514}}
  \DeclareUnicodeCharacter{"251C}{\sphinxunichar{251C}}
  \DeclareUnicodeCharacter{"2572}{\textbackslash}
 \else
  \DeclareUnicodeCharacter{00A0}{\nobreakspace}
  \DeclareUnicodeCharacter{2500}{\sphinxunichar{2500}}
  \DeclareUnicodeCharacter{2502}{\sphinxunichar{2502}}
  \DeclareUnicodeCharacter{2514}{\sphinxunichar{2514}}
  \DeclareUnicodeCharacter{251C}{\sphinxunichar{251C}}
  \DeclareUnicodeCharacter{2572}{\textbackslash}
 \fi
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}
\usepackage{times}
\usepackage[Bjarne]{fncychap}
\usepackage[dontkeepoldnames]{sphinx}

\usepackage{geometry}

% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\addto\captionsenglish{\renewcommand{\figurename}{Fig.}}
\addto\captionsenglish{\renewcommand{\tablename}{Table}}
\addto\captionsenglish{\renewcommand{\literalblockname}{Listing}}

\addto\captionsenglish{\renewcommand{\literalblockcontinuedname}{continued from previous page}}
\addto\captionsenglish{\renewcommand{\literalblockcontinuesname}{continues on next page}}

\addto\extrasenglish{\def\pageautorefname{page}}

\setcounter{tocdepth}{1}



\title{g2tools Documentation}
\date{Feb 15, 2018}
\release{1.3.2}
\author{G.P. Lepage}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{Release}
\makeindex

\begin{document}

\maketitle
\sphinxtableofcontents
\phantomsection\label{\detokenize{index::doc}}


Contents:


\chapter{Muon g-2 from Lattice QCD using \sphinxstyleliteralintitle{g2tools}}
\label{\detokenize{overview:g2tools-documentation}}\label{\detokenize{overview:muon-g-2-from-lattice-qcd-using-g2tools}}\label{\detokenize{overview::doc}}
Module {\hyperref[\detokenize{g2tools:module-g2tools}]{\sphinxcrossref{\sphinxcode{g2tools}}}} contains a small number of tools useful for analyzing
contributions to the muon’s magnetic moment from (lattice) QCD vacuum
polarization. These tools were developed by G.P. Lepage to implement the
analysis presented in Chakraborty \sphinxstyleemphasis{et al}, Phys.Rev. D89 (2014) no.11, 114501
(arXiv:1403.1778) and subsequent papers by the same authors.

A typical application, illustrating the most important tools, is
provided by the following code:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{g2tools} \PYG{k}{as} \PYG{n+nn}{g2}
\PYG{k+kn}{import} \PYG{n+nn}{gvar} \PYG{k}{as} \PYG{n+nn}{gv}

\PYG{k}{def} \PYG{n+nf}{main}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
    \PYG{c+c1}{\PYGZsh{} data}
    \PYG{n}{Z} \PYG{o}{=} \PYG{n}{gv}\PYG{o}{.}\PYG{n}{gvar}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{0.9938(17)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}           \PYG{c+c1}{\PYGZsh{} current Z factor}
    \PYG{n}{Q} \PYG{o}{=} \PYG{l+m+mf}{1.} \PYG{o}{/} \PYG{l+m+mf}{3.}                         \PYG{c+c1}{\PYGZsh{} charge of quark (units of proton charge)}
    \PYG{n}{ainv} \PYG{o}{=} \PYG{n}{gv}\PYG{o}{.}\PYG{n}{gvar}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1.6280(86)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}        \PYG{c+c1}{\PYGZsh{} inverse lattice spacing (in GeV)}

    \PYG{n}{G} \PYG{o}{=} \PYG{n}{gv}\PYG{o}{.}\PYG{n}{gvar}\PYG{p}{(}\PYG{p}{[}                       \PYG{c+c1}{\PYGZsh{} G(t) for t=0..63 (in lattice units)}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{0.0870904(11)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{0.0435138(14)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{0.00509859(48)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{0.00305614(43)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{0.00069516(19)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{0.00045466(15)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{0.000166972(80)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{0.000102219(58)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{0.000045284(34)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{0.000026213(22)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{0.000012630(14)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{7.0635(91)e\PYGZhy{}06}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{3.5569(57)e\PYGZhy{}06}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1.9469(37)e\PYGZhy{}06}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1.0027(24)e\PYGZhy{}06}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{5.421(16)e\PYGZhy{}07}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2.834(10)e\PYGZhy{}07}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1.5174(67)e\PYGZhy{}07}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{7.943(43)e\PYGZhy{}08}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{4.253(28)e\PYGZhy{}08}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2.221(19)e\PYGZhy{}08}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1.183(12)e\PYGZhy{}08}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{6.132(81)e\PYGZhy{}09}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{3.292(51)e\PYGZhy{}09}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1.727(34)e\PYGZhy{}09}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{9.19(22)e\PYGZhy{}10}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{4.81(14)e\PYGZhy{}10}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2.643(96)e\PYGZhy{}10}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1.385(64)e\PYGZhy{}10}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{7.61(44)e\PYGZhy{}11}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{3.92(31)e\PYGZhy{}11}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2.67(24)e\PYGZhy{}11}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2.07(21)e\PYGZhy{}11}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2.90(23)e\PYGZhy{}11}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{4.12(31)e\PYGZhy{}11}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{8.20(42)e\PYGZhy{}11}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1.380(65)e\PYGZhy{}10}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2.788(98)e\PYGZhy{}10}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{5.01(15)e\PYGZhy{}10}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{9.72(23)e\PYGZhy{}10}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1.782(34)e\PYGZhy{}09}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{3.406(53)e\PYGZhy{}09}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{6.333(78)e\PYGZhy{}09}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1.212(12)e\PYGZhy{}08}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2.249(18)e\PYGZhy{}08}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{4.283(28)e\PYGZhy{}08}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{8.016(44)e\PYGZhy{}08}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1.5263(67)e\PYGZhy{}07}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2.843(10)e\PYGZhy{}07}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{5.420(16)e\PYGZhy{}07}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1.0062(25)e\PYGZhy{}06}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1.9453(39)e\PYGZhy{}06}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{3.5611(58)e\PYGZhy{}06}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{7.0675(93)e\PYGZhy{}06}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{0.000012647(14)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{0.000026240(22)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{0.000045282(32)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{0.000102285(56)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{0.000166993(79)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{0.00045479(15)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{0.00069503(19)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{0.00305647(42)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{0.00509870(47)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{0.0435158(14)}\PYG{l+s+s1}{\PYGZsq{}}
        \PYG{p}{]}\PYG{p}{)}
    \PYG{c+c1}{\PYGZsh{} N.B.: In general would construct G so that correlations from one t}
    \PYG{c+c1}{\PYGZsh{}   to the next are included. Don\PYGZsq{}t bother here since this is meant}
    \PYG{c+c1}{\PYGZsh{}   just to illustrate g2tools.}

    \PYG{c+c1}{\PYGZsh{} compute moments, converting to physical units from lattice units}
    \PYG{n}{mom} \PYG{o}{=} \PYG{n}{g2}\PYG{o}{.}\PYG{n}{moments}\PYG{p}{(}\PYG{n}{G}\PYG{p}{,} \PYG{n}{ainv}\PYG{o}{=}\PYG{n}{ainv}\PYG{p}{,} \PYG{n}{Z}\PYG{o}{=}\PYG{n}{Z}\PYG{p}{,} \PYG{n}{periodic}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{nlist}\PYG{o}{=}\PYG{p}{[}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{6}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{,} \PYG{l+m+mi}{10}\PYG{p}{]}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Taylor coefficients:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{g2}\PYG{o}{.}\PYG{n}{mom2taylor}\PYG{p}{(}\PYG{n}{mom}\PYG{p}{)}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} construct subtracted vac pol function using [2,2] Padé}
    \PYG{n}{vpol} \PYG{o}{=} \PYG{n}{g2}\PYG{o}{.}\PYG{n}{vacpol}\PYG{p}{(}\PYG{n}{mom}\PYG{p}{,} \PYG{n}{order}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} integrate vpol to get a\PYGZus{}mu and print result}
    \PYG{n}{amu} \PYG{o}{=} \PYG{n}{g2}\PYG{o}{.}\PYG{n}{a\PYGZus{}mu}\PYG{p}{(}\PYG{n}{vpol}\PYG{p}{,} \PYG{n}{Q}\PYG{o}{=}\PYG{n}{Q}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{a\PYGZus{}mu contribution =}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{amu}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} error budget for a\PYGZus{}mu}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{gv}\PYG{o}{.}\PYG{n}{fmt\PYGZus{}errorbudget}\PYG{p}{(}
        \PYG{n}{outputs}\PYG{o}{=}\PYG{n+nb}{dict}\PYG{p}{(}\PYG{n}{a\PYGZus{}mu}\PYG{o}{=}\PYG{n}{amu}\PYG{p}{,} \PYG{n}{mom4}\PYG{o}{=}\PYG{n}{mom}\PYG{p}{[}\PYG{l+m+mi}{4}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,}
        \PYG{n}{inputs}\PYG{o}{=}\PYG{n+nb}{dict}\PYG{p}{(}\PYG{n}{G}\PYG{o}{=}\PYG{n}{G}\PYG{p}{,} \PYG{n}{Z}\PYG{o}{=}\PYG{n}{Z}\PYG{p}{,} \PYG{n}{ainv}\PYG{o}{=}\PYG{n}{ainv}\PYG{p}{)}\PYG{p}{,}
        \PYG{p}{)}\PYG{p}{)}

\PYG{k}{if} \PYG{n+nv+vm}{\PYGZus{}\PYGZus{}name\PYGZus{}\PYGZus{}} \PYG{o}{==} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZus{}\PYGZus{}main\PYGZus{}\PYGZus{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}
    \PYG{n}{main}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

In this code, we first read the simulation data for the \sphinxstyleemphasis{jj} correlator into
array \sphinxcode{G}, where \sphinxcode{G{[}i{]}} is the correlator for (Euclidean) time  \sphinxcode{i/ainv}
where \sphinxcode{i=0,1..63}. We then use {\hyperref[\detokenize{g2tools:g2tools.moments}]{\sphinxcrossref{\sphinxcode{g2tools.moments()}}}} to calculate
temporal moments of the correlator, while also converting from lattice units
to physical units (using the inverse lattice spacing \sphinxcode{ainv})  and
renormalizing the current (\sphinxcode{Z}).

\sphinxcode{vpol(q2)} is the vacuum polarization function at Euclidean \sphinxstyleemphasis{q}$^{\text{2}}$
equal to \sphinxcode{q2}. Object \sphinxcode{vpol} has type {\hyperref[\detokenize{g2tools:g2tools.vacpol}]{\sphinxcrossref{\sphinxcode{g2tools.vacpol}}}}. It
constructs a  {[}2,2{]} Padé approximant from the moments,
and uses that approximant to  approximate the exact function.
The approximants converge to the exact result as the order
increases provided the momentum is space-like (\sphinxcode{q2} non-negative).
Using a {[}1,1{]} Padé instead of {[}2,2{]} gives almost identical results here, so the
approximants have converged for the present application.

We calculate the contribution from vacuum polarization \sphinxcode{vpol}
to the muon’s anomalous magnetic moment a$_{\text{µ}}$ using
\sphinxcode{g2tools.a\_mu()}. We also use \sphinxcode{gvar.fmt\_errorbudget()}
to produce an error budget for it and the 4th moment.

Running this code gives the following output:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{Taylor} \PYG{n}{coefficients}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mf}{0.06629}\PYG{p}{(}\PYG{l+m+mi}{74}\PYG{p}{)} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.0527}\PYG{p}{(}\PYG{l+m+mi}{11}\PYG{p}{)} \PYG{l+m+mf}{0.0472}\PYG{p}{(}\PYG{l+m+mi}{15}\PYG{p}{)} \PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.0435}\PYG{p}{(}\PYG{l+m+mi}{18}\PYG{p}{)}\PYG{p}{]}

\PYG{n}{a\PYGZus{}mu} \PYG{n}{contribution} \PYG{o}{=} \PYG{l+m+mf}{5.412}\PYG{p}{(}\PYG{l+m+mi}{57}\PYG{p}{)}\PYG{n}{e}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{09}

\PYG{n}{Partial} \PYG{o}{\PYGZpc{}} \PYG{n}{Errors}\PYG{p}{:}
                \PYG{n}{a\PYGZus{}mu}      \PYG{n}{mom4}
\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}
     \PYG{n}{ainv}\PYG{p}{:}      \PYG{l+m+mf}{1.00}      \PYG{l+m+mf}{1.06}
        \PYG{n}{Z}\PYG{p}{:}      \PYG{l+m+mf}{0.34}      \PYG{l+m+mf}{0.34}
        \PYG{n}{G}\PYG{p}{:}      \PYG{l+m+mf}{0.01}      \PYG{l+m+mf}{0.01}
\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}
    \PYG{n}{total}\PYG{p}{:}      \PYG{l+m+mf}{1.06}      \PYG{l+m+mf}{1.11}
\end{sphinxVerbatim}

The contribution to the muon’s anomalous magnetic moment is
54.12(57)x10$^{\text{-10}}$. The error budget shows that the final
uncertainty is dominated by the uncertainty in the inverse
lattice spacing \sphinxcode{ainv}; statistical errors from \sphinxcode{G} are
completely negligible in this example.

An alternative to using moments is to Fourier transform the
correlator to obtain \sphinxcode{vpol(q2)} directly. Moments are particularly
useful for analyzing finite-volume and other systematic errors, but
the Fourier method is simpler to code:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} compute a\PYGZus{}mu from the Fourier transform of G(t)}
\PYG{n}{vpol} \PYG{o}{=} \PYG{n}{g2}\PYG{o}{.}\PYG{n}{fourier\PYGZus{}vacpol}\PYG{p}{(}\PYG{n}{G}\PYG{p}{,} \PYG{n}{ainv}\PYG{o}{=}\PYG{n}{ainv}\PYG{p}{,} \PYG{n}{Z}\PYG{o}{=}\PYG{n}{Z}\PYG{p}{,} \PYG{n}{periodic}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\PYG{n}{amu} \PYG{o}{=} \PYG{n}{g2}\PYG{o}{.}\PYG{n}{a\PYGZus{}mu}\PYG{p}{(}\PYG{n}{vpol}\PYG{p}{,} \PYG{n}{Q}\PYG{o}{=}\PYG{n}{Q}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{a\PYGZus{}mu contribution =}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{amu}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} error budget for a\PYGZus{}mu}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{gv}\PYG{o}{.}\PYG{n}{fmt\PYGZus{}errorbudget}\PYG{p}{(}
    \PYG{n}{outputs}\PYG{o}{=}\PYG{n+nb}{dict}\PYG{p}{(}\PYG{n}{a\PYGZus{}mu}\PYG{o}{=}\PYG{n}{amu}\PYG{p}{)}\PYG{p}{,}
    \PYG{n}{inputs}\PYG{o}{=}\PYG{n+nb}{dict}\PYG{p}{(}\PYG{n}{G}\PYG{o}{=}\PYG{n}{G}\PYG{p}{,} \PYG{n}{Z}\PYG{o}{=}\PYG{n}{Z}\PYG{p}{,} \PYG{n}{ainv}\PYG{o}{=}\PYG{n}{ainv}\PYG{p}{)}\PYG{p}{,}
    \PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

This code gives identical results to that above.

{\hyperref[\detokenize{g2tools:module-g2tools}]{\sphinxcrossref{\sphinxcode{g2tools}}}} is designed to work with module \sphinxcode{gvar} which we use here
to represent the statistical and systematic uncertainties in
the correlator values, inverse lattice spacing, and \sphinxcode{Z} factor. Each of these
quantities is an object of type \sphinxcode{gvar.GVar}, which represents
a Gaussian random variable. \sphinxcode{gvar.GVar}s describe not only
means and standard deviations, but also statistical correlations between
different objects. These correlations are propagated through arbitrary
arithmetic statements. Adding the following code to the end of \sphinxcode{main()},
for example,

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{gv}\PYG{o}{.}\PYG{n}{evalcorr}\PYG{p}{(}\PYG{p}{[}\PYG{n}{mom}\PYG{p}{[}\PYG{l+m+mi}{4}\PYG{p}{]}\PYG{p}{,} \PYG{n}{mom}\PYG{p}{[}\PYG{l+m+mi}{6}\PYG{p}{]}\PYG{p}{,} \PYG{n}{mom}\PYG{p}{[}\PYG{l+m+mi}{8}\PYG{p}{]}\PYG{p}{,} \PYG{n}{mom}\PYG{p}{[}\PYG{l+m+mi}{10}\PYG{p}{]}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

prints out the correlation matrix for the moments, showing that they
are highly correlated (as expected):

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{[}\PYG{p}{[} \PYG{l+m+mf}{1.}          \PYG{l+m+mf}{0.98833867}  \PYG{l+m+mf}{0.9787737}   \PYG{l+m+mf}{0.97262094}\PYG{p}{]}
 \PYG{p}{[} \PYG{l+m+mf}{0.98833867}  \PYG{l+m+mf}{1.}          \PYG{l+m+mf}{0.99853653}  \PYG{l+m+mf}{0.99646438}\PYG{p}{]}
 \PYG{p}{[} \PYG{l+m+mf}{0.9787737}   \PYG{l+m+mf}{0.99853653}  \PYG{l+m+mf}{1.}          \PYG{l+m+mf}{0.99949934}\PYG{p}{]}
 \PYG{p}{[} \PYG{l+m+mf}{0.97262094}  \PYG{l+m+mf}{0.99646438}  \PYG{l+m+mf}{0.99949934}  \PYG{l+m+mf}{1.}        \PYG{p}{]}\PYG{p}{]}
\end{sphinxVerbatim}

The moments are also highly correlated with the final results \sphinxcode{a\_mu}: for
example, adding the following to the end of \sphinxcode{main()}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{gv}\PYG{o}{.}\PYG{n}{evalcorr}\PYG{p}{(}\PYG{p}{[}\PYG{n}{a\PYGZus{}mu}\PYG{p}{,} \PYG{n}{mom}\PYG{p}{[}\PYG{l+m+mi}{4}\PYG{p}{]}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

gives:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{[}\PYG{p}{[} \PYG{l+m+mf}{1.}          \PYG{l+m+mf}{0.96864247}\PYG{p}{]}
 \PYG{p}{[} \PYG{l+m+mf}{0.96864247}  \PYG{l+m+mf}{1.}        \PYG{p}{]}\PYG{p}{]}
\end{sphinxVerbatim}

This kind of correlation information is used by \sphinxcode{gvar.fmt\_errorbudget(...)}
to create the error budget. See \sphinxcode{gvar}’s documentation
for more information.


\chapter{\sphinxstyleliteralintitle{g2tools} Module}
\label{\detokenize{g2tools:g2tools-module}}\label{\detokenize{g2tools::doc}}\label{\detokenize{g2tools:module-g2tools}}\index{g2tools (module)}

\section{Moments}
\label{\detokenize{g2tools:moments}}
The main tools for creating and manipulating moments are:
\index{moments() (in module g2tools)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{g2tools:g2tools.moments}}\pysiglinewithargsret{\sphinxcode{g2tools.}\sphinxbfcode{moments}}{\emph{G, Z=1.0, ainv=1.0, periodic=True, tmin=None, nlist={[}4, 6, 8, 10, 12, 14, 16, 18, 20{]}}}{}
Compute t**n moments of correlator G.

Compute \sphinxcode{sum\_t t**n G(t)} for \sphinxcode{n} in \sphinxcode{nlist}, where both positive and
negative \sphinxcode{t} are included.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{G} \textendash{} Array of correlator values \sphinxcode{G{[}t{]}} for \sphinxcode{t=0,1...} (in
lattice units).

\item {} 
\sphinxstyleliteralstrong{Z} \textendash{} Renormalization factor for current (moments multiplied by \sphinxcode{Z**2}).
Defaul is 1.

\item {} 
\sphinxstyleliteralstrong{ainv} \textendash{} Inverse lattice spacing used to convert moments to
physical units (n-th moment multiplied by \sphinxcode{1/ainv**(n-2)}).
Default is 1.

\item {} 
\sphinxstyleliteralstrong{periodic} \textendash{} \sphinxcode{periodic=True} implies \sphinxcode{G{[}-t{]} = G{[}t{]}} (default);
\sphinxcode{periodic=False} implies no periodicity in array \sphinxcode{G{[}t{]}}
(and results doubled to account for negative \sphinxcode{t}).

\item {} 
\sphinxstyleliteralstrong{tmin} \textendash{} minimum \sphinxcode{t} value included in moments; ignored
if \sphinxcode{None} (default).

\item {} 
\sphinxstyleliteralstrong{nlist} \textendash{} List of moments to calculate. Default is
\sphinxcode{nlist={[}4,6,8...20{]}}.

\end{itemize}

\item[{Returns}] \leavevmode
Dictionary \sphinxcode{Gmom} where \sphinxcode{Gmom{[}n{]}} is the \sphinxcode{n-th} moment.

\end{description}\end{quote}

\end{fulllineitems}

\index{mom2taylor() (in module g2tools)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{g2tools:g2tools.mom2taylor}}\pysiglinewithargsret{\sphinxcode{g2tools.}\sphinxbfcode{mom2taylor}}{\emph{mom}}{}
Convert moments in dictionary \sphinxcode{mom} into Taylor series coefficients.

\end{fulllineitems}

\index{taylor2mom() (in module g2tools)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{g2tools:g2tools.taylor2mom}}\pysiglinewithargsret{\sphinxcode{g2tools.}\sphinxbfcode{taylor2mom}}{\emph{tayl}}{}
Convert Taylor coefficients in array \sphinxcode{tayl} to moments.

\end{fulllineitems}



\section{Subtracted Vacuum Polarization}
\label{\detokenize{g2tools:subtracted-vacuum-polarization}}
A subtracted vacuum polarization function (\sphinxcode{Pi-hat}) is
represented by the following classes:
\index{vacpol (class in g2tools)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{g2tools:g2tools.vacpol}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{g2tools.}\sphinxbfcode{vacpol}}{\emph{g}, \emph{order=None}, \emph{scale=None}, \emph{rtol=None}, \emph{qth=0}, \emph{warn=True}, \emph{exceptions=True}}{}
Subtracted vac. pol’n (\sphinxcode{Pi-hat(q2)}) from correlator moments \sphinxcode{Gmon{[}n{]}}.

The current-current correlator is \sphinxcode{q2 * Pi(q2)}, where
\sphinxcode{Pi-hat(q2) = Pi(q2) - Pi(0)} is the subtracted (i.e., renormalized)
vacuum polariztion function.

The vacuum polarization function is a Pade approximant to the Taylor
series corresponding to the moments \sphinxcode{g{[}n{]}}.  The code estimates the
precision of the moments and sets the tolerance for the Pade determination
accordingly. The order \sphinxcode{(m,n)} of the Pade can be specified, but might
be reduced by the code if the data are noisy.

{\hyperref[\detokenize{g2tools:g2tools.vacpol}]{\sphinxcrossref{\sphinxcode{vacpol}}}} objects are used primarily as functions (of \sphinxstyleemphasis{q}$^{\text{2}}$)
but also have several attributes. Attribute \sphinxcode{pseries} is a dictionary
containing various powerseries (see \sphinxcode{gvar.powerseries}) describing the
function: the vacuum polarization function is \sphinxcode{q2} times a Pade
approximant  with a numerator given by \sphinxcode{pseries{[}'num'{]}} and a
denominator  given by \sphinxcode{pseries{[}'den'{]}}. The Taylor series for this
function  is given by \sphinxcode{q2} times \sphinxcode{pseries{[}'taylor'{]}}.

{\hyperref[\detokenize{g2tools:g2tools.vacpol}]{\sphinxcrossref{\sphinxcode{vacpol}}}} objects also have a method {\hyperref[\detokenize{g2tools:g2tools.vacpol.badpoles}]{\sphinxcrossref{\sphinxcode{vacpol.badpoles()}}}} that
tests the poles in the denomator of the Pade. \sphinxcode{badpoles(qth)} returns
\sphinxcode{False} if any of the poles is complex or if any are located above
\sphinxcode{-(qth ** 2)}. \sphinxcode{qth} should be set equal to the threshold energy for
the correlator. If it is unset, \sphinxcode{qth=0} is used. Lists of the
poles and their residues (for \sphinxcode{Pi-hat(q2)}) are available in
attributes \sphinxcode{pole} and \sphinxcode{residue}, respectively.

{\hyperref[\detokenize{g2tools:g2tools.vacpol}]{\sphinxcrossref{\sphinxcode{vacpol}}}} has several static methods for creating specialized
examples of vacuum polarizations (e.g., for testing):
\begin{itemize}
\item {} 
\sphinxcode{vacpol.fermion(m)} \textendash{} 1-loop fermion (mass \sphinxcode{m}) contribution;

\item {} 
\sphinxcode{vacpol.scalar(m)} \textendash{} 1-loop scalar (mass \sphinxcode{m}) contribution;

\item {} \begin{description}
\item[{\sphinxcode{vacpol.vector(m, f)} \textendash{} tree-level contribution from vector}] \leavevmode
with mass \sphinxcode{m} and decay constant \sphinxcode{f}.

\end{description}

\end{itemize}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{g} \textendash{} Dictionary containing moments where \sphinxcode{g{[}n{]} = sum\_t t**n G(t)},
or array containing Taylor coefficients where
\sphinxcode{Pi-hat(q2) = q2 * sum\_j q2**j * g{[}j{]}}.

\item {} 
\sphinxstyleliteralstrong{order} \textendash{} Tuple \sphinxcode{(m,n)} specifying the order of the Pade
approximant used to approximate \sphinxcode{Pi-hat(q2)} (the function is
approximated by \sphinxcode{q2} times an \sphinxcode{(m-1,n)} approximant). The
order may be reduced (automatically) if the data are too noisy. If
the order is not specified, it is set automatically according to
the number of entries in \sphinxcode{G}.

\item {} 
\sphinxstyleliteralstrong{scale} \textendash{} Scale factor used to rescale \sphinxcode{q2} so that
the Taylor coefficients are more uniform in size. This is
normally set automatically (from the first two moments),
but the automatic value is overridden if \sphinxcode{scale} is set.

\item {} 
\sphinxstyleliteralstrong{rtol} \textendash{} Relative tolerance assumed when determining the
Pade approximant. This is normally set automatically
(from the standard deviations of the moments), but the
automatic value is overridden if \sphinxcode{rtol} is specified.

\item {} 
\sphinxstyleliteralstrong{qth} \textendash{} Threshold for particle production: poles above \sphinxcode{-qth**2}
are bad. Default is \sphinxcode{qth=0}.

\item {} 
\sphinxstyleliteralstrong{warnings} \textendash{} \sphinxcode{warnings=True} (default) causes a warning to be issued
when the order has been reduced automatically. \sphinxcode{warnings=False}
suppresses the warnings.

\item {} 
\sphinxstyleliteralstrong{exceptions} \textendash{} If \sphinxcode{True} (default), an exception is raised if there
are bad poles in the \sphinxcode{vacpol}. If \sphinxcode{False}, exceptions are
suppressed.

\end{itemize}

\end{description}\end{quote}

Methods include:
\index{taylor() (g2tools.vacpol method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{g2tools:g2tools.vacpol.taylor}}\pysiglinewithargsret{\sphinxbfcode{taylor}}{\emph{n=None}}{}
Return Taylor coefficients for \sphinxcode{PI-hat(q2)/q2}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{n} \textendash{} Maximum number of coefficients returned. Returns
all coefficents if \sphinxcode{None} (default)/

\end{description}\end{quote}

\end{fulllineitems}

\index{badpoles() (g2tools.vacpol method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{g2tools:g2tools.vacpol.badpoles}}\pysiglinewithargsret{\sphinxbfcode{badpoles}}{\emph{qth=None}}{}
True if any pole is complex or above threshold.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{qth} \textendash{} Threshold for particle production: poles above \sphinxcode{-qth**2}
are bad. (Default is \sphinxcode{qth=0}.)

\end{description}\end{quote}

\end{fulllineitems}

\index{FT() (g2tools.vacpol method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{g2tools:g2tools.vacpol.FT}}\pysiglinewithargsret{\sphinxbfcode{FT}}{\emph{t}, \emph{ainv=1.0}}{}
Fourier transform of \sphinxcode{q2 * PI-hat(q2)}.

The Pade approximant can be decomposed into a sum of poles (partial
fractions), which give a sum of decaying exponentials when Fourier
transformed back to t-space. The amplitudes and energies of these
exponentials (for the transform of \sphinxcode{q2 * Pi-hat(q2)'{'}) are stored in
:class:{}`g2tools.vacpol{}` attributes {}`{}`E} and \sphinxcode{ampl}, respectively.

The decomposition into a sum of poles leaves a residual polynomial in
\sphinxcode{q2} (zeroth-order for \sphinxcode{(n,n)} Pades). This is ignored in the
Fourier transform since it typically affects the transform only for
very small \sphinxcode{t}. These terms have a negligible effect (suppressed by
\sphinxcode{a**2j} on the Taylor coefficients \sphinxcode{Pi{[}j{]}} of \sphinxcode{Pi-hat(q2)}
(for j\textgreater{}=1).

Optional parameter \sphinxcode{ainv} can be used to convert the Fourier
transform to lattice units (by multiplying it by \sphinxcode{1/ainv**3}) for
comparison with simulation data. The times \sphinxcode{t} are then
assumed to be in lattice units.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{t} (\sphinxstyleliteralemphasis{number}\sphinxstyleliteralemphasis{, }\sphinxstyleliteralemphasis{array}) \textendash{} Time in physical units unless \sphinxcode{ainv}
is specified, in which case lattice units are assumed.

\item {} 
\sphinxstyleliteralstrong{ainv} \textendash{} Inverse lattice spacing. The Fourier transform is in lattice
units if \sphinxcode{ainv} is specified (assuming the original
Taylor coefficients are in physical units).

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{scalar() (g2tools.vacpol static method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{g2tools:g2tools.vacpol.scalar}}\pysiglinewithargsret{\sphinxbfcode{static }\sphinxbfcode{scalar}}{\emph{m}, \emph{n=10}, \emph{use\_pade=False}}{}
1-loop subt. vac. pol’n from a scalar with mass m (and charge=1).

\end{fulllineitems}

\index{fermion() (g2tools.vacpol static method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{g2tools:g2tools.vacpol.fermion}}\pysiglinewithargsret{\sphinxbfcode{static }\sphinxbfcode{fermion}}{\emph{m}, \emph{n=19}, \emph{use\_pade=False}}{}
1-loop subt. vac. pol’n from a fermion with mass m (and charge=1).

\end{fulllineitems}

\index{vector() (g2tools.vacpol static method)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{g2tools:g2tools.vacpol.vector}}\pysiglinewithargsret{\sphinxbfcode{static }\sphinxbfcode{vector}}{\emph{m}, \emph{f=1.0}, \emph{n=10}, \emph{use\_pade=False}}{}
Vac. pol’n due to a vector with mass \sphinxcode{m} and decay const. \sphinxcode{f}.

The decay constant is defined such that the vacuum polarization
function is \sphinxcode{Pi-hat = q2 * f**2/2/m**2 / (q2 + m**2)}. This
corresponds in \sphinxcode{t} space to {\color{red}\bfseries{}{}`{}`}m * f**2 * exp(-m * t) / 4’‘.

\end{fulllineitems}


\end{fulllineitems}

\index{fourier\_vacpol (class in g2tools)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{g2tools:g2tools.fourier_vacpol}}\pysiglinewithargsret{\sphinxbfcode{class }\sphinxcode{g2tools.}\sphinxbfcode{fourier\_vacpol}}{\emph{G}, \emph{Z=1.0}, \emph{ainv=1.0}, \emph{periodic=True}}{}
Subtracted vac. pol’n (\sphinxcode{Pi-hat(q2)}) from correlator \sphinxcode{G(t)}.

The correlator is Fourier transformed to produce a function \sphinxcode{Pi\_hat}
of (Euclidean) \sphinxstyleemphasis{q}$^{\text{2}}$ suitable for use in \sphinxcode{g2tools.a\_mu()}.

See Bernecker \& Meyer, EPJA47 (2011) 148 , arXiv:1107.4388 for details
on the Fouier transformation.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{G} (\sphinxstyleliteralemphasis{array}) \textendash{} Current-current correlator in an array whose elements
are \sphinxcode{{[}G(0),G(a),G(2*a),...,G(-2*a),G(-a){]}} if
\sphinxcode{periodic=True} or \sphinxcode{{[}G(0),G(a),...,G(T*a-1){]}}
otherwise. \sphinxcode{G} is assumed to be in lattice units.

\item {} 
\sphinxstyleliteralstrong{Z} \textendash{} Renormalization factor for current (correlator multiplied
by \sphinxcode{Z**2}). Defaul is 1.

\item {} 
\sphinxstyleliteralstrong{ainv} \textendash{} Inverse lattice spacing used to convert Fourier transform to
physical units. Default is 1.

\item {} 
\sphinxstyleliteralstrong{periodic} \textendash{} \sphinxcode{periodic=True} implies \sphinxcode{G{[}-t{]} = G{[}t{]}} (default);
\sphinxcode{periodic=False} implies \sphinxcode{G{[}t{]}} is not periodic and
is specified for only non-negative \sphinxcode{t} values
(results are doubled to account for negative \sphinxcode{t}).

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}



\section{Padé Approximants}
\label{\detokenize{g2tools:pade-approximants}}
The following two functions are used for calculating Padé approximants from
the Taylor coefficients of an arbitrary function. The first
({\hyperref[\detokenize{g2tools:g2tools.pade_svd}]{\sphinxcrossref{\sphinxcode{g2tools.pade\_svd()}}}}) implements an algorithm that uses \sphinxstyleemphasis{svd} cuts to
address instabilities caused  by uncertainties in the Taylor coefficients. The
second function ({\hyperref[\detokenize{g2tools:g2tools.pade_gvar}]{\sphinxcrossref{\sphinxcode{g2tools.pade\_gvar()}}}}) is built on the first but allows
Taylor coefficients to have uncertainties (\sphinxcode{gvar.GVar}s). The statistical
uncertainties and correlations between different coefficients are propagated
through the analysis.
\index{pade\_svd() (in module g2tools)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{g2tools:g2tools.pade_svd}}\pysiglinewithargsret{\sphinxcode{g2tools.}\sphinxbfcode{pade\_svd}}{\emph{f}, \emph{m}, \emph{n}, \emph{rtol=1e-14}}{}
\sphinxcode{{[}m,n{]}} Pade approximant to \sphinxcode{sum\_i f{[}i{]} x**i}.

The \sphinxcode{{[}m,n{]}} Pade approximant to a series given by
\sphinxcode{sum\_i f{[}i{]} * x**i} is the ratio of  polynomials of order \sphinxcode{m}
(numerator) and \sphinxcode{n} (denominator) whose  Taylor expansion agrees
with that of the original series up to order \sphinxcode{m+n}.

This code is adapted from P. Gonnet,  S. Guttel, L. N. Trefethen, SIAM
Review Vol 55, No. 1, 101 (2013). It uses an \sphinxstyleemphasis{svd} algorithm to deal with
imprecision in the input data,  here specified by the relative tolerance
\sphinxcode{rtol} for the  input coefficients \sphinxcode{f{[}i{]}}. It automatically reduces
the order of the approximant if the extraction of Pade coefficients
is too unstable given tolerance \sphinxcode{rtol}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{f} \textendash{} Array \sphinxcode{f{[}i{]}} of power series coefficients for \sphinxcode{i=0...n+m}.

\item {} 
\sphinxstyleliteralstrong{m} \textendash{} Maximum order of polynomial in numerator of Pade
approximant (\sphinxcode{m\textgreater{}=0}).

\item {} 
\sphinxstyleliteralstrong{n} \textendash{} Maximum order of polynomial in denominator of Pade
approximant (\sphinxcode{m\textgreater{}=0}).

\item {} 
\sphinxstyleliteralstrong{rtol} \textendash{} Relative accuracy of input coefficients. (Default is 1e-14.)

\end{itemize}

\item[{Returns}] \leavevmode
Tuple of power series coefficients \sphinxcode{(p, q)} such that
\sphinxcode{sum\_i p{[}i{]} x**i} is the numerator of the approximant,
and \sphinxcode{sum\_i q{[}i{]} x**i} is the denominator. \sphinxcode{q{[}0{]}} is
normalized to 1.

\end{description}\end{quote}

\end{fulllineitems}

\index{pade\_gvar() (in module g2tools)}

\begin{fulllineitems}
\phantomsection\label{\detokenize{g2tools:g2tools.pade_gvar}}\pysiglinewithargsret{\sphinxcode{g2tools.}\sphinxbfcode{pade\_gvar}}{\emph{f}, \emph{m}, \emph{n}, \emph{rtol='gavg'}}{}
\sphinxcode{{[}m,n{]}} Pade approximant to \sphinxcode{sum\_i f{[}i{]} x**i} for \sphinxcode{GVar}s.

The \sphinxcode{{[}m,n{]}} Pade approximant to a series given by
\sphinxcode{sum\_i f{[}i{]} * x**i} is the ratio of  polynomials of order \sphinxcode{m}
(numerator) and \sphinxcode{n} (denominator) whose  Taylor expansion agrees
with that of the original series up to order \sphinxcode{m+n}.

This code uses an SVD algorithm (see {\hyperref[\detokenize{g2tools:g2tools.pade_svd}]{\sphinxcrossref{\sphinxcode{pade\_svd()}}}}) to deal with
imprecision in the input data. It automatically reduces
the order of the approximant if the extraction of Pade coefficients
is too unstable given noise in the input data.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{f} \textendash{} Array \sphinxcode{f{[}i{]}} of power series coefficients for \sphinxcode{i=0...n+m}.

\item {} 
\sphinxstyleliteralstrong{m} \textendash{} Maximum order of polynomial in numerator of Pade
approximant (\sphinxcode{m\textgreater{}=0}).

\item {} 
\sphinxstyleliteralstrong{n} \textendash{} Maximum order of polynomial in denominator of Pade
approximant (\sphinxcode{m\textgreater{}=0}).

\item {} 
\sphinxstyleliteralstrong{rtol} (\sphinxstyleliteralemphasis{float}\sphinxstyleliteralemphasis{ or }\sphinxstyleliteralemphasis{str}) \textendash{} If \sphinxcode{rtol} is a string, it determines how the
relative tolerance is determined from the relative
uncertainties in the \sphinxcode{f{[}i{]}}. Set \sphinxcode{rtol} equal to:
\sphinxcode{'gavg'} for the geometric mean (default); \sphinxcode{'avg'} for
the average; \sphinxcode{'min'} for the minimum; or \sphinxcode{'max'} for
the maximum. Otherwise a number can be specified, in which case
the uncertainties in \sphinxcode{f{[}i{]}} are ignored.

\end{itemize}

\item[{Returns}] \leavevmode
Tuple of power series coefficients \sphinxcode{(p, q)} such that
\sphinxcode{sum\_i p{[}i{]} x**i} is the numerator of the approximant,
and \sphinxcode{sum\_i q{[}i{]} x**i} is the denominator. \sphinxcode{q{[}0{]}} is
normalized to 1.

\end{description}\end{quote}

\end{fulllineitems}



\chapter{Indices and tables}
\label{\detokenize{index:indices-and-tables}}\begin{itemize}
\item {} 
\DUrole{xref,std,std-ref}{genindex}

\item {} 
\DUrole{xref,std,std-ref}{modindex}

\item {} 
\DUrole{xref,std,std-ref}{search}

\end{itemize}


\renewcommand{\indexname}{Python Module Index}
\begin{sphinxtheindex}
\def\bigletter#1{{\Large\sffamily#1}\nopagebreak\vspace{1mm}}
\bigletter{g}
\item {\sphinxstyleindexentry{g2tools}}\sphinxstyleindexpageref{g2tools:\detokenize{module-g2tools}}
\end{sphinxtheindex}

\renewcommand{\indexname}{Index}
\printindex
\end{document}